FO.prototype.W_=QR(200,function(a){var b=this.pb.Ow(this.F);Ys(b,"docs-icon-comment-blank-highlighted",a)});TAb.prototype.W_=QR(199,function(a){var b=WG(this.D);this.C.vf(function(c){var d=a&&c.hq().Jb()==b;c.W_(d)})});EN.prototype.V3=QR(182,ba());Rxb.prototype.V3=QR(181,function(a,b,c,d){b=u(c)?new Docos.Point(c.x,c.y):void 0;this.C.newDoco(a,b,null==d?void 0:d)});
wJ.prototype.ZFa=QR(158,function(a,b,c,d){for(var e=a-1,f=this.D.length;0<=e;){var h=this.D[e--];if(!(h.getSheetType()!=b||h.kh()&&d))return h}if(!c)return null;for(e=f-1;e>=a;)if(c=this.D[e--],!(c.getSheetType()!=b||c.kh()&&d))return c;return null});function l3c(a){var b=new al;a.C.forEach(function(a){a.isEmpty()||b.addAll(a.od())});return b.od()}
function m3c(a,b){if(!b)return null;var c=null;a.C.some(function(a,e,f){a=a.od();for(var d=0;d<a.length;d++)if(a[d]==b)return c=new il(f,e),!0;return!1});return c}function n3c(a,b,c,d){var e=null;a.C.every(function(a,h,k){if(b&&(h>c||h==c&&k>=d))return!1;a.isEmpty()||(e=new il(k,h));return!0});return e}function o3c(a,b,c){var d=null;a.C.some(function(a,f,h){return(f>b||f==b&&h>c)&&!a.isEmpty()?(d=new il(h,f),!0):!1});return d}
function p3c(a,b,c){var d=0,e=-1;b&&(d=b.y,e=b.x);return c?n3c(a,!!b,d,e):o3c(a,d,e)}function q3c(a,b,c){a.C.highlightDoco(a.D.C[b]||0,null==c?void 0:c)}function r3c(a,b){var c={},d;for(d in b){var e=a.D.C[d]||0;if(e&&a.C.hasDoco(e)){var f=b[d];c[e]=new Docos.Point(f.x,f.y)}}return c}function s3c(a,b){for(var c=[],d=0;d<b.length;d++)c.push(a.D.C[b[d]]||0);a.C.deleteDocoPositions(c)}function M_(a){return a.C.hasUnpostedDocos()}
function t3c(a,b){a.Xo.Ia=b;a.ib&&a.F&&(Q(a.F,0<b),cp(a.F.childNodes[1],b))}function u3c(a,b){var c=null;a.C.vf(function(a){a.hq().Jb()==b&&(c=a)});return c}var v3c={QAc:1,HOVER:2,b2:3};function w3c(a,b){return(a=zF(a,b))?a.Kc():null}function x3c(a,b,c){return c?"range"==c.getType()?(b=b.C[c.C()],qyb(b)?(b=b.$b(),null!=b?w3c(a,b):null):null):(b=ryb(c))&&syb(tyb(b))?w3c(a,parseInt(b.Jb(),10)):null:null}function y3c(a,b,c){GB.call(this,10100,b);this.vc=a;this.C=b;this.D=c}y(y3c,GB);
y3c.prototype.Wd=n(35);y3c.prototype.Td=function(){var a=new AC,b=Yl(this.D,this.C);N(a,1,this.vc);N(a,2,b);return a};y3c.prototype.Zh=ui;function z3c(a,b,c,d,e,f,h,k,l,m,q){G.call(this);this.D=a;this.cb=b;this.Ia=c;this.$a=d;this.J=e;this.ib=f;this.Wa=h;this.gb=k;this.C=l;this.R=m;this.L=b.$a;this.F=b.C;this.H=b.O;this.O=oyb();this.Ba={};this.va=new al;this.Pa=new wn(0);a=[this.Pa];Kb(q.D,a);BJa(q,a);q.C=zJa(q.D);AJa(q);this.$=new yj(this);this.Fa(this.$);A3c(this)}y(z3c,G);p=z3c.prototype;p.Fqa=!1;
function A3c(a){var b=rb(FUa,function(a){return!IUa[a]});a.$.V(a.$a,"activity-box-closed",a.Lvb).V(a.J,"mouseover",N_(a,a.xFb)).V(a.J,"click",N_(a,a.vFb)).V(a.J,"selectionChange",N_(a,a.yFb)).V(a.J,"inputBoxActivate",N_(a,a.tFb)).V(a.J,"hide_docos",N_(a,a.wFb)).V(a.F,"L",N_(a,a.r1b)).V(a.Wa,"Ab",a.YBb).V(a.Wa,"Bb",a.WBb).V(a.Wa,"Cb",a.VBb).V(a.J,"insert_doco",a.p1b).V(new EM(a.gb),Gtb(),a.zFb).V(a.H,["add_named_range","delete_named_range"],a.Bwb).V(a.cb,"docos_change",a.EFb).V(a.R,"se",a.dkb).V(a.F,
"K",a.EKa).V(a.J,"overlay-redraw",a.Pxb);var c=TD(a.F);a.$.V(c,b,a.uFb);a.$.V(c,["Ca"],N_(a,a.q1b));GN(a.D,Docos.EventType.HOVER,N_(a,a.fpb));GN(a.D,Docos.EventType.SELECTED,N_(a,a.o1b));GN(a.D,Docos.EventType.CREATED,a.MIa,a);GN(a.D,Docos.EventType.UNRESOLVED,a.MIa,a);GN(a.D,Docos.EventType.DELETED,a.NIa,a);GN(a.D,Docos.EventType.RESOLVED,a.NIa,a);GN(a.D,Docos.EventType.POSTED,a.Gpb,a);GN(a.D,Docos.EventType.PENDING,a.tyb,a);GN(a.D,Docos.EventType.HIGHLIGHT_INITIAL_DOCO,a.Ksb,a);uz.Qb(Lq,v(a.Etb,
a));P.dy.Qb(Lq,v(a.Hjb,a));P.WT.subscribe("action",v(a.mwb,a));P.XT.subscribe("action",v(a.uwb,a));P.ZT.subscribe("action",v(a.vwb,a));a.EKa()}p.EKa=function(){var a=SG(this.F);P.WT.eb(a);P.XT.eb(a);P.ZT.eb(a)};p.Pxb=function(){B3c(this.R)};p.Etb=function(){this.D.setOption(Docos.OptionName.READONLY,!this.cb.Gr())};function N_(a,b){return v(function(a){this.Fqa||b.call(this,a)},a)}
p.p1b=function(){var a=yJ(this.F),b=xG(a);if(b&&!M_(this.D)&&!C3c(this,a,b)){var c=ritz_api.RitzModelApi.getNewWorkbookRangeId();this.ib.C(new y3c(c,a.$b(),zl(b)));a=this.O.serialize(new lyb(c));if(a=D3c(this,a))this.C.dispatchEvent(new O_("Ae",[a],b)),this.Ia.Mb(2)}};function C3c(a,b,c){b=q5a(cI(a.L,b),c);return b.length?(q3c(a.D,a.O.serialize(b[0]),!0),!0):!1}p.MIa=function(a){var b=this;A(a.C,function(a){E3c(b,!0,a);b.va.add(a)})};p.NIa=function(a){var b=this;A(a.C,function(a){E3c(b,!1,a);b.va.remove(a)})};
function E3c(a,b,c,d,e){c=D3c(a,c);d=d||x3c(a.F,a.H,c);e=e||MN(a.H,c);if(c&&d&&e){var f=cI(a.L,d);if(b){var h=f.C.Je(e.y,e.x)||new al;h.add(c);f.J++;VD(f.C,e.y,e.x,h)}else(h=f.C.Je(e.y,e.x))&&h.remove(c)&&f.J--;VD(f.D,e.y,e.x,!0);f.H.Vb()||f.H.start();a.F.getActiveGrid()&&(d=d==yJ(a.F),b?(a=a.C,(b=d?e:null)&&jl(b,a.RQ)&&a.C.add(c),a.dispatchEvent(new O_("te",[c],b))):(a=a.C,(b=d?e:null)&&jl(b,a.RQ)&&a.C.remove(c),a.Tv==c&&(a.Tv=null),a.dispatchEvent(new O_("Ce",[c],b))))}else a.C.dispatchEvent("Ee")}
function D3c(a,b){if(!b)return null;if(!a.Ba[b]){var c=a.O.D(b);c&&(a.Ba[b]=c)}return a.Ba[b]}p.r1b=function(){this.C.reset()};p.fpb=function(a){a=F3c(this,a);var b=MN(this.H,a);this.C.dispatchEvent(new O_("xe",[a],b))};p.Gpb=ba();p.tyb=function(){var a=this.Pa,b=this.D.C.hasPendingContent();xn(a,vn(a.Lf,4,b))};p.Ksb=function(a){this.$a&&(a.F||this.C&&!this.C.Tv)&&(a=this.$a,G3c(a),a.D.setVisible(!0))};p.Lvb=function(){this.Ia.Mb(3)};
p.o1b=function(a){if(!M_(this.D)){var b=F3c(this,a),c=MN(this.H,b);b&&c?(this.Fqa=!0,H3c(this.C,b,c)):b||a.F?this.C.reset():b||this.Ia.Mb(3)}};p.dkb=function(){this.Fqa=!1};p.wFb=function(){this.C.dispatchEvent("ze")};p.yFb=function(){if(!this.R.isEmpty()&&!M_(this.D)){this.Ia.Mb(3);var a=this.C,b=xG(yJ(this.F));jl(a.HS,b)||!a.Tv&&!a.qA&&jl(a.RQ,b)||(P_(a),a.dispatchEvent(new O_("we",[],b)))}};
p.vFb=function(){var a=yJ(this.F);if(!M_(this.D)&&a){var b=cI(this.L,a),c=(a=xG(a))?q5a(b,a):[];c.length&&(b=this.C,c=c[0],jl(b.HS,a)?(P_(b),b.dispatchEvent(new O_("ue",[],a))):b.dispatchEvent(new O_("ue",[c],a)))}};p.tFb=function(){M_(this.D)||this.C.reset()};p.q1b=function(){I3c(this.C)};p.uFb=function(){I3c(this.C)};
p.Bwb=function(a){var b=a.mf;if(b&&b.C)if(qyb(b)){var c=b.getId();c=this.O.serialize(new jyb(c));a="add_named_range"==a.type;if(!a||this.va.contains(c)){var d=b.$b();b.Xe()&&null!=d&&(d=w3c(this.F,d))&&E3c(this,a,c,d,b.getRect().Ge())}}else this.C.dispatchEvent("Ee")};
p.EFb=function(a){a=a.docos||[];Mb(a);for(var b=0;b<a.length;b++){var c=this.O.serialize(new lyb(a[b]));if(c){var d=D3c(this,c);a:{var e=void 0,f=this.L;if(d)for(e in f.C){var h=f.C[e],k=m3c(h,d);if(k){d={model:h.Kc(),L5a:k};break a}}d=null}d?(E3c(this,!1,c,d.model,d.L5a),E3c(this,!0,c),this.C.dispatchEvent("Ee")):this.va.contains(c)&&E3c(this,!0,c)}}};
p.xFb=function(a){var b=yJ(this.F);if(b){if((a=a.Tg)&&hob(a)){var c=XF(b,a.y,a.x);a=c?c.Ge():a}else a=null;b=cI(this.L,b);b=a?q5a(b,a):[];c=this.C;c.C.clear();c.C.addAll(b);c.RQ=a;c.dispatchEvent(new O_("ve",b,a))}};p.YBb=function(){if(!M_(this.D)){var a=this.C;if(a.qA&&a.zZ)a.zZ=!1;else{var b=!a.qA;P_(a);a.qA=b;a.dispatchEvent("Be")}}};p.WBb=function(){if(!M_(this.D)){var a=this.C;a.qA||(P_(a),a.zZ=!0,a.qA=!0,a.dispatchEvent("Be"))}};
p.VBb=function(){if(!M_(this.D)){var a=this.C;a.qA&&a.zZ&&(P_(a),a.dispatchEvent("Be"))}};p.zFb=function(a){a.stopPropagation()};function F3c(a,b){b=b.C;return D3c(a,b.length?b[0]:null)}p.n1b=function(a){var b=D3c(this,a);a=x3c(this.F,this.H,b);if(!b||!a)return"";b=MN(this.H,b);a=HF(rG(a,b));500<a.length&&(a=a.substring(0,499),a+="\u2026");return a};p.Hjb=function(){var a=this.D;var b=a.C.getLinkedDoco();if(a=a.D.D[b]||"")(a=D3c(this,a))?(b=MN(this.H,a),H3c(this.C,a,b)):P.dy.mc()};
p.mwb=function(){var a=yJ(this.F),b=xG(a);C3c(this,a,b)};p.uwb=function(){J3c(this,!1)};p.vwb=function(){J3c(this,!0)};function J3c(a,b){var c=K3c(a,b),d=VG(a.F),e=yJ(a.F),f=xG(e),h=cI(a.L,e);f=p3c(h,f,b);for(var k=d;!f&&null!==k&&(k=c(k),e=k.Kc(),h=cI(a.L,e),f=p3c(h,null,b),k=k.kf(),k!=d););f&&null!==k&&(b=q5a(h,f)[0],JB(a.F,k,v(a.s1b,a,e,b,f)))}function K3c(a,b){var c=b?v(a.F.ZFa,a.F):v(a.F.D5,a.F);return function(a){return c(a,0,!0,!0)}}p.s1b=function(a,b,c){H3c(this.C,b,c);BG(a,c)};
p.Oa=function(){delete this.J;delete this.gb;delete this.O;delete this.Ba;delete this.D;delete this.L;delete this.$;delete this.H;delete this.ib;delete this.F;delete this.cb;H(this.Pa);delete this.Pa;H(this.R);delete this.R;H(this.C);delete this.C;z3c.qa.Oa.call(this)};function O_(a,b,c){I.call(this,a);this.docos=b;this.H=b.length?b[0]:null;this.po=c||null}y(O_,I);function L3c(){J.call(this);this.C=new al}y(L3c,J);p=L3c.prototype;p.RQ=null;p.HS=null;p.Tv=null;p.qA=!1;p.zZ=!1;function H3c(a,b,c){P_(a);a.Tv=b;a.HS=c;a.dispatchEvent(new O_("ye",[b],c))}p.Tt=g("qA");function I3c(a){a.qA||a.Tv||P_(a);a.dispatchEvent("Fe")}p.reset=function(){P_(this);this.dispatchEvent("De")};function P_(a){a.RQ=null;a.C.clear();a.HS=null;a.Tv=null;a.qA=!1;a.zZ=!1}p.Oa=function(){delete this.RQ;delete this.C;delete this.HS;delete this.Tv;L3c.qa.Oa.call(this)};function M3c(a,b,c,d,e,f){DM.call(this,a,b,c,d,e,2,0,f)}y(M3c,DM);M3c.prototype.$=function(a){return Etb(this,a,"range-border cell-border waffle-docos-target-cell-border")};function N3c(a,b,c,d,e,f,h){J.call(this);this.D=a;this.$a=b;this.H=c;this.Wa=d;this.L=e;this.C=f;this.$=b.$a;this.F=b.C;this.O=b.O;this.R=oyb();this.xb=h||zo();this.J=new al;this.va=new al;this.Ia=new al;this.Ba=new al;this.Pa=new yj(this);this.Fa(this.Pa);O3c(this);this.Pa.V(this.F,"K",this.w1b).V(this.C,"ve",this.Ulb).V(this.C,"we",this.Wlb).V(this.C,"ue",this.Tlb).V(this.C,"xe",this.gpb).V(this.C,"ye",this.t1b).V(this.C,"Fe",this.v1b).V(this.C,"De",this.u1b).V(this.C,"Ae",this.Fpb).V(this.C,"Ee",
this.AAb).V(this.C,"te",this.epb).V(this.C,"Ce",this.hpb).V(this.C,"ze",this.ipb).V(this.C,"Be",this.Byb);P3c(this)}y(N3c,J);p=N3c.prototype;p.Py=null;p.sha="none";p.QR=500;p.w0=!1;p.ipb=function(){Q_(this)};p.epb=function(a){var b=a.H;b&&Q3c(this,[b],!0);R3c(this,a.H)};p.hpb=function(a){var b=a.H;b&&S3c(this,[b]);R3c(this,a.H)};function R3c(a,b){var c=x3c(a.F,a.O,b);c?(b=cI(a.$,c),a=a.Wa,c=c.$b(),b=l3c(b).length,t3c(u3c(a,c),b),HO(a)):T3c(a)}p.Byb=function(){Q_(this);this.C.Tt()&&U3c(this)};
p.Wlb=function(){Q_(this)};p.Tlb=function(a){a.H?(a=a.H,this.w0=!0,q3c(this.D,this.R.serialize(a)),this.w0=!1):Q_(this)};p.v1b=function(){B3c(this)};function B3c(a){var b=a.C.Tv,c=a.J.isEmpty();a.C.Tt()?U3c(a):b?(V3c(a,[b]),c&&!a.J.isEmpty()&&(a.w0=!0,q3c(a.D,a.R.serialize(b)),a.w0=!1)):c||Q_(a)}p.u1b=function(){Q_(this)};function Q_(a){a.J.clear();var b=a.D;b.C.flushDocoPositions(r3c(b,{}));q3c(a.D,"");Q(a.L,!1);H(a.Py);W3c(a);X3c(a);a.C.Tt()||Y3c(a);Z3c(a,a.C.Tt());P3c(a)}
p.isEmpty=function(){return this.J.isEmpty()&&this.Ia.isEmpty()&&this.va.isEmpty()&&this.Ba.isEmpty()};function P3c(a){var b=RG(a.H);b&&(a.QR=kpb(b.C)/2,a.D.setOption(Docos.OptionName.MAX_DOCO_HEIGHT,a.QR))}function X3c(a){we(a.Ia.od());a.Ia.clear()}function W3c(a){we(a.va.od());a.va.clear()}function Y3c(a){A(a.Ba.od(),function(a){Ws(a,"waffle-docos-target-cell-header")});a.Ba.clear()}p.Ulb=function(a){this.C.Tv||this.C.Tt()||(a=a.docos,a.length?V3c(this,a,!0):$3c(this,!1))};
function V3c(a,b,c){M_(a.D)||S3c(a,a.J.Yp(b).od());Q3c(a,b,c)}function U3c(a){var b=yJ(a.F);b&&(b=cI(a.$,b),V3c(a,l3c(b),!0),a4c(a),b4c(a))}p.t1b=function(a){c4c(this,a.H,a.po)};
function c4c(a,b,c,d){var e=x3c(a.F,a.O,b);if(e){var f=e.$b();if(d4c(a,b)){var h=e4c(a,c);WTa(zF(a.F,f).C,v(e.Xs,e,h)).addCallback(function(){var a=this;if(f4c(this,c)&&!h.equals(yG(e)))EG(e,h),c4c(this,b,c,d);else{OF(rG(e,c))&&eN(RG(this.H)).setVisible(!1);g4c(this,c);V3c(this,[b],!0);W3c(this);X3c(this);Y3c(this);h4c(this,c);Z3c(this,this.C.Tt());if(d){var f=new no(function(){a.D.C.grabFocus()});this.Fa(f);f.start()}this.dispatchEvent("se")}},a)}else a.F.mA(f,v(function(){this.D.C.grabFocus();c4c(this,
b,c,!0)},a))}else a.dispatchEvent("se")}function g4c(a,b){var c=yJ(a.F),d=RG(a.H);if(!a.w0&&c&&d){var e=d.C;d=d.D;var f=ML(e,"waffle",!1,!1),h=212;if(!e.Yb()){var k=Fo("docs-docos-activitybox");k&&qs(k)&&(h+=f.right-ns(k).left)}k=i4c(a,b);b=k.x-f.right+h;a=k.y-f.bottom+a.QR;if(!(0>=b&&0>=a)){d=d.C.Ge();for(d=yl(d.y,d.x,d.y,d.x);ppb(e,d).height<a;)d.height+=1;for(;ppb(e,d).width<b;)d.width+=1;e=d.height;a=d.width;FG(c,D0a(c,y0a(c,vG(c),a,e)))}}}
function f4c(a,b){a=yJ(a.F);return mG(CD(a,"r"),b.y)&&mG(CD(a,"c"),b.x)}function Z3c(a,b){a.Wa.W_(b)}function e4c(a,b){return XF(yJ(a.F),b.y,b.x)||zl(b)}
p.gpb=function(a){if(!this.C.Tt()&&(W3c(this),d4c(this,a.H)&&($3c(this,!0),this.C.Tv!=a.H))){var b=this.R.serialize(a.H),c=this.D;c.C.isDocoResolved(c.D.C[b]||0)?(b=a.po,a=RG(this.H),(c=yJ(this.F))&&a&&b&&(b=XF(c,b.y,b.x)||zl(b),b=Wrc(a,b,"waffle-docos-target-cell-resolved-rect"),qM(a.O,"discussions",b,!0),b.setVisible(!0),this.va.add(b))):(c=a.po,a=RG(this.H),(b=yJ(this.F))&&a&&c&&(c=XF(b,c.y,c.x)||zl(c),b=new M3c(b,a.J,a.C,a.D,new XL(c),this.xb),qM(a.O,"discussions",b,!0),this.va.add(b),b.setVisible(!0)))}};
function j4c(a,b){b&&(Us(b,"waffle-docos-target-cell-header"),a.Ba.add(b))}function h4c(a,b){var c=RG(a.H),d=yJ(a.F);d&&c&&b&&(d=XF(d,b.y,b.x)||zl(b),d=Wrc(c,d,"waffle-docos-target-cell-rect"),qM(c.O,"discussions",d,!0),a.Ia.add(d),d.setVisible(!0),d.getElement()&&a.Pa.V(d.getElement(),["click","contextmenu","dblclick","mousedown","mouseup"],function(a){a.Tg=b;c.dispatchEvent(a)}))}function a4c(a){X3c(a);var b={};A(a.J.od(),function(c){c=MN(a.O,c);var d=c.x+"-"+c.y;b[d]||(h4c(a,c),b[d]=!0)})}
function b4c(a){Y3c(a);var b=yJ(a.F),c=RG(a.H);if(b&&c){var d=c.J;c=c.D;b=cI(a.$,b);var e=jwb(c,"r"),f=kwb(c,"r"),h=jwb(c,"c"),k=kwb(c,"c");A(l3c(b),function(b){b=MN(a.O,b);b.x>=h&&b.x<=k&&j4c(a,d.pb.getElement(sL(d,"ch-",null,MG(d.ob,b.x))));b.y>=e&&b.y<=f&&j4c(a,d.pb.getElement(sL(d,"rh-",LG(d.ob,b.y),null)))})}}p.AAb=function(){T3c(this)};function T3c(a){var b=sb(fc(a.$.C),Number);A(b,function(b){var c=w3c(a.F,b);if(c){var e=cI(a.$,c);c=a.Wa;e=l3c(e).length;t3c(u3c(c,b),e);HO(c)}})}
p.Fpb=function(a){if(a.H){var b=this.R.serialize(a.H);this.D.V3(b,void 0,i4c(this,a.po))}};
function Q3c(a,b,c){for(var d={},e=[],f={},h=0;h<b.length;h++){var k=b[h],l=a.R.serialize(k);var m=a;if(RG(m.H)&&d4c(m,k)){var q=MN(m.O,k);m=k4c(m,e4c(m,q))?m.C.Tt()||m.C.Tv==k||zb(m.C.C.od(),k):!1}else m=!1;m?(m=MN(a.O,k),m=e4c(a,m),q=krc(m),f[q]=f[q]||0,d[l]=i4c(a,m.Ge(),f[q]),f[q]++,a.J.add(k)):e.push(k)}a.J.isEmpty()||$3c(a,!0);kc(d)||(b=a.D,b.C.updateDocoPositions(r3c(b,d)));M_(a.D)||S3c(a,e);if(c)for(c=a.J.od(),d=0;d<c.length;d++){b=a;h=c[d];e=b.R.serialize(h);f=b.D;f=f.C.getDocoMaxHeight(f.D.C[e]||
0);a:switch(h.getType()){case "range":break a;case "workbook-range":break a;default:throw Error("Invalid doco with type: "+h.getType());}h=MN(b.O,h);h=i4c(b,h);m=RG(b.H);k=m.C;l=m.Od;l=l.Ww(l.Rw()-1);q=yJ(b.F).R.y;m=kwb(m.D,"r");k=k.$f(new de(q,m),"r");k+=l;l=vL(RG(b.H).C,"c");h=k-(h.y-l);125>h?h=125:h>b.QR&&(h=b.QR);f!=h&&(h<b.QR||f)&&(b=b.D,b.C.setDocoMaxHeight(b.D.C[e]||0,h))}}
function S3c(a,b){b=a.J.Ko(b).od();a.J.Ec(b);b=sb(b,function(a){return this.R.serialize(a)},a);b.length&&s3c(a.D,b);a.J.isEmpty()&&$3c(a,!1)}
function i4c(a,b,c){var d=RG(a.H),e=yJ(a.F),f=d.C,h=f.Yb(),k=e4c(a,b),l=OL(f,k),m=c?15*c:0;c=h?l.left-m:l.right+m;k=l.top+m;var q=a.C.Tt();a=jl(a.C.HS,b);var t=OF(rG(e,b));q||a||!t?(b=k+125,0<b-kpb(f)&&(e=e.Tj("r")-1,f.Cp(b,"r","waffle")>=e&&(k-=50))):(a=eN(d),q=a.L,uwb(d,sG(e,zl(b)).Ge()),e=a.R.height?a.Ab:0,b=a.$.height,d=Math.min(mqb.height,e+b),b&&(d=d+42+lqb.top,d+=lqb.bottom),e&&(d=d+12+lqb.top,d+=lqb.bottom),e=d,Bpb(a,q),k+=e);l=h?l.right+m+212:l.left-m-212;m=h?0>c-212:c+212>jpb(f);e=h?l>jpb(f):
0>l;m&&!e&&(c=l);return new il(h?JL(f,c,"c"):c,k)}function d4c(a,b){b=x3c(a.F,a.O,b);a=yJ(a.F);return!!b&&b==a}function k4c(a,b){if(!b)return!1;var c=RG(a.H).D,d=!1,e=b.Ge();Ypa(b,function(a,b){var f;if(f=a==e.y)f=null!=dwb(c,new il(b,a));return f?d=!0:!1});return d}p.w1b=function(){O3c(this)};function O3c(a){var b=RG(a.H);b&&(a.xb.appendChild(b.Ej,a.L),a.D.setOption(Docos.OptionName.LAYOUT_RTL,b.C.Yb()),Q(a.L,!1),a.D.setOption(Docos.OptionName.ANCHOR_DIV,a.L),a.D.C.renderAnchorSurface())}
function $3c(a,b){var c=usc(a.L);c=na(c)?1:c;qs(a.L)||(c=0);var d=b&&1>c?"in":!b&&0<c?"out":"none";"none"==d?(H(a.Py),Q(a.L,b)):a.Py&&cu(a.Py)&&a.sha==d||(H(a.Py),Q(a.L,!0),a.Py=new Ax(a.L,c,"in"==d?1:0,250),a.sha=d,"out"==d&&Ge(a.Py,"finish",v(a.Nqb,a)),a.Py.play())}p.Nqb=function(){Q_(this);var a=RG(this.H);a&&GM(a)};
p.Oa=function(){delete this.H;delete this.L;delete this.R;delete this.D;delete this.J;delete this.C;delete this.$;delete this.xb;delete this.sha;delete this.Pa;delete this.O;delete this.F;delete this.$a;H(this.Py);delete this.Py;X3c(this);W3c(this);Y3c(this);N3c.qa.Oa.call(this)};function l4c(a,b,c,d,e,f){G.call(this);this.R=a;this.$=!1;this.Ba=u(b)?b:!0;this.va=u(c)?c:1;this.F=new iR(v(this.H7a,this),d||1E3,e||6E4,f);this.Fa(this.F);this.J=new En(void 0,this);this.C=null;this.L=[];this.H="DCS_Callback"+String(m4c++);this.O=this.D=null}y(l4c,G);var m4c=0;p=l4c.prototype;p.jga=function(){this.C=null;this.$=!0;this.F.stop();this.J.Ub(this.L)};
p.TBa=function(a){a instanceof Fn||(a instanceof Vp&&3==a.code?this.jga():(this.C=null,this.L.push(a instanceof Error?a.message:""),0<this.va--?this.F.start():this.J.Id(this.L)))};p.yg=g("$");p.tIb=function(){this.F.Vb()||this.F.start();var a=new En;Jn(this.J,a);return a};
p.H7a=function(){if(this.Ba){this.D=new Hlc(this.R);this.D.Fh=1E4;var a=v(this.jga,this);ra(this.H,a,void 0);this.O=this.D.send({callback:this.H},void 0,v(this.TBa,this))}else this.C&&this.C.cancel(),this.C=tsc(Qp(this.R),"dcs_main_js",{timeout:1E4}),Gn(this.C,this.jga,this.TBa,this)};p.Oa=function(){this.C&&this.C.cancel();this.J.cancel();ma[this.H]&&(ma[this.H]=ta);this.D&&this.O&&this.D.cancel(this.O);l4c.qa.Oa.call(this)};function n4c(){var a=""+('<div class="'+W("docs-docos-activitybox")+'" role="dialog" aria-label="'+Eu("Comment stream box.")+'"><div class="'+W("docs-docos-activitybox-inner")+'"></div></div>');return V(a)};function o4c(a,b){R.call(this,b);this.C=a}y(o4c,R);p=o4c.prototype;p.iga=null;p.yV=null;p.qW=null;p.uq=null;p.Qya=!1;p.Ha=function(){o4c.qa.Ha.call(this);var a=this.Aa(),b=S(n4c,{},{},a);this.Na=b;ep(b,!0);this.yV=a.getElement("docs-docos-caret");this.iga=a.Fb("docs-docos-activitybox-inner",b);this.C&&(Us(b,"docos-enable-new-header"),Us(this.yV,"docos-enable-new-header"))};
p.Ra=function(){Mu(this.getElement(),"docos");this.qW=new Nr(this.getElement());this.qW.Av("close-box",27);this.uq=new jt(this.getElement(),"toggle_display");lt(this.uq,!0);var a=this.uq;kt(a);a.YY=!1;this.uq.BDa=!1;this.getHandler().V(this.qW,"shortcut",this.G7a).V(this.uq,"show",this.WMb).V(this.uq,"hide",this.VMb).V(this.uq,"beforeshow",this.UMb).V(this.uq,"beforehide",this.TMb)};p.Pb=g("iga");p.WMb=function(){Q(this.yV,!0);this.dispatchEvent("show")};p.VMb=function(){Q(this.yV,!1)};p.UMb=function(){return this.dispatchEvent("beforeshow")};
p.TMb=function(){return this.Qya?!1:this.dispatchEvent("hide")};p.setVisible=function(a){this.uq.setVisible(a)};p.isVisible=function(){return!!this.uq&&this.uq.isVisible()};p.G7a=function(a){switch(a.identifier){case "close-box":this.setVisible(!1)}};p.Oa=function(){H(this.qW);delete this.qW;delete this.yV;delete this.iga;H(this.uq);delete this.uq;o4c.qa.Oa.call(this)};function p4c(a,b,c,d){J.call(this);this.xb=c||new Ao;this.C=a;this.O=!!b;this.D=new o4c(this.C.isDocsStreamHeaderEnabled&&this.C.isDocsStreamHeaderEnabled(),this.xb);this.Va=new yj(this);this.J=new gx(void 0,void 0,!0,tx.getInstance());this.H=d||P.Cta;this.F=!1;this.L=F(E(),"docs-edll");this.C.onReady(v(this.eNb,this))}y(p4c,J);p=p4c.prototype;p.gJ=null;p.$Ka=!1;p.render=ba();
p.eNb=function(){var a=this.xb.getElement("docs-docos-commentsbutton");this.gJ=oS(null);Xt(this.gJ,16,!1);this.gJ.kb(a);lx(this.J,this.gJ,P.dy,nx);P.dy.Qb(Nq,this.HTb,this);this.D.render(a.parentNode.parentNode);Q(this.D.getElement(),!1);P.dy.eb(!0);this.C.setOption(Docos.OptionName.PANE_DIV,this.D.Pb());this.C.setOption(Docos.OptionName.PANE_KB_DIV,this.D.getElement());this.C.setOption(Docos.OptionName.ENABLE_LAZY_LOADING,this.L);if(this.L){var b=this.C.getLinkedDoco();b=!!b&&(!this.C.hasDoco(b)||
this.C.isDocoResolved(b)||!this.C.getDocoPosition(b))}else b=!0;b?G3c(this):this.C.isLinkedDocoDeleted()&&(b=Tu("This comment has been deleted.","info",!0),Ru.getInstance().postMessage(b));this.C.setListener(Docos.OptionName.DIALOG_OPENED,v(this.MOa,this));this.C.setListener(Docos.OptionName.DIALOG_CLOSED,v(this.MOa,this));this.C.setOption(Docos.OptionName.SORT_PANE,!0);this.C.setOption(Docos.OptionName.STREAM_BUTTON,a);Docos.EventType.CREATE_DRAFT&&(this.C.setListener(Docos.EventType.CREATE_DRAFT,
this.U5a,this),this.H.Qb(Lq,this.LOa,this),this.LOa(new HAa("enabled",this.H.isEnabled(),!1)));this.O||this.C.setListener(Docos.EventType.NETWORK_ERROR,this.KMb,this);this.Va.V(this.D,["show","hide"],this.oLb)};p.MOa=function(a){a=a.getArgs().shouldOverrideHide()&&a.getType()==Docos.OptionName.DIALOG_OPENED;this.D.Qya=a};p.LOa=function(a){this.C.setOption(Docos.OptionName.ENABLE_COMMENT_BUTTON,a.newValue)};
p.U5a=function(a){this.D.setVisible(!1);a=a.getArgs();var b=a.isInstantDoco()?P.eYa:this.H;if(a.isInstantDoco()){var c=new Qq;var d=-1==a.getInstantDocoSpacerIndex();D(c,42,d?v3c.b2:v3c.HOVER);c=Br(Cr(new Ar,c),31).build()}b.mc(a,c)};p.HTb=function(){this.F||(this.C.renderPaneSurface(),this.F=!0);var a=this.D,b;if(b=a.uq)b=a.uq,b=!(b.nK||150>Ha()-b.uma);b&&a.uq.setVisible(!0)};
p.KMb=function(){if(!this.$Ka&&P.Nk.isEnabled()){if(this.C.hasPendingContent()){var a=Tu("Failed to post comment due to a network error.","warning",!0);Ru.getInstance().postMessage(a)}this.C.setOption(Docos.OptionName.FATAL_READONLY,!0);this.C.setOption(Docos.OptionName.SHOW_ERRORS,!0);P.Cta.eb(!1,"docos-fatal-reason");this.$Ka=!0}};p.oLb=function(a){a="show"==a.type;this.C.isPaneSurfaceRendered()&&this.C.setOption(Docos.OptionName.SORT_PANE,!a);this.gJ.zc(a);a?this.C.grabFocus():this.dispatchEvent("activity-box-closed")};
function G3c(a){a.F||(a.C.renderPaneSurface(),a.F=!0)}p.Oa=function(){H(this.gJ);delete this.gJ;H(this.Va);delete this.Va;H(this.D);delete this.D;H(this.J);delete this.J;delete this.C;p4c.qa.Oa.call(this)};function q4c(){G.call(this)}y(q4c,Rp);p=q4c.prototype;p.Qeb=function(){return l4c};p.tfb=function(){return p4c};p.qfb=function(){return z3c};p.rfb=function(){return L3c};p.sfb=function(){return N3c};aq("docos",q4c);
