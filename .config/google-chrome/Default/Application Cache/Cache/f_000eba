rW.prototype.eSa=QR(233,function(a){this.J=Lb(arguments,0)});var VEc=[2];function WEc(a){Wc(this,a,0,-1,VEc,null)}y(WEc,Vc);function SX(a){Wc(this,a,0,-1,null,null)}y(SX,Vc);var XEc=[1,2];function YEc(a){Wc(this,a,0,-1,XEc,null)}y(YEc,Vc);var ZEc=[1];function $Ec(a){Wc(this,a,0,-1,ZEc,null)}y($Ec,Vc);var aFc=[1];function bFc(a){Wc(this,a,0,-1,aFc,null)}y(bFc,Vc);var cFc=[1];function dFc(a){Wc(this,a,0,-1,cFc,null)}y(dFc,Vc);var eFc=[3];function fFc(a){Wc(this,a,0,-1,eFc,null)}y(fFc,Vc);
fFc.prototype.getChartType=function(){return B(this,1)};function TX(a){Wc(this,a,0,-1,null,null)}y(TX,Vc);function gFc(a){Wc(this,a,0,-1,null,null)}y(gFc,Vc);function hFc(a){Wc(this,a,0,-1,null,null)}y(hFc,Vc);hFc.prototype.getChartType=function(){return B(this,1)};function iFc(a){Wc(this,a,0,-1,null,null)}y(iFc,Vc);iFc.prototype.jf=function(){return B(this,2)};function UX(a,b){return L(a,2,b)}
function jFc(a,b,c,d,e){return pOb(a,v(function(){return this.C.calculateArrayFormulaResultPreview(b,c,d,e,!1,this.J,!0)},a))}function kFc(a){var b=0;A(a,function(c,d){c.length>a[b].length&&(b=d)});return sb(a[b],function(b,d){return sb(a,function(a){return a[d]})})}function lFc(a){a=WG(a.D);return null!=a?a.toString():"0"}
function mFc(a,b){var c={row:0,nj:0};ritz_api.RitzModelApi.getActiveFilterId(a)&&b&&(b=b.rect,ritz_api.RitzModelApi.getNumberOfRows(a)>b.Nc()+1?c.row=b.Nc()+1:ritz_api.RitzModelApi.getNumberOfColumns(a)>b.Pc()+1&&(c.nj=b.Pc()+1));return c}function nFc(a,b,c,d){b="="!=b[0]?"="+b:b;var e=lFc(a);c=mFc(e,c);(a=jFc(a.C,b,e,c.row,c.nj))&&d&&a.length<a[0].length&&(a=kFc(a));return a}
function oFc(a){if(a)for(var b=1<a.length?1:0;b<a.length;b++){for(var c=!1,d=a[b],e=0;e<d.length;e++)if(!d[e]){c=!0;break}if(!c)return!0}return!1}function pFc(a,b){Ys(a.Na,"waffle-autovis-lightbox-readonly",b);a.D.setVisible(!b)}function qFc(a,b){var c=Ne(a,1)?L(a,1):Number.MIN_VALUE;a=Ne(a,2)?Xf(a):Number.MAX_VALUE;var d=Ne(b,1)?L(b,1):Number.MIN_VALUE;b=Ne(b,2)?Xf(b):Number.MAX_VALUE;return b>c&&a>d||c==d&&a==b}var rFc={RAc:0,txa:1,Vxa:2};
function sFc(a){return jc(Rsc,function(b){return b.match(a)}).getName()}function VX(a,b){var c=[],d={};if(a>b*b)for(var e=0;e<b;e++){do var f=Math.floor(Math.random()*a);while(d[f]);d[f]=1;c.push(f)}else{for(d=0;d<a;d++)c.push(d);for(d=0;d<b;d++)e=Math.floor(Math.random()*(a-d)+d),f=c[d],c[d]=c[e],c[e]=f}return c.slice(0,b)}function WX(a){return a[VX(a.length,1)[0]]}function tFc(a){var b={};A(a,function(a){b[a]||(b[a]=0);b[a]++});Mb(a);Pb(a,function(a,d){return b[d]-b[a]})}
function uFc(){return V('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content"><div class="waffle-assistant-answercard-interpret-content"><div class="waffle-assistant-answercard-interpret"></div></div><div class="waffle-assistant-answercard-answer-content"><div class="waffle-assistant-answercard-pivot-content"></div></div></div></div>')}
function vFc(){return V(""+T(Kv({vd:"waffle-assistant-insert-pivottable-button waffle-assistant-readonly-hidden",content:Bu(""+T(Zw({icon:"docs-icon-img docs-icon-plus"}))),style:4}))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+T(Kv({vd:"waffle-assistant-zoom-button",content:Bu(""+T(Zw({icon:"docs-icon-img docs-icon-zoom-in"}))),style:4}))+"")}
var wFc={j2a:0,Zca:1,xba:2,uca:3,x2a:4,v1a:5,kva:6,UT:7,o1a:8,p1a:9},xFc={UNKNOWN_ERROR:0,tBc:1,Krc:2,udc:3},yFc={dBc:0,Pdc:1,Cba:2,$j:3,WAc:4,Y3b:5,hfc:6},zFc={aBc:0,xA:1,Qrc:2,vrc:3,puc:4},AFc={XAc:0,Mrc:1,ZD:2,Poc:3},BFc={OAc:0,vAc:1,Qhc:2,qzc:3,pzc:4,B7b:5,Apc:6},CFc={tyc:0,$D:1,eXa:2,pAc:3,mxc:4,Y_a:5,rBc:6,Tua:7,Esa:8,lta:9,fU:10},DFc={UNKNOWN:0,I3b:1,H3b:2,G3b:3,a5b:4,O6b:5,v7b:6,cac:7,sec:8,mqc:9,Cuc:10,Nuc:11,Gyc:12,Hyc:13,Uzc:14,auc:15};var EFc={DEFAULT:0,RIGHT:1,LEFT:2,JA:3,sA:4},FFc={u1a:0,tpc:1};function GFc(){K.call(this)}y(GFc,K);var HFc=null;function XX(){K.call(this)}y(XX,K);var IFc=null;XX.prototype.getTitle=function(){return L(this,1)};function YX(){K.call(this)}y(YX,K);var JFc=null;YX.prototype.getPosition=function(){return L(this,1)};YX.prototype.setPosition=function(a){N(this,1,a)};function ZX(){K.call(this)}y(ZX,K);var KFc=null;function $X(){K.call(this)}y($X,K);var LFc=null;
$X.prototype.getTitle=function(){return L(this,3)};GFc.prototype.Ka=function(){var a=HFc;a||(HFc=a=Ve(GFc,{0:{name:"ChartScale",Bb:"virtualanalyst.sheets.ChartScale"},1:{name:"custom_scale",Ja:14,defaultValue:0,type:FFc},2:{name:"factor",Ja:1,type:Number}}));return a};GFc.Ka=GFc.prototype.Ka;XX.prototype.Ka=function(){var a=IFc;a||(IFc=a=Ve(XX,{0:{name:"ChartTitle",Bb:"virtualanalyst.sheets.ChartTitle"},1:{name:"title",Ja:9,type:String}}));return a};XX.Ka=XX.prototype.Ka;
YX.prototype.Ka=function(){var a=JFc;a||(JFc=a=Ve(YX,{0:{name:"ChartLegend",Bb:"virtualanalyst.sheets.ChartLegend"},1:{name:"position",Ja:14,defaultValue:0,type:EFc}}));return a};YX.Ka=YX.prototype.Ka;ZX.prototype.Ka=function(){var a=KFc;a||(KFc=a=Ve(ZX,{0:{name:"ChartAxis",Bb:"virtualanalyst.sheets.ChartAxis"},1:{name:"scale",Ja:11,type:GFc}}));return a};ZX.Ka=ZX.prototype.Ka;
$X.prototype.Ka=function(){var a=LFc;a||(LFc=a=Ve($X,{0:{name:"ChartOptions",Bb:"virtualanalyst.sheets.ChartOptions"},1:{name:"h_axis",Ja:11,type:ZX},2:{name:"v_axis",Ja:11,type:ZX},3:{name:"title",Ja:11,type:XX},4:{name:"subtitle",Ja:11,type:XX},5:{name:"legend",Ja:11,type:YX},6:{name:"chart_conversation",Ja:8,type:Boolean}}));return a};$X.Ka=$X.prototype.Ka;function aY(){K.call(this)}y(aY,K);var MFc=null;aY.prototype.Jj=function(){return L(this,1)};function bY(){K.call(this)}y(bY,K);var NFc=null;bY.prototype.getText=function(){return L(this,1)};bY.prototype.Uq=function(){return Ne(this,1)};function cY(){K.call(this)}y(cY,K);var OFc=null;cY.prototype.getStatus=function(){return L(this,1)};cY.prototype.getError=function(){return L(this,9)};function dY(){K.call(this)}y(dY,K);var PFc=null;function QFc(){K.call(this)}y(QFc,K);var RFc=null;
function eY(){K.call(this)}y(eY,K);var SFc=null;eY.prototype.bC=function(){return Ne(this,1)};eY.prototype.getType=function(){return L(this,3)};eY.prototype.setType=function(a){N(this,3,a)};function TFc(){K.call(this)}y(TFc,K);var UFc=null;function VFc(){K.call(this)}y(VFc,K);var WFc=null;
aY.prototype.Ka=function(){var a=MFc;a||(MFc=a=Ve(aY,{0:{name:"Error",Bb:"ritz.assistant.Error"},1:{name:"message",Ja:9,type:String},2:{name:"code",Ja:14,defaultValue:0,type:xFc},3:{name:"unsupported_op_reason",Ja:14,defaultValue:0,type:yFc}}));return a};aY.Ka=aY.prototype.Ka;
bY.prototype.Ka=function(){var a=NFc;a||(NFc=a=Ve(bY,{0:{name:"AnswerQueryPhrase",Bb:"ritz.assistant.AnswerQueryPhrase"},1:{name:"text",Ja:9,type:String},2:{name:"start_byte",Ja:5,type:Number},3:{name:"num_bytes",Ja:5,type:Number}}));return a};bY.Ka=bY.prototype.Ka;
cY.prototype.Ka=function(){var a=OFc;a||(OFc=a=Ve(cY,{0:{name:"AnswerResponse",Bb:"ritz.assistant.AnswerResponse"},1:{name:"status",Ja:5,type:Number},10:{name:"parse_status",Ja:14,defaultValue:0,type:zFc},11:{name:"answer_status",Ja:14,defaultValue:0,type:AFc},2:{name:"formula",Ja:9,type:String},3:{name:"debug_parse_response",Ja:9,type:String},4:{name:"interpretation",Ja:9,type:String},5:{name:"debug_interpretation_response",Ja:9,type:String},6:{name:"unused_phrase",yc:!0,Ja:11,type:bY},7:{name:"used_entity_phrase",
yc:!0,Ja:11,type:bY},8:{name:"unused_entity_phrase",yc:!0,Ja:11,type:bY},9:{name:"error",Ja:11,type:aY},12:{name:"alternate_suggestion",yc:!0,Ja:11,type:eY},14:{name:"deprecated_formula_builder_used",Ja:9,type:String},15:{name:"answer_visualization_type",yc:!0,Ja:14,defaultValue:0,type:CFc},16:{name:"formula_builder_used",Ja:14,defaultValue:0,type:DFc},17:{name:"charting_info",Ja:11,type:QFc},18:{name:"answer_field_info",yc:!0,Ja:11,type:dY},19:{name:"charting_formula",Ja:9,type:String},21:{name:"parse_info",
yc:!0,Ja:11,type:TFc},22:{name:"answer_field_info_for_ranges",yc:!0,Ja:11,type:dY},23:{name:"va_query",Ja:9,type:String},24:{name:"pivot_table_def",Ja:11,type:gh}}));return a};cY.Ka=cY.prototype.Ka;dY.prototype.Ka=function(){var a=PFc;a||(PFc=a=Ve(dY,{0:{name:"AnswerFieldInfo",Bb:"ritz.assistant.AnswerFieldInfo"},1:{name:"cell_data_type",Ja:14,defaultValue:0,type:tka},2:{name:"range_ref",Ja:9,type:String}}));return a};dY.Ka=dY.prototype.Ka;
QFc.prototype.Ka=function(){var a=RFc;a||(RFc=a=Ve(QFc,{0:{name:"ChartingInfo",Bb:"ritz.assistant.ChartingInfo"},1:{name:"suggested_type",yc:!0,Ja:14,defaultValue:0,type:CFc},2:{name:"recommended",Ja:8,type:Boolean},3:{name:"user_requested_type",yc:!0,Ja:14,defaultValue:0,type:CFc},4:{name:"show_only_chart",Ja:8,type:Boolean},5:{name:"chart_options",Ja:11,type:$X}}));return a};QFc.Ka=QFc.prototype.Ka;
eY.prototype.Ka=function(){var a=SFc;a||(SFc=a=Ve(eY,{0:{name:"QuerySuggestion",Bb:"ritz.assistant.QuerySuggestion"},1:{name:"query",Ja:9,type:String},2:{name:"formula",Ja:9,type:String},3:{name:"type",Ja:14,defaultValue:0,type:BFc},4:{name:"deprecated_formula_builder_used",Ja:9,type:String},5:{name:"formula_builder_used",Ja:14,defaultValue:0,type:DFc}}));return a};eY.Ka=eY.prototype.Ka;
TFc.prototype.Ka=function(){var a=UFc;a||(UFc=a=Ve(TFc,{0:{name:"ParseInfo",Bb:"ritz.assistant.ParseInfo"},1:{name:"intent_info",yc:!0,Ja:11,type:VFc}}));return a};TFc.Ka=TFc.prototype.Ka;VFc.prototype.Ka=function(){var a=WFc;a||(WFc=a=Ve(VFc,{0:{name:"IntentInfo",Bb:"ritz.assistant.IntentInfo"},1:{name:"intent_type",Ja:14,defaultValue:0,type:wFc}}));return a};VFc.Ka=VFc.prototype.Ka;function fY(){}y(fY,Bv);va(fY);fY.prototype.hc=n("waffle-assistant-button");function XFc(){var a=Au("Ask a question about your data");a='<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container">'+('<div class="waffle-assistant-answers-search-icon">'+T(Zw({icon:"docs-icon-img docs-icon-search-this-document"}))+'</div><input type="text" class="waffle-assistant-answers-input-box" placeholder="'+W(a)+'" aria-label="'+W(a)+'"/></div><div class="waffle-assistant-answers-input-controls"><div class="waffle-assistant-answers-button-container">');
a+='<div class="'+W("waffle-assistant-answers-query-box-button waffle-assistant-answers-clear-query-button")+'">'+T(Zw({icon:"docs-icon-img docs-icon-cancel"}))+'</div></div><div class="waffle-assistant-answers-spinner-container" style="display:none"></div></div></form></div>';return V(a)};function gY(a){R.call(this,a);this.D=new Dv("",new fY,this.Aa());this.Qa(this.D);this.F=new uW(!1,"#4285f4");this.Qa(this.F);this.C=this.J=this.H=null}r(gY,R);gY.prototype.Ha=function(){this.hd(S(XFc))};gY.prototype.hd=function(a){R.prototype.hd.call(this,a)};
gY.prototype.Ra=function(){R.prototype.Ra.call(this);var a=this.Aa();this.C=a.Za("waffle-assistant-answers-query-box",this.Na);this.D.kb(a.Za("waffle-assistant-answers-clear-query-button",this.C));this.H=a.Za("waffle-assistant-answers-spinner-container",this.C);this.F.render(this.H);this.J=a.Za("waffle-assistant-answers-input-box",this.C)};gY.prototype.setVisible=function(a){this.getElement()&&(Q(this.getElement(),a),(a=by)&&a.dispatchEvent("resize"))};function hY(a,b,c){a&&(u(b)||(b=a.hasAttribute("title")?a.getAttribute("title"):""),b=Ta(b),Jv(a,b,void 0),ysc(a),a.setAttribute("data-tooltip-delay",500),Z9b(a,u(c)?c:1))};function YFc(a){var b=a.type;switch(na(b)&&b.toLowerCase()){case "checkbox":case "radio":return a.checked?a.value:null;case "select-one":return b=a.selectedIndex,0<=b?a.options[b].value:null;case "select-multiple":b=[];for(var c,d=0;c=a.options[d];d++)c.selected&&b.push(c.value);return b.length?b:null;default:return null!=a.value?a.value:null}}
function ZFc(a,b){var c=a.type;switch(na(c)&&c.toLowerCase()){case "checkbox":case "radio":a.checked=b;break;case "select-one":a.selectedIndex=-1;if(na(b))for(var d=0;c=a.options[d];d++)if(c.value==b){c.selected=!0;break}break;case "select-multiple":na(b)&&(b=[b]);for(d=0;c=a.options[d];d++)if(c.selected=!1,b)for(var e,f=0;e=b[f];f++)c.value==e&&(c.selected=!0);break;default:a.value=null!=b?b:""}};function $Fc(a,b,c,d,e,f){I.call(this,"sqc");this.R=a;this.F=f||"";this.O=b;this.J=d;this.Ia=e;this.C=c}y($Fc,I);function aGc(a,b,c,d,e,f,h){d=void 0===d?null:d;e=void 0===e?null:e;f=void 0===f?null:f;h=void 0===h?null:h;I.call(this,"answers-submit-query");this.C=a;this.R=b;this.O=c;this.J=d;this.Ia=e;this.F=f;this.Pa=h}y(aGc,I);function bGc(){this.F=[];this.D={};this.J=null;this.C=new Fab}function cGc(a,b,c,d){function e(a){return a.toLowerCase()}Mb(b,void 0,e);Mb(c,void 0,e);Mb(d,void 0,e);A(b,a.H,a);A(c,a.H,a);A(d,a.H,a)}bGc.prototype.H=function(a){var b=a.toLocaleLowerCase(),c=0;if(100>b.length)for(var d=0;d<b.length&&3>c;++d)if(0==d||/[^a-zA-Z0-9]/.test(b[d-1])&&!/[^a-zA-Z0-9]/.test(b[d])){++c;var e=a,f=b.substr(d),h=this.C.get(f);h||(h=[],this.C.add(f,h));h.push(e)}};
function dGc(a,b){a.D[b.toLowerCase()]||(a.D[b.toLowerCase()]=b)}bGc.prototype.$G=function(a,b,c){if(Ta(a||"")){var d=this.J.Am();d=eGc(this,a.substring(0,d));var e=fGc(this,b-d.length,a);d=Ib(d,e)}else d=fGc(this,b);d.length>b&&(d=Lb(d,0,b));c(a,d)};
function fGc(a,b,c){var d=c||"";c=$b(a.D,function(a){return Ma(a,d)});var e=gGc(ec(c),d?1:2,1);a=rb(a.F,function(a){return Ma(a.query,d)&&!e[a.query.toLowerCase()]});b=gGc(a,b-dc(e),2);b=ec(b);var f=sb(b,function(a,b){a.Bqa=b;return a.LTa});A(b,function(a){a.zqa=f});return Ib(b,ec(e))}
function eGc(a,b){for(var c=[],d=3,e={},f=b.toLowerCase(),h={},k=0;k<f.length&&0<d;h={Caa:h.Caa,b_:h.b_,JR:h.JR},++k)if(0==k||" "==f[k-1]&&" "!=f[k]){h.JR={};h.b_=0;h.Caa=f.substr(k);var l=a.C.Ie(h.Caa);A(l,function(b){return function(c){var d=c.length-b.Caa.length;b.b_=Math.max(d,b.b_);c=a.C.get(c);b.JR[d]||(b.JR[d]=[]);Kb(b.JR[d],c)}}(h));for(l=0;l<=h.b_&&0<d;++l){var m=h.JR[l];if(m)for(var q=0;q<m.length&&0<d;++q){var t=m[q];$a(b.toLowerCase(),t.toLowerCase())||e[t]||(--d,c.push({text:t,Rm:"",
eA:0,Gza:f.length-k,LTa:void 0,zqa:[],Bqa:-1}),e[t]=!0)}}}return c}function gGc(a,b,c){b=VX(a.length,Math.min(a.length,b));var d={};A(b,function(b){b=a[b];var e=na(b)?b:b.query;d[e.toLowerCase()]={text:e,Rm:na(b)?"":b.Rm,eA:c,Gza:0,LTa:na(b)?void 0:b.type,zqa:[],Bqa:-1}});return d};function iY(){lL.call(this,"",null,!1)}y(iY,lL);iY.prototype.YC=function(a,b){if(2==a.eA||1==a.eA)return iY.qa.YC.call(this,a.text,b);var c=this.bb(),d=this.Am(),e=" "==c[d];void 0==c[d]&&(c=c.trim(),d>c.length&&(d=c.length));var f=c.substring(0,d-a.Gza)+a.text;e||(f+=" ");a=iY.qa.YC.call(this,{toString:function(){return f+c.substring(d)}},b);b=this.bk;b.blur();b.focus();this.X_(f.length);return a};
iY.prototype.Sf=function(a){var b=iY.qa.Sf.call(this,a);b||39!=a.keyCode||a.ctrlKey||a.shiftKey||(b=this.C,vnb(b)&&b.DF()&&a.preventDefault(),b=!0);return b};function hGc(){return V('<div class="waffle-assistant-answers-ac-suggestion"><div class="waffle-assistant-answers-ac-suggestion-icon-container"><div class="waffle-assistant-answers-ac-suggested-query-icon">'+T(Zw({icon:"docs-icon-img docs-icon-help"}))+'</div><div class="waffle-assistant-answers-ac-session-query-icon">'+T(Zw({icon:"docs-icon-img docs-icon-clock"}))+'</div><div class="waffle-assistant-answers-ac-entity-icon">'+T(Zw({icon:"docs-icon-img docs-icon-arrow-tilted"}))+'</div></div><span class="waffle-assistant-answers-ac-suggestion-text"></span></div>')}
;function iGc(a){this.xb=a||zo()}
iGc.prototype.vu=function(a,b,c){b=S(hGc);var d=this.xb.Za("waffle-assistant-answers-ac-suggestion-text",b);a=a.data;this.xb.Re(d,a.text);d=this.xb.Za("waffle-assistant-answers-ac-entity-icon",b);var e=this.xb.Za("waffle-assistant-answers-ac-suggested-query-icon",b),f=this.xb.Za("waffle-assistant-answers-ac-session-query-icon",b);Q(d,0==a.eA);Q(e,2==a.eA);Q(f,1==a.eA);d="";switch(a.eA){case 0:d="waffle-assistant-answers-ac-row-entity";break;case 1:d="waffle-assistant-answers-ac-row-session-query";break;
case 2:d="waffle-assistant-answers-ac-row-suggested-query"}d&&Us(c,d);this.xb.appendChild(c,b)};function jGc(a,b,c,d){G.call(this);this.O=a;this.D=a.J;this.F=a.D;this.L=a.C;this.H=new iY;this.H.GEa=!0;this.H.Pa=!0;this.Fa(this.H);this.R=c;this.R.J=this.H;a=new kL(null,new iGc(a.Aa()));this.C=new jL(this.R,a,this.H);this.Fa(this.C);this.va=b;this.J=!1;this.$=Br(new Ar,d).build();this.Va=new yj(this);this.Fa(this.Va);kGc(this)}r(jGc,G);
function kGc(a){lGc(a);a.H.C=a.C;a.C.YX=!1;a.C.Y8=6;Nnb(a.H,a.D);hY(a.F.getElement(),"Clear query");a.Va.V(a.C,"update",a.Skb).V(a.L,"submit",a.DJb).V(a.L,"focus",function(){return mGc(a,!0)},!0).V(a.L,"blur",function(){return mGc(a,!1)},!0).V(a.F,"action",a.g5a).V(a.D,"input",a.KUa).V(a.D,"focus",a.jRa);a.F.setVisible(!1)}p=jGc.prototype;p.Oa=function(){G.prototype.Oa.call(this);this.R.J=null};function nGc(a,b,c){c=void 0===c?!1:c;ZFc(a.D,b);c&&a.D.focus();a.KUa()}
function lGc(a){a=a.C.Ed();a.className="waffle-assistant-answers-ac-renderer";a.KL="waffle-assistant-answers-ac-row";a.u2="waffle-assistant-answers-ac-active";a.mla="waffle-assistant-answers-ac-highlighted"}p.Skb=function(a){a.row&&(a=a.row,2==a.eA?(oGc(this,1,a.zqa,a.Bqa,a.Rm,2),this.va.Wb(2652,this.$)):0==a.eA?(this.J=!0,this.va.Wb(2651,this.$)):1==a.eA&&oGc(this,3))};function mGc(a,b){Ys(a.L,"waffle-assistant-answers-query-box-focused",b);a.C.Bf()&&!b&&a.C.Ug()}p.KUa=function(){this.F.setVisible(!!YFc(this.D))};
p.jRa=function(){this.C.Wv(this.D);var a=fb(YFc(this.D));this.H.X_(a.length);snb(this.C,a||"  ");this.C.update(!0)};p.DJb=function(a){a.stopPropagation();a.preventDefault();oGc(this,2)};function oGc(a,b,c,d,e,f){c=void 0===c?null:c;d=void 0===d?null:d;e=void 0===e?null:e;f=void 0===f?null:f;var h=Ta(YFc(a.D));a.F.setVisible(!!h);pGc(a);a.O.dispatchEvent(new aGc(b,h,a.J,c,d,e,f));a.J=!1}p.g5a=function(){ZFc(this.D,"");this.F.setVisible(!1)};function pGc(a){a.D.blur();a.C.Bf()&&a.C.Ug()};function qGc(a,b){R.call(this,b);this.F=a;this.H=new bGc;this.C=new gY(this.Aa());this.Qa(this.C);this.D=null}r(qGc,R);qGc.prototype.hd=function(a){R.prototype.hd.call(this,a);this.C.render(a)};qGc.prototype.Ra=function(){R.prototype.Ra.call(this);this.D=new jGc(this.C,this.F,this.H,4);this.Fa(this.D);Us(this.C.Na,"waffle-assistant-answers-input-with-icon")};function jY(a,b,c,d,e,f){I.call(this,a,b);this.C=b;this.Pa=c;this.Ia=d||null;this.Wa=e||null;this.J=f||null}y(jY,I);jY.prototype.$i=g("Pa");jY.prototype.Ge=g("Ia");function rGc(a,b,c,d,e,f,h){h=void 0===h?null:h;jY.call(this,"Qd",null,d,e,f);this.O=a;this.R=b;this.xc=c;this.F=h}y(rGc,jY);rGc.prototype.Gd=g("xc");function sGc(a,b,c){jY.call(this,"Td",null,2859);this.O=a;this.R=b;this.F=c}y(sGc,jY);function tGc(){return V('<div class="waffle-assistant-card" tabindex="0" role="region">'+(wp?'<div class="waffle-assistant-card-feedback-container waffle-assistant-feedback-card-hidden"></div>':"")+'<div class="waffle-assistant-card-spinner-container"></div><div class="waffle-assistant-card-inner"><div class="waffle-assistant-button-holder waffle-assistant-card-options"></div><div class="waffle-assistant-card-content-container"></div>'+(wp?'<div class="waffle-assistant-thumbs-container"></div>':"")+
"</div></div>")};function uGc(){return V('<div class="waffle-assistant-feedback-card waffle-assistant-feedback-card-hidden"><div class="waffle-assistant-feedback-card-content"><div class="waffle-assistant-feedback-card-text">Tell us what could be improved.</div><div class="waffle-assistant-feedback-card-link">Send feedback</div></div></div>')};function vGc(a,b){R.call(this,b);this.D=a;this.C=new Dv("",new tW,this.Aa());this.Qa(this.C)}y(vGc,R);p=vGc.prototype;p.Ha=function(){this.Na=S(uGc)};p.Ra=function(){vGc.qa.Ra.call(this);var a=this.Za("waffle-assistant-feedback-card-link");this.C.kb(a);this.getHandler().V(this.Na,"mousedown",this.T0b).V(this.C,"action",this.S0b);this.show(!1)};p.T0b=function(a){a.stopPropagation()};
p.show=function(a){var b=this.Na,c=this.Za("waffle-assistant-feedback-card-link");Ys(b,"waffle-assistant-feedback-card-hidden",!a);ep(c,a)};p.S0b=function(){P.Ys.mc({source:this.D});this.show(!1);this.dispatchEvent(new I("feedback-dialog-opened"))};function wGc(){var a=""+('<div class="waffle-assistant-thumbs"><div class="waffle-assistant-thumbs-text">Was this useful?</div><div class="waffle-assistant-thumbs-button-holder"><div class="waffle-assistant-thumbs-up-button">'+T(Zw({icon:"docs-icon-img docs-icon-thumb-up"}))+'</div><div class="waffle-assistant-thumbs-down-button">'+T(Zw({icon:"docs-icon-img docs-icon-thumb-down"}))+"</div></div></div>");return V(a)};function kY(a){R.call(this,a);this.C=new Dv("",new fY,this.Aa());this.Qa(this.C);this.D=new Dv("",new fY,this.Aa());this.Qa(this.D)}y(kY,R);kY.prototype.Ha=function(){this.Na=S(wGc)};kY.prototype.Ra=function(){kY.qa.Ra.call(this);var a=this.Za("waffle-assistant-thumbs-down-button");this.C.kb(a);hY(a,"Not useful");a=this.Za("waffle-assistant-thumbs-up-button");this.D.kb(a);hY(a,"Useful");this.getHandler().V(this.C,"action",this.F).V(this.D,"action",this.H)};
function xGc(a,b){a.Aa().Re(a.Za("waffle-assistant-thumbs-text"),b)}kY.prototype.F=function(){this.dispatchEvent(new I("thumbs-down"));Q(this.Na,!1)};kY.prototype.H=function(){this.dispatchEvent(new I("thumbs-up"));Q(this.Na,!1)};function lY(a,b){var c=this;R.call(this,b);this.F=a;this.Pa=this.Ia=this.Ba=null;this.Nb=new uW(!0,"#4285f4");this.Qa(this.Nb);this.Zb=this.Vc=this.ke=!1;this.ib=new no(function(){c.ib.stop();c.Na.parentNode.querySelector(":hover")==c.Na?c.ib.start():c.wT()},100);this.Fa(this.ib);this.Cf=this.Gc=!1}y(lY,R);p=lY.prototype;p.nA=ui;p.N7=vi;p.FB=wi;p.EB=wi;p.U5=wi;p.Jia=wi;p.Iia=wi;p.pA=da("Cf");p.zd=g("Cf");p.Ha=function(){this.Na=S(tGc)};
p.Ra=function(){lY.qa.Ra.call(this);var a=this.Za("waffle-assistant-card-spinner-container");this.Nb.render(a);Sr(this.Za("waffle-assistant-card-inner"),"visibility","hidden");if(this.nA()){a=this.Na;var b=new at(a);this.Fa(b);this.getHandler().V(b,"focusin",this.Mlb).V(b,"focusout",this.Llb).V(a,"mouseenter",this.$0).V(a,"mouseleave",this.wT)}yGc(this,!1);wp&&(this.Pa=new vGc(this.Xy(),this.Aa()),this.Pa.render(this.Za("waffle-assistant-card-feedback-container")),this.getHandler().V(this.Pa,"feedback-dialog-opened",
this.Rqb).V(this,"trigger_feedback",this.eWb),this.N7()?(this.Ia=new kY(this.Aa()),this.Ia.render(this.Za("waffle-assistant-thumbs-container")),zGc(this,!0),a=fb(this.U5()),Qa(a)||xGc(this.Ia,a),a=fb(this.Jia()),Qa(a)||hY(this.Ia.Za("waffle-assistant-thumbs-up-button"),a),a=fb(this.Iia()),Qa(a)||hY(this.Ia.Za("waffle-assistant-thumbs-down-button"),a),this.getHandler().V(this.Ia,"thumbs-down",this.Q0b).V(this.Ia,"thumbs-up",this.R0b)):zGc(this,!1));this.hA()};
function mY(a){return a.Za("waffle-assistant-card-content-container")}function AGc(a){a.nA();return a.Za("waffle-assistant-card-options")}function zGc(a,b){wp&&Q(a.Za("waffle-assistant-thumbs-container"),a.N7()&&b)}p.TI=function(){this.isDisposed()||(this.ke=!0,BGc(this))};function CGc(a,b){!a.Vc&&b&&(a.Vc=!0,BGc(a))}function BGc(a){if(a.ke&&a.Vc){var b=v(a.P0b,a);a.oA(b)}}p.$0=function(){this.Zb||(yGc(this,!0),this.Zb=!0,this.ib.start())};p.wT=function(){yGc(this,!1);this.Zb=!1};
p.Mlb=function(){yGc(this,!0)};p.Llb=function(){var a=this,b=new no(function(){ap(a.Na,document.activeElement)||a.Na.parentNode.querySelector(":hover")==a.Na||yGc(a,!1)},0);this.Fa(b);b.start()};p.Q0b=function(){DGc(this,!0);zGc(this,!1);var a=this.EB();this.dispatchEvent(new jY("Vd",this,a))};p.R0b=function(){zGc(this,!1);var a=this.FB();this.dispatchEvent(new jY("Vd",this,a))};p.Rqb=function(){DGc(this,!1)};p.eWb=function(){DGc(this,!0)};
function yGc(a,b){var c=a.Za("waffle-assistant-card-options");a=a.nA();Q(c,a&&b)}p.P0b=function(){vW(this.Nb,!1);Q(this.Nb.Na,!1);Sr(this.Za("waffle-assistant-card-inner"),"visibility","visible");this.dispatchEvent(new I("content-rendered"))};function DGc(a,b){Ys(a.Za("waffle-assistant-card-feedback-container"),"waffle-assistant-feedback-card-hidden",!b);a.Pa.show(b)};function EGc(a){a=""+('<div class="waffle-assistant-feature-section"><div class="waffle-assistant-section-header"><div class="waffle-assistant-section-title">'+T(a.title)+"</div>"+T(Kv({vd:"waffle-assistant-section-more-button",content:Bu("More"),style:4}))+'</div><div class="waffle-assistant-section-content"></div><div class="waffle-assistant-section-card-holder"></div></div>');return V(a)};function FGc(a){return V('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0" y="0" height="'+W(a.iconSize)+'px" width="'+W(a.iconSize)+'px" viewBox="0 0 24 24" preserveAspectRatio="none"><path fill="'+W(a.color)+'" d="M19,2 L5,2 C3.9,2 3,2.9 3,4 L3,18 C3,19.1 3.9,20 5,20 L9,20 L12,23 L15,20 L19,20 C20.1,20 21,19.1 21,18 L21,4 C21,2.9 20.1,2 19,2 L19,2 Z M13.88,12.88 L12,17 L10.12,12.88 L6,11 L10.12,9.12 L12,5 L13.88,9.12 L18,11 L13.88,12.88 L13.88,12.88 Z"/></svg>')}
;function GGc(){var a=V;var b=""+('<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content">'+T(FGc({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div aria-live="polite"><div class="waffle-assistant-empty-list-title">Nothing interesting here right now</div><div class="waffle-assistant-empty-list-body">Try selecting different data. Information with numbers works best.</div></div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try an example</a></div></div></div>');
b=V(b);return a('<div class="waffle-assistant-scroll-pane" style="display: none;"><div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-panel-pane">'+b+'<div class="waffle-assistant-panel-content-container"><div class="waffle-assistant-panel-card-holder"></div></div></div></div>')}
function HGc(a){return V('<div class="waffle-assistant-panel-title-bar">'+T(Kv({vd:"waffle-assistant-panel-back-button",content:Bu(""+T(Zw({icon:"docs-icon-img-container docs-explore-img docs-explore-back-white"}))),style:4}))+'<div class="waffle-assistant-title-text" role="heading">'+T(a.title)+"</div></div>")};function nY(a){R.call(this,a);this.wc=new uW(!1,"#4285f4");this.Qa(this.wc);this.H=new R(this.Aa());this.Qa(this.H);this.C=[];this.ke=this.Zb=!1;this.jd=this.Vc=this.ib=this.$=null;this.Lb=new Lv("",a,4);Xt(this.Lb,2,!1);this.Qa(this.Lb)}y(nY,R);var IGc={defaultHelpArticleId:"6280499"};p=nY.prototype;p.Ha=function(){nY.qa.Ha.call(this);this.Na=S(GGc);this.Vc=this.Za("waffle-assistant-panel-content-container");this.jd=this.Za("waffle-assistant-empty-list")};
p.Ra=function(){nY.qa.Ra.call(this);var a=this.Za("waffle-assistant-spinner-container");this.wc.render(a);this.H.kb(this.Za("waffle-assistant-panel-card-holder"));this.Lb.kb(this.Za("waffle-assistant-empty-list-learn-more"));this.getHandler().V(this.Lb,"action",this.U0b).V(this.Na,"scroll",ksc(this.jba,10,this))};p.setVisible=function(a){var b=this;Q(this.Na,a);A(this.C,function(a){if(!a.Xb()){var c=b.H.Wc();a.Ba=c;b.H.Qa(a,!0);a.TI()}});this.Zb=a};
p.Koa=function(a,b){var c=this.Aa();this.$&&this.L3();this.$=new R;this.Qa(this.$);a=pu(a,HGc,{title:b});this.ib=new Lv("",this.Aa());this.$.Qa(this.ib);this.ib.kb(c.Za("waffle-assistant-panel-back-button",a));hY(this.ib.Na,"Back");this.$.getHandler().V(this.ib,"action",this.hlb)};p.L3=function(){this.$.dispose();this.$=null};function JGc(a,b){vW(a.wc,b);Q(a.Za("waffle-assistant-panel-pane"),!b)}p.lH=function(a){Q(this.jd,a);Q(this.Vc,!a)};
function KGc(a,b){Gb(a.C,b);a.H.removeChild(b);a.H.gh(b,0);a.C.push(b)}p.XG=function(a){Gb(this.C,a);-1!=Cs(this.H,a)&&this.H.removeChild(a,!0)};p.EV=function(){this.H.Dd(!0);we(this.C);this.C=[]};p.jba=function(){var a=this.Na;a=a.scrollTop+ms(a).height;for(var b=0,c=0;c<this.C.length;c++){var d=this.C[c];b<a?(CGc(d,!0),b+=ms(d.Na).height):CGc(d,!1)}};function LGc(a,b){a.ke=b;A(a.C,function(a){a.pA(b)})}p.zd=g("ke");p.U0b=function(){P.Xn.mc(IGc)};p.hlb=function(){this.dispatchEvent("Nd")};function oY(a,b,c,d){R.call(this,d);this.$=a;this.ib=b;this.va=new Lv("",this.Aa());this.Qa(this.va);this.J=new R(this.Aa());this.Qa(this.J);this.C=null;this.gb=[];this.cb=this.$a=!1;this.R=c}y(oY,R);p=oY.prototype;p.dLa=ui;p.Mpa=vi;p.Ha=function(){oY.qa.Ha.call(this);this.Na=S(EGc,{title:this.getTitle()})};
p.Ra=function(){oY.qa.Ra.call(this);this.J.kb(this.Za("waffle-assistant-section-card-holder"));this.va.kb(this.Za("waffle-assistant-section-more-button"));this.getHandler().V(this.va,"action",this.Pvb);this.C=this.AAa();this.Fa(this.C);Q(MGc(this),this.dLa());this.setVisible(!1)};p.setVisible=function(a){if(this.Xb()&&this.isVisible()!=a&&(Q(this.Na,a),a)){Q(this.va.Na,this.Qpa());a=new Sq;D(a,4,this.a1());var b=new Qq;bd(b,58,a);a=Cr(Br(new Ar,10),b).build();this.R.Wb(2774,a)}};
p.isVisible=function(){return this.Xb()&&qs(this.Na)};p.Qpa=function(){return this.gb.length>this.$};p.AAa=function(){return new nY(this.Aa())};p.XM=function(a){this.cb=a;A(NGc(this),function(b){b.pA(a)});LGc(this.C,a)};p.zd=g("cb");p.Df=ta;
p.WM=function(a){this.gb=a;for(var b=0;b<a.length;b++){if(this.J.Wc()<this.$){var c=this.tO(a[b]);c.pA(this.cb);var d=this.J.Wc();c.Ba=d;this.J.Qa(c,!0)}if(this.Mpa()&&(this.C.lH(!1),c=this.C,d=this.tO(a[b]),c.C.push(d),c.Zb)){JGc(c,!1);var e=c.H.Wc();d.Ba=e;c.H.Qa(d,!0);d.TI()}}};function NGc(a){var b=[];a.J.vf(function(a){b.push(a)});return b}function MGc(a){return a.Za("waffle-assistant-section-content")}p.cla=function(){return this.J.H7()};
p.xT=function(){this.gb=[];we(this.J.Dd(!0));this.setVisible(!1);this.Mpa()&&(this.C.EV(),this.C.lH(!0))};function OGc(a){a.J.vf(function(a,c){c<this.$&&a.TI()},a)}p.YM=function(a){var b=0;if(this.$a)this.C.jba();else if(this.cla()){this.setVisible(!0);b=ms(this.Za("waffle-assistant-section-header")).height+ms(MGc(this)).height;for(var c=NGc(this),d=0;d<c.length;d++)b<a&&d<this.$?(this.nIa(c[d]),CGc(c[d],!0),b+=ms(c[d].Na).height):CGc(c[d],!1)}else this.setVisible(!1);return a-b};p.nIa=ta;
p.b1=function(a){(this.$a=a)||this.C.L3()};p.Vb=g("$a");function PGc(a,b){a.C.Koa(b,a.getTitle())}p.Pvb=function(){this.b1(!0);this.dispatchEvent("Sd")};var QGc={options:{hAxis:{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},vAxes:[{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0}],fontName:"Roboto",legacyContinuousAxisRemoved:!0,booleanRole:"certainty",theme:"material",width:null,height:null}};function RGc(a){var b=new YI(qc(QGc));return txc(a,b)}
function SGc(a,b){a.setOption("legend.position","none");a.setOption("hAxis.slantedText",!1);a.setOption("hAxis.textStyle.fontSize",11);a.setOption("vAxes.0.textStyle.fontSize",11);a.setOption("vAxes.1.textStyle.fontSize",11);a.setOption("fontStyle.size",10);a.setOption("fontStyle.italic",!1);a.setOption("titleTextStyle.bold",!1);a.setOption("titleTextStyle.fontSize",12);a.setOption("async",40);!1!==a.jc("useFirstColumnAsDomain")&&a.Gd()&&"number"===a.Gd().Xc(0)&&a.setOption("hAxis.gridlines.count",
-1);var c=15;if(!1!==a.jc("useFirstColumnAsDomain")&&a.Gd()&&"string"===a.Gd().Xc(0)){c=0;var d=Mo("span");d.style.fontSize="11px";d.style.fontFamily="Roboto,Arial";b.appendChild(d);for(b=0;b<a.Gd().getNumberOfRows();b++)cp(d,a.Gd().wf(b,0)),c=Math.max(c,us(d).width);Uo(d);c=Math.min(27,Math.max(15,10+100*c/271))}Ap&&zp||Bp||(a.setOption("chartArea.top","15%"),b=a.jc("hAxis.title"),a.setOption("chartArea.height",Qa(fb(b))?"80%":"65%"),a.setOption("chartArea.left",c+"%"),a.setOption("chartArea.width",
95-c+"%"),"PieChart"==a.getChartType()&&(a.setOption("chartArea.top",Qa(fb(a.jc("title")))?"12%":"15%"),a.setOption("chartArea.height","70%"),a.setOption("chartArea.left","0%"),a.setOption("chartArea.width","100%"),a.setOption("pieSliceText","none"),a.setOption("legend.position","labeled"),a.setOption("legend.textStyle.fontSize",10)));return a};function TGc(a,b,c){var d=a.Nc(),e=a.Pc();switch(b){case 0:d=Math.min(d,a.kc()+c);break;case 1:e=Math.min(e,a.gc()+c)}return Vl(a.Jb(),a.kc(),a.gc(),d,e)}function UGc(a){var b=new NAa;D(b,1,""+a.fd);var c=a.rect.kc();D(b,2,c);c=a.rect.Nc();D(b,3,c);c=a.rect.gc();D(b,4,c);a=a.rect.Pc();D(b,5,a);return b}function VGc(a){var b=new Qq;if(a){var c=new Sq;a=UGc(a);bd(c,7,a);bd(b,58,c)}return b};function WGc(){return V('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-before-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-preview"></div><div class="waffle-assistant-after-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-highlights"></div></div>')}
function XGc(){return V(""+T(Kv({vd:"waffle-assistant-insert-chart-button waffle-assistant-readonly-hidden",content:Bu(""+T(Zw({icon:"docs-icon-img docs-icon-insert-autovis-chart"}))),style:4}))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+T(Kv({vd:"waffle-assistant-zoom-button",content:Bu(""+T(Zw({icon:"docs-icon-img docs-icon-zoom-in"}))),style:4}))+"")};function YGc(a){var b="",c='By <span class="waffle-assistant-facet-title">'+(T(a.m5a)+"</span>"),d=0==a.YDa.length;b+='<div class="waffle-assistant-facet-section"><div class="waffle-assistant-facet-header"><div class="waffle-assistant-pie-icon"></div><div class="waffle-assistant-facet-top-text">'+c+'</div><div class="waffle-assistant-facet-toggle" tabindex="0"></div></div>';if(d)c=V('<div class="waffle-assistant-facet-by-color-container"><div class="waffle-assistant-faceted-chart waffle-assistant-facet-by-color"></div></div>');
else{c='<div class="waffle-assistant-facet-charts-container">';a=a.YDa;for(var e=a.length,f=0;f<e;f++){var h=a[f];c+=(0==f%2?'<div class="waffle-assistant-facet-chart-row">':"")+'<div class="waffle-assistant-single-facet"><div class="waffle-assistant-single-facet-title">';c=h?c+T(h):c+"(empty)";c+='</div><div class="waffle-assistant-faceted-chart"></div></div>'+(1==f%2||f==e-1?"</div>":"")}c=V(c+"</div>")}b+='<div class="waffle-assistant-facet-content-wrapper'+(d?" waffle-assistant-facet-white-section":
"")+'">'+c+(wp?'<div class="waffle-assistant-facet-feedback-container"></div><div class="waffle-assistant-facet-thumbs-container"></div>':"")+"</div></div>";return V(b)};function ZGc(a,b,c,d,e,f,h,k){R.call(this,k);this.H=a;this.D=b;this.L=e;this.O=f;this.F=h;this.C=this.xc=null;this.J=Br(new Ar,10).build()}y(ZGc,R);p=ZGc.prototype;p.Ra=function(){ZGc.qa.Ra.call(this);(new HV(cJ,this.D.Vf())).send(v(this.lob,this,this.D))};p.RIa=function(a,b){a=new rGc(this.H.clone(),this.L,this.xc,2746,a,b);this.dispatchEvent(a)};p.lob=function(a,b){b&&(b.Vh()?NI.dE(this.Na,b):(b=b.Gd(),a.Qd(b),lW(a,b),OI(a,"ready",v(this.C0b,this,a)),LW(a,this.Na,this.O,this.F,Bp),this.xc=b))};
p.C0b=function(a){a.Dl()&&(OI(a.Dl(),"onmouseover",v(this.A0b,this)),OI(a.Dl(),"onmouseout",v(this.B0b,this)))};p.A0b=function(){this.C=Ha()};p.B0b=function(){qa(this.C)&&500<Ha()-this.C&&this.F.Wb(2750,this.J);this.C=null};function $Gc(a,b,c,d,e,f){R.call(this,f);this.J=a;this.Wa=b;this.$a=c;this.Ia=d;this.Ba=e;this.L=Se(this.J,23);this.Pa=L(this.J,22);this.D=L(this.J,26);this.va=[];this.Mc=new Tl;this.O=this.F=this.C=null;this.R=!1;this.$=new Lv("",this.Aa());this.Qa(this.$);this.H=null}y($Gc,R);p=$Gc.prototype;p.Ha=function(){$Gc.qa.Ha.call(this);this.Na=S(YGc,{m5a:this.D,YDa:this.L});this.Na.style.visibility="hidden"};
p.Ra=function(){$Gc.qa.Ra.call(this);var a=this.Za("waffle-assistant-facet-toggle");this.$.kb(a);this.getHandler().V(this.Na,"mousedown",this.x0b).V(this.$,"action",this.$Db);wp&&(this.O=new vGc("assistantAutovisFacetFeedback",this.Aa()),this.O.render(this.Za("waffle-assistant-facet-feedback-container")),this.C=new kY(this.Aa()),this.Qa(this.C),this.C.render(this.Za("waffle-assistant-facet-thumbs-container")),xGc(this.C,this.L.length?"Were these charts useful?":"Was this chart useful?"),this.getHandler().V(this.C,
"thumbs-up",this.z0b).V(this.C,"thumbs-down",this.y0b));aHc(this,oxa)};p.zd=g("R");p.x0b=function(a){a.stopPropagation()};p.$Db=function(){var a=Ts(this.Za("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden");aHc(this,a);bHc(this,a?2647:2646)};
function aHc(a,b){var c=a.Za("waffle-assistant-facet-toggle");cp(c,b?"HIDE":"SHOW");Ys(a.Za("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden",!b);A(a.Di("waffle-assistant-faceted-chart"),function(a){ep(a,b)});a.C&&Q(a.C.Na,b);var d='Show chart broken down by "'+(a.D+'"');a='Hide chart broken down by "'+(a.D+'"');hY(c,b?a:d)}
function cHc(a){a.setOption("legend","top");a.setOption("titleTextStyle.fontSize",10);a.setOption("allowAsync",!0);a.setOption("applyAggregateData",void 0);a.setOption("pieSliceTextStyle.fontSize",11);a.setOption("tooltip.textStyle.fontSize",11);"BarChart"==a.getChartType()&&a.setOption("isStacked",!0)}function dHc(a){"BarChart"==a.getChartType()&&a.setOption("isStacked",!0);a.setOption("applyAggregateData",void 0)}
function eHc(a){a.R||A(a.va,v(function(a){var b=a.Na;if(!this.Ba.contains(b)){var d=this.Ba;a=new fHc(b,a);MAb(d,a)}},a))}p.z0b=function(){bHc(this,2649)};p.y0b=function(){bHc(this,2648);this.O.show(!0)};function bHc(a,b){var c=a.Ia,d=new oW,e=a.H.getChartType();d.C=e;e=a.H.Gd();d.F=e?e.clone():null;pW(c,b,d,10,a.H,a.H.Vf())};function pY(a,b,c,d,e,f,h,k){lY.call(this,a,k);this.C=L(a,8);this.Kb=b;this.Db=c;this.Lb=d;this.L=e;this.gb=f;this.Sb=h;this.O=new Lv("",this.Aa());this.Qa(this.O);this.R=new Lv("",this.Aa());this.Qa(this.R);this.Mc=new Tl;this.Ab=null;this.Wa=!1;this.wb=[];this.jb=[];this.cb=[];this.$a=this.va=this.D=this.H=this.$=null;a=VGc(this.Sb);this.J=Cr(Br(new Ar,10),a).build()}y(pY,lY);
var qY={dWa:"waffle-assistant-after-chart-preview",AWa:"waffle-assistant-before-chart-preview",LWa:"waffle-assistant-card-draggable",G1:"waffle-assistant-chart-highlights",zZa:"waffle-assistant-insert-chart-button",Ova:"waffle-assistant-chart-preview",U0a:"waffle-assistant-button-separator",z1a:"waffle-assistant-styled-border",A1a:"waffle-assistant-styled-rect",N2a:"waffle-assistant-zoom-button"};p=pY.prototype;p.oA=function(a){this.Ab=a;gHc(this)};
p.hA=function(){hHc(this,v(function(a){a=Ssc(this.Kb,a);Rs(this.Na,a)},this),!1)};p.nA=vi;p.Xy=n("autovisFeedback");p.FB=n(2208);p.EB=n(2207);p.U5=n("Was this chart useful?");p.Ha=function(){pY.qa.Ha.call(this);mY(this).appendChild(S(WGc));AGc(this).appendChild(S(XGc));if(Ne(this.C,22)){this.D=new $Gc(this.C,this.Ba,this.Lb,this.L,this.gb,this.Aa());this.Qa(this.D,!0);var a=this.D,b=this.zd();a.R=b;eHc(a)}};
p.Ra=function(){pY.qa.Ra.call(this);Us(this.Na,qY.LWa);var a=this.Za(qY.zZa);this.O.kb(a);hY(a,"Insert chart");a=this.Za(qY.N2a);this.R.kb(a);hY(a,"View full size");a=this.Za(qY.AWa);var b=this.Za(qY.dWa);this.getHandler().V(this.Na,"keydown",this.u0b).V(a,"focus",this.qlb).V(b,"focus",this.bkb).V(this.O,"action",this.Atb).V(this.O.Na,"mousedown",this.Ura).V(this.R,"action",this.LFb).V(this.R.Na,"mousedown",this.Ura).V(this.Za(qY.G1),"mousedown",this.Ura).V(TD(this.Kb),"Ca",this.v0b);iHc(this);this.L.Wb(2790,
this.J);this.D&&this.L.Wb(2791,this.J)};p.pA=function(a){pY.qa.pA.call(this,a);iHc(this);this.Xb()&&jHc(this)};function iHc(a){if(a.Xb()){var b=a.zd();a.O.setVisible(!b);a=a.Aa().Za(qY.U0a,AGc(a));Q(a,!b)}}p.u0b=function(a){13==a.keyCode&&a.target==this.Na&&(a.preventDefault(),a.stopPropagation(),kHc(this,2255))};
function lHc(a){var b=a.getChartType(),c=!!L(a.C,14),d=L(a.C,16),e=!!L(a.C,15),f="Histogram"==b;b="PieChart"==b;for(var h=psc(Se(a.F,4)),k=1<h.length,l=[],m=0;m<h.length;m++){var q=h[m].rect;q=c!=b?jrc(q,new ml(q.width,1)):jrc(q,new ml(1,q.height));Kb(l,q)}c=RG(a.Db).D;var t=[];for(w in dl)t.push(upb(c,dl[w]));var w=sb(l,function(a){return sb(t,Fa(Cl,a))});f&&e&&(w=Lb(w,1));a.cb=mHc(w.length,b&&0<d||!f&&!b&&e,b&&k);d=RG(a.Db);for(e=0;e<w.length;e++)for(f=a.cb[e],b=0;b<w[e].length;b++)w[e][b]&&Nl(w[e][b])&&
(k=Wrc(d,w[e][b],qY.A1a),a.Fa(k),qM(d.O,"default",k,!0),Sr(k.Na,"background-color",f),k.setVisible(!0),a.wb.push(k),k=NM(d,w[e][b],qY.z1a,1,0),a.Fa(k),Vpb(k,f),k.setVisible(!0),a.jb.push(k))}function nHc(a){we(a.wb);we(a.jb);a.wb=[];a.jb=[];a.cb=[]}p.v0b=function(){this.Wa&&(nHc(this),lHc(this))};p.$0=function(){pY.qa.$0.call(this);this.va=Ha();this.Wa||(lHc(this),this.Wa=!0)};
p.wT=function(){pY.qa.wT.call(this);qa(this.va)&&500<Ha()-this.va&&this.L.Wb(2789,this.J);this.va=null;nHc(this);this.Wa=!1};p.qlb=function(){var a=this.Za(qY.G1);qs(a)?a.focus():this.Na.nextSibling&&this.Na.nextSibling.focus()};p.bkb=function(){var a;if(a=this.Pa)a=this.Pa,a.Fb("waffle-assistant-feedback-card-hidden")?a=!1:(a.Za("waffle-assistant-feedback-card-link").focus(),a=!0);a||this.R.Na.focus()};p.Atb=function(){kHc(this,2255)};p.Ura=function(a){a.stopPropagation()};
p.LFb=function(){wNa.mc(this,this.J)};p.RIa=function(a,b){kHc(this,2257,a,b)};function kHc(a,b,c,d){hHc(a,v(function(a){a=new rGc(a,this.Ba,this.H&&this.H.Gd(),b,c,d,mCa(this.J));this.dispatchEvent(a)},a),!1)}
p.w0b=function(a,b){if(b){var c=this.Za(qY.Ova);if(b.Vh())NI.dE(c,b);else{a.Qd(b.Gd());lW(a,a.Gd());ZU(a,"ready",v(this.t0b,this,a));b=[];try{var d=new Hh;d.setContext(a.toJSON());var e=!!L(this.C,14);N(d,3,e);var f=L(this.C,16);N(d,4,f);N(d,5,"ROWS"==(e?"ROWS":"COLS"));N(d,8,0);if(L(this.C,24)){var h=L(this.C,25);N(d,9,h)}var k=psc(Se(this.F,4));for(e=0;e<k.length;e++)d.addRange(Yl(k[e].rect,k[e].fd));var l=this.Mc.serialize(d);b=sb(bzc(Fa(ritz_api.RitzModelApi.getVerbalHighlightsForProto,l),a).call(),
Zyc)}catch(m){b=[]}d=this.Za(qY.G1);Q(d,0<b.length);0<b.length&&(d.appendChild(b[0]),ep(d,!0));this.H=a;LW(a,c,this.Lb,this.L,Bp)}}};p.t0b=function(a){null!==this.$&&(ae(Zd(),this.$),this.$=null);this.isDisposed()||(a.Dl()&&(OI(a.Dl(),"onmouseover",v(this.r0b,this)),OI(a.Dl(),"onmouseout",v(this.s0b,this))),this.Ab(),jHc(this))};p.r0b=function(){this.$a=Ha()};p.s0b=function(){qa(this.$a)&&500<Ha()-this.$a&&this.L.Wb(2795,this.J);this.$a=null};
function jHc(a){if(!a.zd()){var b=a.Za(qY.Ova);if(!a.gb.contains(b)){var c=a.gb;a=new fHc(b,a);MAb(c,a)}}}function oHc(a){a.Gc&&(a.$=$d(Zd(),Ym.Hsa),a.Gc=!1);L(a.C,16);var b=RGc(a.C);b.Q$(cJ);var c=vxc(a.F);b.Wi(c.toString());a.D&&(c=c.clone(),a.D.F=c);return b}
function gHc(a){var b=oHc(a);b=SGc(b,a.Za("waffle-assistant-card-inner"));(new HV(cJ,b.Vf())).send(v(a.w0b,a,b));a.D&&hHc(a,v(function(a){var c=this.D,e=b;a=new YI(a.toJSON());e=new YI(e.toJSON());var f=c.Di("waffle-assistant-faceted-chart");if(1<f.length){dHc(a);var h=e;cHc(h);h.setOption("pieSliceText","percentage");h.setOption("axisFontSize",0);h.setOption("hAxis.title",null);h.setOption("hAxis.textPosition","none");h.setOption("vAxes.0.title",null);h.setOption("vAxes.0.textPosition","none");h.setOption("vAxes.1.title",
null);h.setOption("vAxes.1.textPosition","none");Ap&&zp||Bp||h.setOption("chartArea",{left:"5%",top:"5%",width:"90%",height:"90%"});h.setOption("legend","none");h.setOption("titleTextStyle.fontSize",0)}else h=a,dHc(h),h.setOption("applyAggregateData",void 0),h.setOption("legend","right"),cHc(e);h=psc(Se(c.J,27));K8a(c.F,h);h=L(c.J,25);for(var k=0;k<f.length;k++){var l=na(c.L[k])?c.L[k]:null,m=h.clone(),q=c.Pa,t=new Mh;N(t,1,q);na(l)&&t.fb(l);N(m,7,t);c.F.rc("dt",encodeURIComponent(JSON.stringify(c.Mc.serialize(m))));
q=new YI(a.toJSON());q.Wi(c.F.toString());m=e.clone();m.Wi(c.F.toString());var w=c,x=q.jc("title");x||(x=sFc(q));t=x+(' when "'+(w.D+('" is "'+(l+'"'))));w=x+(' by "'+(w.D+'"'));t=l?t:w;q.setOption("title",t);m.setOption("title",t);w=new ZGc(q,m,0,0,c.Wa,c.$a,c.Ia,c.Aa());c.Qa(w);t=f[k];w.kb(t);c.va.push(w);w=c;x=sFc(q);q=x+(' broken down by "'+(w.D+('" for "'+(l+'"'))));w=x+(' broken down by "'+(w.D+'"'));Rs(t,l?q:w);c.H=m}eHc(c);c.Na.style.visibility="visible"},a),!1)}
function hHc(a,b,c){var d=oHc(a);(new HV(cJ,d.Vf())).send(function(a){a?(a=a.Gd(),c&&d.Qd(a),lW(d,a),b(d)):b(null)})}p.getChartType=function(){return this.C.getChartType()};function mHc(a,b,c){var d=b?["#666"]:[];c&&(a/=2);b&&--a;b=Ivc("material").colors;for(var e=0;e<a;e++)d.push(b[e%b.length].color);c&&Kb(d,d);return d};function fHc(a){wO.apply(this,arguments)}r(fHc,wO);fHc.prototype.Uia=g("element");function pHc(){uO.call(this);this.Wa.push(this);this.Ba=this.Ia=!0;this.ib="waffle-assistant-dragged-card"}y(pHc,LAb);pHc.prototype.contains=function(a){return!!A(this.L,function(b){if(b.element==a)return!0})};pHc.prototype.Sia=function(a){var b=pHc.qa.Sia.call(this,a);if(Ap&&zp||Bp){a=a.querySelectorAll("CANVAS");for(var c=b.querySelectorAll("CANVAS"),d=0;d<a.length;d++)c[d].getContext("2d").drawImage(a[d],0,0)}else a=sb(b.querySelectorAll("clippath"),function(a){return a.id}),qHc(b,a);return b};
function qHc(a,b){for(var c=a.getAttribute&&a.getAttribute("clip-path"),d=0;d<b.length;d++){var e=b[d];na(c)&&$a(c,e)&&a.setAttribute("clip-path",c.replace(e,e+"-clone"));e==a.id&&(a.id=e+"-clone")}a=Wo(a);for(c=0;c<a.length;c++)qHc(a[c],b)};function rHc(){return V('<div class="waffle-assistant-word-cloud-card"><div class="waffle-assistant-word-cloud-title"></div><div class="waffle-assistant-word-cloud-words-container"></div></div>')};function sHc(a,b){lY.call(this,a,b);this.C=L(a,8)}y(sHc,lY);p=sHc.prototype;p.hA=ta;p.Xy=n("assistantWordCloudFeedback");p.FB=n(2634);p.EB=n(2633);p.Ha=function(){sHc.qa.Ha.call(this);mY(this).appendChild(S(rHc));Us(mY(this),"waffle-assistant-word-cloud-content-container")};
p.oA=function(a){for(var b=Se(this.C,19),c=Se(this.C,20),d=this.Za("waffle-assistant-word-cloud-words-container"),e=0;e<b.length;e++)if(tHc(this,b,c,e),120<d.clientHeight){tHc(this,b,c,e-1);break}b=this.Aa();c=L(this.C,2);c=op(b,c);d=this.Za("waffle-assistant-word-cloud-title");b.appendChild(d,c);a()};
function tHc(a,b,c,d){var e=a.Za("waffle-assistant-word-cloud-words-container");for(a=a.Aa();e.firstChild;)e.removeChild(e.firstChild);for(var f=c[d],h=c[0],k=0;k<=d;k++){0!=k&&e.appendChild(op(a," "));var l=a.createElement("SPAN");a.appendChild(l,op(a,b[k]));a.appendChild(e,l);Us(l,"waffle-assistant-word-cloud-word");var m=c[k];l.style.color=0==k%2?"#00695C":"#61443C";l.style.fontSize=(m-f)/(h-f)*15+9+"px"}};function rY(a,b,c,d,e,f){oY.call(this,20,e,d,f);this.Ba=a;this.L=b;this.Ia=c;this.D=new pHc;this.Fa(this.D);this.F=null;this.H=0;this.O=null}y(rY,oY);p=rY.prototype;p.Ra=function(){rY.qa.Ra.call(this);this.D.Ce();this.getHandler().V(this.D,"drag",this.q0b).V(this.D,"dragend",this.p0b)};p.getTitle=n("Analysis");p.sV=function(a){return 0==a};p.tO=function(a){return"WordCloud"==L(a,8).getChartType()?new sHc(a,this.Aa()):new pY(a,this.Ba,this.L,this.Ia,this.R,this.D,this.O,this.Aa())};
p.XM=function(a){rY.qa.XM.call(this,a);a&&pAb(this.D)};p.nIa=function(a){this.getHandler().Oc(a,"content-rendered",this.o0b);this.H++};p.WM=function(a,b){this.O=b||null;rY.qa.WM.call(this,a,b)};p.o0b=function(){0==--this.H&&this.dispatchEvent("Pd")};p.q0b=function(){this.F=fs(this.D.Zc.target)};p.p0b=function(a){var b=this.F,c=RG(this.L).C;if(ul(ML(c,"page",!1,!1)).contains(b)){var d=LL(c,b.x,b.y,"page");c=PL(c,d,"page");b=new il(b.x-c.left,b.y-c.top);a.C.getData().RIa(d,b)}this.F=null};p.a1=n(2);function uHc(a){var b=[];if(Ne(a,25)&&(a=L(a,25)))for(var c=0;c<Oe(a,1);c++){var d=L(a,1,c);if(Ne(d,2)){var e=L(d,2);e&&b.push(vHc(e,wHc(d)))}}return b}function xHc(a){var b=uHc(a);Ne(a,6)&&(a=L(a,6))&&b.push(vHc(a,0));return b}function wHc(a){return(a=Ne(a,4)?L(a,4):0)?a:0}function vHc(a,b){return{name:a,k3a:b}};function yHc(a,b,c){this.Ba=a;this.Ia=b;this.L=[];this.O=[];this.H=[];this.J=[];this.$=[];this.va=[];this.C={};this.F={};this.R={};this.D={};zHc(this,c)}function AHc(a,b){return a[b]?a[b].values.od():[]}
function zHc(a,b){for(var c=new al,d=new al,e=0;e<b.length;e++){for(var f=xHc(b[e]),h=[],k=[],l=0;l<f.length;l++){var m=f[l].name.toLowerCase();if(void 0!=a.Ba[m]){var q=a.Ba[m];c.add(q);h.push(q)}void 0!=a.Ia[m]&&(m=a.Ia[m],d.add(m),k.push(m))}BHc(a,h,k)}a.L=c.od();a.O=d.od();Pb(a.L);Pb(a.O);a.H=sb(ec(a.C),function(a){return a.key});Pb(a.H);a.J=sb(ec(a.F),function(a){return a.key});Pb(a.J);a.$=sb(ec(a.R),function(a){return a.key});Pb(a.$);a.va=sb(ec(a.D),function(a){return a.key});Pb(a.va)}
function BHc(a,b,c){for(var d=0;d<b.length;d++)for(var e=d+1;e<b.length;e++)b[d]!=b[e]&&(CHc(a.C,b[d],b[e]),CHc(a.C,b[e],b[d]));for(d=0;d<b.length;d++)for(e=0;e<c.length;e++)CHc(a.F,b[d],c[e]),CHc(a.R,c[e],b[d]);for(b=0;b<c.length;b++)for(d=b+1;d<c.length;d++)c[b]!=c[d]&&(CHc(a.D,c[b],c[d]),CHc(a.D,c[d],c[b]))}function CHc(a,b,c){var d;a[b]?d=a[b].values:d=new al;d.add(c);a[b]={key:b,values:d}};function DHc(a,b){this.C=a;for(var c={},d=0;d<a.Rj();d++)c[a.dd(d).getName().toLowerCase()]=d;this.O=c;c={};for(d=0;d<Oe(a,1);d++)c[L(a,1,d).getName().toLowerCase()]=d;this.R=c;c={};for(d=0;d<this.C.Rj();d++)c[L(this.C.dd(d),11)]=d;this.va=c;c={};for(d=0;d<Oe(this.C,1);d++)c[L(L(this.C,1,d),4)]=d;this.Ba=c;c=[];for(d=0;d<a.Rj();d++)sY(a.dd(d).getName())&&c.push(d);this.J=c;c=[];for(d=0;d<Oe(a,1);d++)sY(L(a,1,d).getName())&&c.push(d);this.L=c;c=[];for(d=0;d<Oe(a,1);d++){for(var e=L(a,1,d).getName(),
f=!0,h=0;h<EHc.length;h++)if(-1!=e.search(new RegExp("(\\b|_)"+EHc[h]+"(\\b|_)","i"))){f=!1;break}f&&c.push(d)}this.Pa=c;this.$a=FHc(a,0);this.$=FHc(a,1);c=[];for(d=0;d<a.Rj();d++).8<=L(a.dd(d),6)&&c.push(d);this.Ia=c;c=[];for(d=0;d<a.Rj();d++)e=a.dd(d),.95<=Se(e,2).length/L(e,8)&&c.push(d);this.cb=c;c=[];for(d=0;d<Oe(a,3);d++){e=a.dd(L(a,3,d));a:if(.5<Se(e,2).length/L(e,8)||.3>Oe(e,3)/Oe(e,2))e=!1;else{for(f=0;f<Oe(e,10);f++)if(.95<L(e,10,f)/L(e,8)){e=!1;break a}e=!0}e&&c.push(L(a,3,d))}Pb(c);this.Wa=
c;this.F=GHc(a.Rj());this.H=GHc(Oe(a,1));this.D=new yHc(this.O,this.R,b)}function GHc(a){for(var b=[],c=0;c<a;c++)b.push(c);return b}function FHc(a,b){for(var c=[],d=0;d<a.Rj();d++)a.dd(d).getType()==b&&c.push(d);return c}function HHc(a,b){if(0==a.length&&0==b.length)return[];for(var c=0<a.length?a[0]:b[0],d=1;d<a.length;d++)c=IHc(c,a[d]);for(a=0;a<b.length;a++)d=IHc(c,b[a]),c=0<d.length?d:c;return c}
function tY(a,b,c,d,e,f,h,k){var l=[a.J,a.D.L],m=[a.F];c&&(m.push(a.$a),m.push(a.Ia));d&&m.push(a.Wa);e&&m.push(a.cb);null!=h&&-1!=h?l.push(AHc(a.D.R,h)):f&&l.push(a.D.J);k&&l.push(a.D.H);a=HHc(m,l);b=IHc(a,b);return 0<b.length?{index:WX(b),hB:3}:0<a.length?{index:WX(a),hB:1}:JHc()}
function uY(a,b,c,d,e,f){var h=[a.L,a.D.O],k=[a.H];c&&k.push(a.Pa);null!=e&&-1!=e?h.push(AHc(a.D.F,e)):d&&h.push(a.D.$);f&&h.push(a.D.va);a=HHc(k,h);b=IHc(a,b);return 0<b.length?{index:WX(b),hB:3}:0<a.length?{index:WX(a),hB:1}:JHc()}function KHc(a,b){for(var c=5;;){var d=a.C.dd(b),e=VX(Oe(d,2),1)[0];c--;if(sY(UX(d,e))||0==c)return e}}function LHc(a,b){for(var c=5;;){var d=a.C.dd(b),e=VX(Oe(d,3),1)[0];e=L(d,3,e);c--;if(sY(UX(d,e))||0==c)return e}}
function vY(a,b){b=a.C.dd(b);a=b.getName();sY(a)||(b=MHc(Se(b,7)),a=null==b?a:b);return a}function wY(a,b){b=L(a.C,1,b);a=b.getName();sY(a)||(b=MHc(Se(b,2)),a=null==b?a:b);return a}function MHc(a){for(var b=0;b<a.length;b++)if(sY(a[b]))return a[b];return null}function sY(a){return null==a?!1:50>=a.length}function NHc(a,b){return b.toLowerCase()in a.O?a.O[b.toLowerCase()]:-1}function JHc(){return{index:-1,hB:0}}
function OHc(a){for(var b=VX(a.length,2),c=[],d=0;d<b.length;d++)c.push({index:a[b[d]],hB:1});return c}function IHc(a,b){Pb(a);Pb(b);for(var c=[],d=0,e=0;d<a.length&&e<b.length;)a[d]==b[e]?(c.push(a[d]),d++,e++):a[d]<b[e]?d++:e++;return c}var EHc=["average","total","sum","mean","median"];function xY(a){this.$a=a;this.$v=[];this.C=this.Ba=this.va=this.IK=this.pH=null;this.R=[];this.Ia=[];this.O=new al;this.Pa=new al;this.$=!1;this.D=[];this.F=[]}p=xY.prototype;p.Ce=function(a,b,c,d,e,f){this.reset();this.pH=b;this.IK=c;this.va=d;this.Ba=a;this.Ia=f;this.R=jxa?e:[];this.C=new DHc(a,e)};
p.n9=function(){PHc(this);var a=[];if(jxa)for(var b=0;b<this.R.length;b++){var c=this.R[b];switch(c.getChartType()){case "BarChart":if(this.lk(13)||this.lk(2)){var d=L(c,6);if(d&&-1!=NHc(this.C,d)){var e=QHc(this,c);1<e.length&&(yp&&this.lk(23)?yY(this,a,"Scatter chart of "+e[0].name+" vs "+e[1].name,23,2):this.lk(2)&&yY(this,a,"Correlation of "+e[0].name+" and "+e[1].name,2,1.5))}}break;case "ScatterChart":var f=QHc(this,c);1<f.length&&(yp&&this.lk(23)?yY(this,a,"Scatter chart of "+f[0].name+" vs "+
f[1].name,23,2):this.lk(2)&&yY(this,a,"Correlation of "+f[0].name+" and "+f[1].name,2,1.5));break;case "PieChart":for(var h=void 0,k=[],l=uHc(c),m=0;m<l.length&&-1!=NHc(this.C,l[m].name);m++)k.push(l[m]);h=k;1==h.length&&4==h[0].k3a&&(yp&&this.lk(20)?yY(this,a,"Chart of distribution of "+h[0].name,20,2):this.lk(14)&&yY(this,a,"Distribution of "+h[0].name,14,1.5))}}for(var q=0;q<this.Ia.length;q++){var t=this.Ia[q];if(Ne(t,3)){if(!this.lk(26))break;yY(this,a,t.Kg(),26,2)}}if(this.lk(1)){var w=this.C.C,
x=uY(this.C,this.F,!1,!0),z=x.index,C=tY(this.C,this.D,!0,!1,!0,!0,z),M=C.index;if(-1!=M&&-1!=z){var O=10<=Oe(w.dd(M),2)?"5 ":"",U=vY(this.C,M),ea=wY(this.C,z);if(U!=ea){var ca=zY(1,[x],[C]);yY(this,a,this.qGa(1)+" "+O+U+" by "+ea,1,ca)}}}if(this.lk(2)&&1<Oe(this.C.C,1)){a:{var oa=this.C,wa=this.F;if(2>oa.H.length)var ua=[JHc(),JHc()];else{var ya=uY(oa,wa,!1,!1,void 0,!0),Xa=ya.index;if(-1!=Xa){var Wa=AHc(oa.D.D,Xa);if(0<Wa.length){var Ra=[ya],wb=WX(Wa),Nc=2,Rb=IHc(Wa,wa);0<Rb.length&&(wb=WX(Rb),
Nc=3);Ra.push({index:wb,hB:Nc});ua=Ra;break a}}ua=OHc(2<=oa.L.length?oa.L:oa.H)}}var Sc=ua,Uc=wY(this.C,Sc[0].index),ee=wY(this.C,Sc[1].index);if(Uc!=ee){var Bd=zY(1,Sc,[]);yY(this,a,"Correlation of "+Uc+" and "+ee,2,Bd)}}if(this.lk(3)){var Ub=this.C.C,Ue=uY(this.C,this.F,!0),pb=Ue.index;if(-1!=pb){var le=zY(1,[Ue],[]);yY(this,a,this.uP(Se(L(Ub,1,pb),3),3)+" of "+wY(this.C,pb),3,le)}}if(this.lk(5)){var ue=this.C.C,vf=uY(this.C,this.F,!0,!0),Ng=vf.index,Xg=tY(this.C,this.D,!0,!0,!1,!0,Ng),Zh=Xg.index;
if(-1!=Ng&&-1!=Zh){var Gi=wY(this.C,Ng),Hi=ue.dd(Zh),Qk=vY(this.C,Zh);if(0<Oe(Hi,3)&&Qk!=Gi){var pl=zY(1,[vf],[Xg]),Am=LHc(this.C,Zh);yY(this,a,this.uP(Se(L(ue,1,Ng),3),5)+" of "+Gi+" when "+Qk+" is "+UX(Hi,Am),5,pl)}}}if(this.lk(9)){var vj=uY(this.C,this.F,!1,!0),Cg=vj.index,Rk=tY(this.C,this.D,!0,!1,!0,!0,Cg),bj=Rk.index;if(-1!=bj&&-1!=Cg){var Bm=wY(this.C,Cg),pk=vY(this.C,bj);if(pk!=Bm){var ql=zY(1,[vj],[Rk]);yY(this,a,pk+" with "+this.via(9)+" "+Bm,9,ql)}}}if(this.lk(10)&&0<Oe(this.C.C,1)){var cj=
uY(this.C,this.F),oi=zY(1,[cj],[]),$h=wY(this.C,cj.index);yY(this,a,this.via(10)+" "+$h,10,oi)}if(this.lk(11)){var Cm=this.C.C,Ol=tY(this.C,this.D,!0,!0,!1,!1,-1),qk=Ol.index;if(-1!=qk){var hs=vY(this.C,qk);if(0<Oe(Cm.dd(qk),3)){var uh=zY(1,[],[Ol]);yY(this,a,"Most frequent "+hs,11,uh)}}}if(this.lk(12)){var ho=this.C.C,Ip=uY(this.C,this.F,!0),Sk=Ip.index;a:{var Yq=this.C;if(1==Yq.$.length){var Zq=Yq.$[0];if(!L(Yq.C.dd(Zq),5)){var $q=Zq;break a}}$q=-1}var Tk=$q;if(-1!=Tk&&-1!=Sk){var Dm=wY(this.C,
Sk),io=ho.dd(Tk);if(0<Oe(io,2)){var is=zY(1,[Ip],[]),Dx=KHc(this.C,Tk);yY(this,a,this.uP(Se(L(ho,1,Sk),3),12)+" of "+Dm+" "+WX(RHc)+" "+UX(io,Dx),12,is)}}}if(this.lk(15)){var jo=this.C.C,rl=uY(this.C,this.F,!0),Uk=rl.index,ar=tY(this.C,this.D,!1,!0,!1,!0,Uk),Pl=ar.index;if(-1!=Uk&&-1!=Pl){var Vk=wY(this.C,Uk),rk=vY(this.C,Pl);if(rk!=Vk){var Ii=jo.dd(Pl);if(2<=Oe(Ii,3)){var Em=zY(1,[rl],[ar]),js=VX(Oe(Ii,3),2);yY(this,a,"Compare "+this.uP(Se(L(jo,1,Uk),3),15)+" "+Vk+" for "+rk+" "+UX(Ii,L(Ii,3,js[0]))+
" and "+UX(Ii,L(Ii,3,js[1])),15,Em)}}}}if(this.lk(16)){var Fm=tY(this.C,this.D,!0,!0,!1,!1),Jp=Fm.index;if(-1!=Jp){var yn=vY(this.C,Jp),Vj=zY(1,[],[Fm]);yY(this,a,"List unique values in "+yn,16,Vj)}}if(this.lk(17)){var sl=this.C.C,zn=tY(this.C,this.D,!0,!0,!1,!1),sk=zn.index;if(-1!=sk){var An=sl.dd(sk),ko=vY(this.C,sk);if(!(1>Oe(An,3))){var br=LHc(this.C,sk),Bn=zY(1,[],[zn]);yY(this,a,"What percentage of "+ko+" is "+UX(An,br),17,Bn)}}}if(this.lk(13)){var Kp=this.C.C,Lp=uY(this.C,this.F,!0,!0),cr=
Lp.index,lo=tY(this.C,this.D,!0,!0,!1,!0,cr),Cn=lo.index;if(-1!=cr&&-1!=Cn){var Gm=wY(this.C,cr),mo=vY(this.C,Cn);if(mo!=Gm){var tk=zY(1,[Lp],[lo]);yY(this,a,this.uP(Se(L(Kp,1,cr),3),13)+" of "+Gm+" by "+mo,13,tk)}}}if(yp&&this.lk(18)){var vt=uY(this.C,this.F),wt=vt.index;if(-1!=wt){var iv=zY(2,[vt],[]);yY(this,a,"Histogram of "+wY(this.C,wt),18,iv)}}if(this.lk(24)){var eQ=tY(this.C,this.D,!0,!0),VZ=eQ.index;if(-1!=VZ){var lJ=zY(1,[eQ],[]);yY(this,a,"Count of "+vY(this.C,VZ),24,lJ)}}if(this.lk(25)){var WZ=
this.C.C,mJ=tY(this.C,this.D,!0,!0),DA=mJ.index;if(-1!=DA){var uv=WZ.dd(DA),nJ=KHc(this.C,DA),oJ=zY(1,[mJ],[]);yY(this,a,"Count when "+vY(this.C,DA)+" is "+UX(uv,nJ),25,oJ)}}var fQ=3>a.length;if((fQ||0==VX(5,1)[0])&&this.lk(7)){var Iaa=this.C.C,gQ=uY(this.C,this.F,!1,!0),EA=tY(this.C,this.D,!1,!1,!1,!0,gQ.index);if(-1!=EA.index&&-1!=gQ.index){var Lm=Iaa.dd(EA.index),pJ=vY(this.C,EA.index),RE=wY(this.C,gQ.index);if(0<Oe(Lm,2)&&pJ!=RE){var hQ=zY(1,[gQ],[EA]),FA=KHc(this.C,EA.index);yY(this,a,"Show "+
RE+" for "+pJ+" "+UX(Lm,FA),7,hQ)}}}if((fQ||0==VX(5,1)[0])&&this.lk(8)){var qJ=this.C.C;a:{var Nx=this.C,Ox=this.D;if(2>Nx.F.length)var Ht=[JHc(),JHc()];else{var iQ=tY(Nx,Ox,!0,!1,!1,!1,void 0,!0),GA=iQ.index;if(-1!=GA){var rJ=AHc(Nx.D.C,GA);if(0<rJ.length){var jQ=[iQ],vv=WX(rJ),HA=2,SE=IHc(rJ,Ox);0<SE.length&&(vv=WX(SE),HA=3);jQ.push({index:vv,hB:HA});Ht=jQ;break a}}var Px=OHc(2<=Nx.J.length?Nx.J:Nx.F);Px[0].index!=GA&&(Px[1]=Px[0],Px[0]=iQ);Ht=Px}}var IA=Ht,kQ=IA[0].index;if(1<qJ.Rj()&&-1!=kQ){var JA=
IA[1].index,lQ=qJ.dd(JA),wv=vY(this.C,JA),os=vY(this.C,kQ);if(0<Oe(lQ,2)&&wv!=os){var ZQa=zY(1,[],IA),Jaa=KHc(this.C,JA);yY(this,a,"What is "+os+" where "+wv+" is "+UX(lQ,Jaa),8,ZQa)}}}this.$v=SHc(a)};function PHc(a){if(a.$){var b=yJ(a.$a).wj(),c=Te(a.C.C,4);A(b,function(b){var d=b.left,f=b.width;c&&(d=b.top,f=b.height);for(b=0;b<f;b++){var h=a.C.va[d+b],k=a.C.Ba[d+b];h&&0<=h&&Cb(a.D,h);k&&0<=k&&Cb(a.F,k)}})}}p.reset=function(){this.$v=[];this.F=[];this.D=[];this.Pa=new al;this.O=new al};p.o9=function(){return Ei(this.$v.slice())};
function SHc(a){Pb(a,function(a,c){return c.weight-a.weight});return sb(a,function(a){return a.Aqa})}function yY(a,b,c,d,e){e=a.oGa(d,e);a.Pa.contains(c)||(b.push({Aqa:{query:c,Rm:void 0,type:d},weight:e}),a.O.add(d),a.Pa.add(c))}p.lk=function(a){return!this.O.contains(a)};function THc(a,b){return a.o9().then(function(a){return a.length<=b?a:Lb(a,0,b)},null,a)}function zY(a,b,c){A(b,function(b){3==b.hB&&a++});A(c,function(b){3==b.hB&&a++});return a}
function QHc(a,b){var c=[];b=uHc(b);for(var d=0;d<b.length;d++){var e=a.C,f=b[d].name;if(-1==(f.toLowerCase()in e.R?e.R[f.toLowerCase()]:-1))break;c.push(b[d])}return c}p.uP=function(a){a:{if(0<a.length)for(var b=0;b<a.length;b++)switch(a[b]){case 5:a=UHc;break a;case 4:a=VHc;break a}a=WHc}return WX(a)};p.qGa=function(){return WX(XHc)};p.via=function(){return WX(YHc)};
var WHc=["Average","Median"],UHc=["Total","Average","Median"],VHc=["Median"],YHc="Minimum Maximum Most Least Highest Lowest".split(" "),XHc=["Top","Bottom"],RHc=["before","after"];function ZHc(a,b,c){xY.call(this,a);this.J=[];this.L=this.H=null;this.Wa=b;this.gb=c;this.cb=Br(new Ar,10).build()}r(ZHc,xY);p=ZHc.prototype;p.n9=function(){this.reset();xY.prototype.n9.call(this);ixa&&$Hc(this)};p.reset=function(){xY.prototype.reset.call(this);this.J=[];this.H&&(this.H.cancel(),this.H=null)};p.o9=function(){return ixa&&this.H?this.H.then(function(){return this.J.slice()},null,this):xY.prototype.o9.call(this)};p.oGa=function(a,b){return Math.pow(Math.random(),1/(aIc(a)*b))};
p.Df=da("L");function aIc(a){switch(a){case 13:return.34;case 3:return.37;case 12:return.25;case 5:return.3;case 15:return.34;case 2:return.43;case 8:return.76;case 9:return.35;case 14:return.47;case 11:return.4;case 7:return.37;case 10:return.36;case 17:return.41;case 1:return.42;case 16:return.3;default:return.3}}
function $Hc(a){var b=null;a.H=new Ci(function(a){if(!this.L||this.L.getStatus().getState().wh())this.J=this.$v,a();var c=wF(this.pH.rect),e=sb(this.$v,function(a){return a.query});c=eo(co(hn(kn(ln(this.L.ze("/answers/parsesuggestions").uf("gid",this.pH.fd,"range",c),v(function(b){bIc(this,b).then(a)},this)),v(function(b){8==b.errorCode&&this.gb.Wb(2833,this.cb);this.J=this.$v;a()},this)).setContent(["queries",Nj(e)]).setTimeout(2E3),1)),"POST");Gp&&this.IK&&null!=this.va&&(e=0==this.IK.rect.width||
0==this.IK.rect.height?"":wF(this.IK.rect),c.uf("headerRange",e,"tableRecordDimension",""+this.va));b=c.$d()},a);Mi(a.H,function(){b&&b.dispose()})}function bIc(a,b){return a.Wa.C.D.C.then(function(){var a=[];if(b.Ck())for(var d=b.Qe(),e=0;e<d.length;e++){var f;if(f=d[e])f=!!this.Ba&&!!L(this.Ba,4),f=nFc(this.Wa,d[e],this.pH,f),f=oFc(f);f&&(this.$v[e].Rm=d[e],a.push(this.$v[e]))}this.J=a},function(){this.J.length=0},a)};var cIc={};Zb({j2a:{type:0,gA:"",dA:[]},Zca:{type:1,gA:"Sum",dA:[3,5,13,12,15]},xba:{type:2,gA:"Average",dA:[3,5,13,12,15]},uca:{type:3,gA:"Mode",dA:[3]},x2a:{type:4,gA:"Variance",dA:[3]},v1a:{type:5,gA:"Standard deviation",dA:[3]},kva:{type:6,gA:"Median",dA:[3,5,13,12]},UT:{type:7,gA:"Count",dA:[24,25]},o1a:{type:8,gA:"Bottom",dA:[1,10,14]},p1a:{type:9,gA:"Top",dA:[1,11,10,14]}},function(a){cIc[a.type]=a});function dIc(a){if(a=cIc[a])return a};function eIc(a){xY.call(this,a);this.H=[]}r(eIc,xY);p=eIc.prototype;p.reset=function(){xY.prototype.reset.call(this);this.H=[]};p.oGa=function(a,b){return 1+b};p.lk=function(a){return!this.O.contains(a)&&0<fIc(this,a).length};p.qGa=function(a){return gIc(this,a)};p.uP=function(a,b){return gIc(this,b)};p.via=function(a){return gIc(this,a)};function hIc(a,b){a.reset();A(b,function(b){A(Se(b,1),function(b){a.H.push(L(b,1))},a)},a);tFc(a.H);a.n9();return THc(a,3)}
function fIc(a,b){return rb(a.H,function(a){return zb(dIc(a).dA,b)},a)}function iIc(a,b){a=xb(a.H,function(a){return dIc(a).type==b},a);return dIc(a)}function gIc(a,b){b=fIc(a,b);return iIc(a,WX(b)).gA};function jIc(){this.D=this.J="";this.L=!1;this.F=0;this.O=!1;this.H=0;this.C=""}jIc.prototype.getTitle=g("J");var kIc="help;how can;how do i;how do you;how do u;how to;what can;what does;what is this;how does this".split(";"),lIc=[{Qj:["Thank you","Thankyou","Thanks"],qq:"No problem"},{Qj:["you are amazing","This is great","omg"],qq:"Happy to help"},{Qj:["I love you"],qq:"Must be in the air"},{Qj:["How do you know","How are you so smart"],qq:"It's all in the data"},{Qj:["Are you sure"],qq:"Send feedback if this doesn't seem correct to help improve accuracy"},{Qj:["How are you"],qq:"Pretty good, thanks"},
{Qj:["Hi","Hello","Hey"],qq:"Hi, there. Try asking a question about your data."},{Qj:["You are stupid","This is dumb","You are wrong"],qq:"Help improve this experience by sending feedback"},{Qj:["How smart are you"],qq:"Pretty smart"}];function mIc(a){for(var b=0;b<lIc.length;++b)if(-1!=yb(lIc[b].Qj,function(b){return Ma(a,b)}))return b;return-1};function nIc(a,b,c,d){var e=new dFc;D(e,2,c);A(b,function(a){Yc(e,1).push(a)});D(e,3,d);d=new TX;D(d,1,a);D(d,3,b[c]);bd(d,11,e);return d}function oIc(a,b,c,d){var e=new $Ec;D(e,2,c);A(b,function(a){Yc(e,1).push(a)});D(e,3,d);d=new TX;D(d,1,a);D(d,2,b[c]);bd(d,10,e);return d}function pIc(a){var b=new YEc;A(a,function(a){var c=a.type;Yc(b,1).push(c);a.CEa&&(a=a.CEa,Yc(b,2).push(a))});return b}function qIc(a){var b=new bFc;A(a,function(a){a=a.type;Yc(b,1).push(a)});return b}
function rIc(a,b,c,d){var e=new fFc;a&&D(e,1,a);b&&D(e,2,b);for(a=0;a<c.length;a++)b=c[a],Yc(e,3).push(b);D(e,4,d);return e};function AY(a,b){this.D=a;this.C=b}AY.prototype.getChartType=g("D");var BY={2:new AY("ColumnChart","Column chart"),3:new AY("LineChart","Time series"),4:new AY("ScatterChart","Scatter chart"),5:new AY("PieChart","Pie chart"),10:new AY("Histogram","Histogram"),7:new AY("LineChart","Line chart")};function CY(a,b,c,d,e,f,h){this.D=a;this.RA=b;this.H=(void 0===h?null:h)||b;this.C=d;this.Rm=c;this.Wa=d?Se(d,6):[];this.$a=d?Se(d,7):[];this.Pa=d?Se(d,8):[];this.error=e||1;this.interpretation=d&&Ne(d,4)?L(d,4):null;this.va=new jIc;this.O=d?Se(d,12):[];this.Ia=d?Se(d,21):[];this.Ba=f;this.F=null;this.$=this.J=!1;this.L=[];this.R=null;yp&&sIc(this)}function tIc(a){return 1==a.error&&null!=a.Rm}
function uIc(a){return{yL:vIc(a),interpretation:a.interpretation,RA:a.RA,Rm:a.Rm,eL:1<a.RA.length&&1<a.RA[0].length,Nj:a.Nj(),aqa:a.$,jx:a.jx(),b8:a.L}}CY.prototype.Nj=function(){return yp&&null!=this.F&&(this.F in BY?!0:!1)&&2<this.H.length};CY.prototype.jx=function(){return xp&&F(E(),"feapt")&&null!==this.C&&Ne(this.C,24)};CY.prototype.getChartType=function(){if(!this.Nj())return null;var a=this.F;if(a in BY)return BY[a].getChartType();throw Error("Unknown chart type.");};
function wIc(a){a.Nj();return a.H[0][0]}function xIc(a){return sb(Se(a.C,22),function(b){if(L(b,2)){var c=a.Ba.C;return uF(L(b,2),c)}},a)}function yIc(a){return{yL:vIc(a),error:zIc(a)}}function AIc(a,b,c){var d=c.length;if(0==d)return a;1<d&&Gb(a,10);c=L(c[0],1);2<d&&9==c&&Gb(a,4);2<d&&Gb(a,5);2!=c&&3!=c&&12!=c&&Gb(a,3);zb(b,10)&&zb(a,10)&&hba(a,function(a){return 10!=a});return a}
function sIc(a){var b=null;a.J=!1;a.F=null;if(a.C&&Ne(a.C,17)){var c=L(a.C,17);a.$=L(c,4)||!1;var d=Se(c,3),e=AIc(Se(c,1),d,Se(a.C,18));0<d.length&&(0==e.length||1>=a.H.length||1>a.H[0].length)?a.L.push("Charts for this question are not supported."):(0<d.length?(b=rb(e,function(a){return zb(d,a)}),c=rb(d,function(a){return!zb(e,a)}),Gb(c,6),0<b.length?(a.J=!0,a.F=b[0],b=a.F):zb(d,10)&&zb(e,2)?(a.J=!0,a.F=2,Gb(c,10),b=a.F):(b=0<c.length?c[0]:6,a.J=!0,a.F=BIc(a,e)),0<c.length&&a.L.push("Requested chart type is not supported for this question.")):
0<e.length&&1<a.H.length&&1<a.H[0].length&&(a.F=BIc(a,e),a.J=L(c,2)||!1,20<=a.H.length||3<=a.H[0].length)&&(a.J=!0),a.R=rIc(a.F,b,e,a.J))}}function BIc(a,b){if(!Se(a.C,18).length)return b[0];a=CIc(a);a=ritz_api.AssistantApi.getAnswersChartsRecommedation(a.toJSON());for(var c=0;c<a.length;c++)if(zb(b,a[c]))return a[c];return b[0]}function DIc(a,b,c){var d={};null!=b?(d.v=EIc(a,b,c),d.f=b):d.v=null;return d}
function CIc(a){for(var b=new FI,c=a.H[0],d=Lb(a.H,1),e=Se(a.C,18),f=[],h=0;h<c.length;h++)e[h]&&Ne(e[h],1)?f.push(FIc(L(e[h],1))):f.push(0==h?"string":"number"),b.vs({type:f[h],label:c[h]||"",id:"Axis"+h});for(e=0;e<d.length;++e){h=[];for(var k=0;k<c.length;k++)h.push(DIc(a,d[e][k],f[k]));b.Ou(h)}return b}
function EIc(a,b,c){switch(c){case "boolean":return"true"==b.toLowerCase()||"1"==b;case "number":return a=a.Ba.L.F,b=(b||"0").replace(new RegExp("[^-0-9"+a+"]","g"),""),b=b.replace(a,"."),lb(b);case "date":case "datetime":return new Date(b);case "timeofday":if(b){a=b.replace(/[^a-zA-Z0-9]/g," ").split(" ");c=[0,0,0,0];if(!(2>a.length)&&Sa(a[0])&&Sa(a[1])&&(Sa(a[a.length-1])||"am"==a[a.length-1].toLowerCase()||"pm"==a[a.length-1].toLowerCase())){for(var d=0;d<b.length&&4>d;d++)Sa(a[d])&&(c[d]=lb(a[d]));
"am"==a[a.length-1].toLowerCase()&&12==c[0]&&(c[0]=0);"pm"==a[a.length-1].toLowerCase()&&12!=c[0]&&(c[0]+=12)}b=c}else b=[0,0,0,0];return b;default:return b||""}}function FIc(a){switch(a){case 1:return"boolean";case 9:return"number";case 2:return"date";case 3:return"datetime";case 12:return"timeofday";default:return"string"}}
function GIc(a){if(!Ne(a.C,9))return"";if(Ne(a.C.getError(),3))switch(L(a.C.getError(),3)){case 1:return"Sorry, questions related to formatting are not supported at this time.";case 2:return"Answers provides formulas based on your data. Charts are currently not supported. Please use the menus to create a chart.";case 3:return"Sorry, this action is not supported at this time.";case 4:return"Sorry, this function is not supported at this time.";case 5:return"Sorry, your question is too generic. Please ask a more specific question.";
default:return"Sorry, this function is not supported at this time."}return a.C.getError().Jj()||""}
function zIc(a){switch(a.error){case 2:return"Looks like you are offline. Try again when you reconnect.";case 3:return"There was a problem getting your answer at this time. Please try again later.";case 4:return"Sorry, couldn't understand your question.";case 5:return"Answers lets you ask question and learn more about your data.";case 6:return GIc(a)||"Sorry, couldn't understand your question.";case 7:return a=mIc(a.D),-1!=a?lIc[a].qq:""}return""}
function vIc(a){var b=[];if(tIc(a)){var c=[];A(Ib(a.Wa,a.Pa),function(a){c.push(HIc(a,"waffle-assistant-answercard-question-unused-phrase"))});A(a.$a,function(a){c.push(HIc(a,"waffle-assistant-answercard-question-used-entity"))});Pb(c,function(a,b){return a.dT>b.dT?1:-1});var d=0;A(c,function(c){var e=c.length,h=c.dT;h>d?b.push({text:a.D.substring(d,h),className:null}):(e-=d-h,h=d);0<e&&(d=h+e,b.push({text:a.D.substring(h,d),className:c.vk}))});d<a.D.length&&b.push({text:a.D.substring(d),className:null})}else b.push({text:a.D,
className:null});return b}function HIc(a,b){return{dT:L(a,2),length:L(a,3),vk:b}};function IIc(a,b,c,d){J.call(this);this.$=a;this.R=b;this.va=c;this.Wa=d;this.Va=new yj(this);this.Fa(this.Va);this.C=new rW;this.Fa(this.C);this.O="";this.L=[];this.F=this.D=this.J=null;this.H=!1;Exc(this.C,this.$);this.C.Ba=10;this.C.gb=!0;this.C.R=!1;this.C.eSa("waffle-assistant-visible");this.C.L=Ta("waffle-assistant-dragged-formula").split(" ");this.C.Ce();this.Va.V(this.C,xxc,this.Ia).V(this.C,Axc,this.Pa).V(this.C,Bxc,this.Ba)}y(IIc,J);
IIc.prototype.Ia=function(a){a=ob(this.$.childNodes,a.C);this.O=this.L[a]};
IIc.prototype.Pa=function(a){var b=a.event instanceof it?a.event.qm:a.event;this.H?(a.J.jz(b,!0),a.preventDefault()):(Yr(a.F,a.event.clientX,a.event.clientY),a=Zr(a.F),b=RG(this.R).C,ul(ML(b,"page",!1,!1)).contains(a)?(a=LL(b,a.x,a.y,"page"),(b=XF(yJ(this.va),a.y,a.x))?a=new il(b.gc(),b.kc()):b=zl(a),this.J=a,this.D&&this.D.getRect().equals(b)||(a=RG(this.R),H(this.D),this.D=Wrc(a,b,"waffle-assistant-formula-insertion-rect"),this.Fa(this.D),qM(a.O,"default",this.D),H(this.F),this.F=NM(a,b,"waffle-assistant-formula-insertion-border",
2,0),this.Fa(this.F),Vpb(this.F,"#000"),this.F.setVisible(!0))):JIc(this))};IIc.prototype.Ba=function(a){if(this.J){YM(RG(this.R),!1);var b=this.J,c=yJ(this.va);b=new dL(c,b,this.O);this.Wa.C(b);this.dispatchEvent(new I("formula_inserted"))}a.J.jz(null,!0);a.preventDefault();this.O="";JIc(this)};function JIc(a){a.J=null;H(a.D);a.D=null;H(a.F);a.F=null};function KIc(){return V('<div class="waffle-assistant-answers-card-remove">'+T(Zw({icon:"docs-icon-img docs-icon-trash"}))+"</div>")}
function LIc(a){var b=a.error,c=a.showHelp;a='<div class="waffle-assistant-answercard-error-container"><div class="waffle-assistant-answercard-error-image">'+T(Zw({icon:"docs-icon-img docs-icon-unsupported-black"}))+'</div><div class="waffle-assistant-errorcard-content">';c?(b=T(b)+' Look in <div class="waffle-assistant-answers-helpcenter-link">Sheets help</div> instead?',a+='<div class="waffle-assistant-errorcard-text">'+b+"</div>"):a+='<div class="waffle-assistant-errorcard-text">'+T(b)+"</div>";
return V(a+"</div></div>")};function MIc(a){var b=V,c='<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+NIc({yL:a.WA.yL}),d={RA:a.WA.RA,Rm:a.WA.Rm,interpretation:a.WA.interpretation,eL:a.WA.eL,Nj:a.WA.Nj,jx:a.WA.jx,aqa:a.WA.aqa,b8:a.WA.b8};!d.RA||za(d.RA);var e=d.RA;a=d.Rm;var f=d.eL,h=d.Nj,k=d.jx,l=d.aqa;za(d.b8);var m=d.b8;d=d||{};d=d.interpretation;d=""+('<div class="waffle-assistant-answercard-answer-header" role="heading" aria-label="'+Eu("Answer")+'"><span aria-hidden="true">Answer</span></div>'+
(d?'<div class="waffle-assistant-answercard-interpret-content"><div class="waffle-assistant-answercard-interpret">'+T(d)+"</div></div>":"")+"");var q='<div class="waffle-assistant-answercard-answer-container">'+V(d)+'<div class="waffle-assistant-answercard-answer-content">';if(e){if(!l)if(h&&(q+='<div class="waffle-assistant-answercard-tabs"><div class="waffle-assistant-answercard-formula-tab">FORMULA</div><div class="waffle-assistant-answercard-pivot-tab">PIVOT TABLE</div><div class="waffle-assistant-answercard-chart-tab" id="waffle-assistant-answercard-chart-tab">CHART</div></div>'),
k)q+='<div class="waffle-assistant-answercard-pivot-content"></div>';else{q+='<div class="waffle-assistant-answercard-answer">';if(f){q+='<div class="waffle-assistant-answercard-answer-rowheader">';l=e[0];d=l.length;for(var t=0;t<d;t++)q+='<span class="waffle-assistant-answercard-answer-col">'+T(l[t])+"</span>";q+="</div>"}q+='<div class="waffle-assistant-answercard-answer-rows">';l=Au("waffle-assistant-answercard-answer-row"+(f?" waffle-assistant-answercard-answer-list-row":""));d=e.length;for(t=
0;t<d;t++){var w=e[t];if(f&&0==t)w="";else{var x=l;za(w);x='<div class="'+W(x)+'">';for(var z=w.length,C=0;C<z;C++){var M=w[C];x=M?x+('<span class="waffle-assistant-answercard-answer-col">'+T(M)+"</span>"):x+('<span class="'+W("waffle-assistant-answercard-answer-col waffle-assistant-answercard-answer-empty")+'">N/A</span>')}w=V(x+"</div>")}q+=w}q+="</div></div>"}q+=h?'<div class="waffle-assistant-answercard-chart-container"><div class="waffle-assistant-answercard-chart-type-select"></div><div class="waffle-assistant-answercard-chart"></div></div>':
""}if(0<m.length){q+='<div class="waffle-assistant-answercard-info-msgs">';e=m.length;for(f=0;f<e;f++)q+='<div class="waffle-assistant-answercard-info-msg">* '+T(m[f])+"</div>";q+="</div>"}q+='<div class="waffle-assistant-answercard-footer">';k&&(q+='<div class="waffle-assistant-answercard-insert-pivot">INSERT PIVOT</div>');h&&(q+='<div class="waffle-assistant-answercard-insert-chart">INSERT CHART</div>');k||(q+='<div class="waffle-assistant-answercard-formula-holder"><div class="waffle-assistant-answercard-see-formula-link">See formula</div><div class="waffle-assistant-answercard-hide-formula-link">Hide formula</div><div class="waffle-assistant-answercard-formula"><div class="waffle-assistant-answercard-formula-help">Click to copy or drag to insert</div><div class="waffle-assistant-answercard-formula-display"><div class="waffle-assistant-answercard-formula-icon">'+
T(Zw({icon:"docs-icon-img docs-icon-insert-formula"}))+'</div><div class="waffle-assistant-answercard-formula-text-container"><div class="waffle-assistant-answercard-formula-text" tabindex="0">'+T(a)+"</div></div></div></div></div>");a=V(q+"</div></div></div>");return b(c+a+"</div></div>")}
function NIc(a){za(a.yL);a=a.yL;var b=""+('<div class="waffle-assistant-answercard-question-container"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+Eu("Question")+'"><span aria-hidden="true">Question</span></div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">');for(var c=a.length,d=0;d<c;d++){var e=a[d];b+=e.className?'<span class="'+W(e.className)+'">'+T(e.text)+"</span>":T(e.text)}return V(b+"</div></div></div>")}
function OIc(a){a=a.jx;return V(""+T(KIc())+(a?'<div class="waffle-assistant-button-separator"></div>'+T(Kv({vd:"waffle-assistant-zoom-button",content:Bu(""+T(Zw({icon:"docs-icon-img docs-icon-zoom-in"}))),style:4})):"")+"")};function PIc(a){this.C=a}function QIc(a,b){var c=new SX;D(c,3,b);D(c,8,zxa);b=new BU;bd(b,4,c);c=new Qq;bd(c,46,b);c=Cr(Br(new Ar,10),c).build();a.C.Wb(2753,c)};function DY(a,b,c,d,e,f,h,k,l,m,q,t,w){lY.call(this,new nH,w);this.D=a;this.Kh=xIc(a);this.jb=a.Nj();this.$a=a.jx();this.ef=q;this.$=this.C=this.Kb=null;this.Ab=a.Nj()&&a.J;this.Od=a.$;this.Sb=!1;this.ag=b;this.Ze=c;this.Be=d;this.Ni=l;this.ji=h;this.R=e;this.Qg=f;this.vg=k;this.He=m;this.gb=Br(new Ar,10).build();this.Hd=new Dv("",new fY,this.Aa());this.Qa(this.Hd);this.$g=t;this.wb=new Dv("",new fY,this.Aa());this.Qa(this.wb);this.Lb=new Dv("",new fY,this.Aa());this.Qa(this.Lb);this.va=null;this.O=
new Dv("",new tW,this.Aa());this.Qa(this.O);this.H=a.va;this.cb=new Dv("",new tW,this.Aa());this.Qa(this.cb);this.Db=new Dv("",new fY,this.Aa());this.Qa(this.Db);this.L=new pV;this.Qa(this.L);this.Wa=new vM("");this.Qa(this.Wa);this.J=null;this.xc=CIc(this.D);this.jd=new AW(b,"waffle-assistant-answers-range-styled-border","waffle-assistant-answers-range-styled-rect");this.Fa(this.jd);this.xd=!1}y(DY,lY);p=DY.prototype;p.Rha=g("vg");p.Ha=function(){DY.qa.Ha.call(this);AGc(this).appendChild(S(OIc,{jx:this.$a}))};
p.Ra=function(){DY.qa.Ra.call(this);var a=this.Za("waffle-assistant-answers-card-remove");this.Hd.kb(a);hY(a,"Remove card",0);this.getHandler().Oc(this.Hd,"action",this.G0b);if(this.D.jx()){a=yJ(this.Ze).$b();var b=this.D;b.jx();b=b.C?L(b.C,24):null;var c=nBc(this.$g,b);this.Kb=new oBc(c,b,this.Ni.L.C,this.ef,a,this.Be)}else this.getHandler().V(this.O,"action",this.eBb).V(this.cb,"action",this.Dsb).Oc(this.O,"action",this.iNa).Oc(this.cb,"action",this.JIb)};
function RIc(a){function b(b,d,e,f){var c=new nV("");c.kb(a.Za(b));a.L.Qa(c);a.getHandler().Oc(c,"action",v(a.GIb,a,d));f||c.setVisible(!1);e&&a.L.iH(c)}a.L.kb(a.Za("waffle-assistant-answercard-tabs"));a.getHandler().V(a.L,"select",a.zDb);b("waffle-assistant-answercard-formula-tab",0,!a.Ab,!a.$a);b("waffle-assistant-answercard-pivot-tab",1,!a.Ab,a.$a);b("waffle-assistant-answercard-chart-tab",2,a.Ab,!0)}
function SIc(a){var b=L(a.D.C,17);b=Se(b,1);for(var c=0;c<b.length;c++)a.Wa.Fd(TIc(b[c]));a.Wa.kb(a.Za("waffle-assistant-answercard-chart-type-select"));vw(a.Wa,TIc(a.D.F));b=a.Za("waffle-assistant-answercard-insert-chart");a.Db.kb(b);UIc(a);a.getHandler().V(a.Db,"action",a.D0b).V(a.Wa.tc(),"action",a.wmb)}
p.oA=function(a){mY(this).appendChild(S(MIc,{WA:uIc(this.D)}));if(this.D.jx()){this.jb&&(RIc(this),SIc(this));var b=this.Za("waffle-assistant-answercard-insert-pivot");this.wb.kb(b);b=this.Za("waffle-assistant-zoom-button");this.Lb.kb(b);hY(b,"Preview Pivot Table");this.getHandler().V(this.wb,"action",this.E0b).V(this.Lb,"action",this.F0b);VIc(this);this.C=this.Aa().Ha("CANVAS","waffle-pivottable-pivot-canvas-border");b=this.Za("waffle-assistant-answercard-pivot-content");this.Aa().appendChild(b,
this.C);qBc(this.Kb,this.C)}else this.O.kb(this.Za("waffle-assistant-answercard-see-formula-link")),this.cb.kb(this.Za("waffle-assistant-answercard-hide-formula-link")),this.va=new IIc(this.Za("waffle-assistant-answercard-formula-text-container"),this.ag,this.Ze,this.Be),b=this.zd(),this.va.H=b,this.va.L=[this.D.Rm],this.Fa(this.va),b=this.Za("waffle-assistant-answercard-formula-text"),Rs(b,"Formula: "+(this.D.Rm+". Click/Press ENTER to copy or drag to insert on to sheet.")),this.getHandler().Oc(this.va,
"formula_inserted",this.IIb).Ng(this.Za("waffle-assistant-answercard-formula-text"),Ie,this.Jrb),WIc(this,this.He),XIc(this),this.He&&(YIc(this,!0),this.getHandler().Ic(this.O,"action",this.iNa)),this.jb&&(this.Od?(ZIc(this,this.D.getChartType()),this.Sb=!0):RIc(this),SIc(this));a()};p.jM=function(){return this.jb&&!this.Od&&!this.Ab};function TIc(a){if(a in BY)return new au(BY[a].C,a);throw Error("Unknown chart type.");}
p.wmb=function(a){a=a.target.hb();if(a in BY)ZIc(this,BY[a].getChartType());else throw Error("Unknown chart type model.");};function $Ic(a,b){a.H.D&&b.setOption("subtitle",a.H.D);b.setOption("hAxis.logScale",a.H.L);b.setOption("vAxis.logScale",a.H.O);a.H.C&&b.setOption("legend.position",a.H.C);a.H.F&&b.setOption("hAxis.formatOptions.scaleFactor",a.H.F);a.H.H&&b.setOption("vAxis.formatOptions.scaleFactor",a.H.H)}
function ZIc(a,b){a.J=new dH;N(a.J,1,b);N(a.J,2,a.D.interpretation||"");if("Histogram"===b)b=wIc(a.D),N(a.J,3,b),N(a.J,6,"Count");else if("LineChart"===b||"ColumnChart"===b)b=0,"number"!=a.xc.Xc(0)&&(b=a.xc.Hf(0),N(a.J,3,b),b=1),1==a.xc.getNumberOfColumns()-b?(b=a.xc.Hf(b),N(a.J,6,b)):N(a.J,6,"Values");else{b=a.J;var c=wIc(a.D);N(b,3,c);c=a.D;c.Nj();N(b,6,c.H[0][1]||"")}b=RGc(a.J);b.Qd(a.xc);c=a.Za("waffle-assistant-answercard-chart");b=SGc(b,c);lW(b,b.Gd());$Ic(a,b);b.setOption("title",a.H.getTitle());
LW(b,c,a.ef.C,a.R,Bp);a.Sb=!0}p.E0b=function(){pBc(this.Kb);this.dispatchEvent("close-sidebar");this.R.C(35559,this.gb)};p.F0b=function(){this.R.C(35587,this.gb);H(this.$);this.$=new sBc(this.Kb,this.Lb,this.D.interpretation||"",this.R,this.gb,35588,this.Aa());this.$.render();this.Fa(this.$);pFc(this.$,this.zd())};
p.D0b=function(){if(this.J){var a=RGc(this.J);a.Qd(this.xc);$Ic(this,a);this.H.getTitle()&&a.setOption("title",this.H.getTitle());lW(a,a.Gd());var b=this.Ba,c=this.xc,d=this.D.F,e=new hFc;D(e,1,d);d=new SX;bd(d,11,e);e=new BU;bd(e,4,d);d=new Qq;bd(d,46,e);this.dispatchEvent(new rGc(a,b,c,2874,void 0,void 0,d))}};p.hA=function(){Rs(this.Na,"Answer Card for question: "+this.D.D)};p.nA=vi;p.Xy=n("assistantAnswersFeedback");p.FB=n(2628);p.EB=n(2627);p.U5=n("Was this answer correct?");p.Jia=n("Correct");
p.Iia=n("Incorrect");p.VM=g("D");p.pA=function(a){DY.qa.pA.call(this,a);this.va&&(this.va.H=a);this.$&&pFc(this.$,a);XIc(this);UIc(this);VIc(this)};p.$0=function(){DY.qa.$0.call(this);if(!this.xd){var a=this.jd,b=this.Kh;CW(a);for(var c=0;c<b.length;c++)Vxc(a,b[c]);this.xd=!0}};p.wT=function(){DY.qa.wT.call(this);CW(this.jd);this.xd=!1};p.zDb=function(){switch(rV(this.L)){case 0:aJc(this,!1);break;case 1:aJc(this,!1);VIc(this);break;case 2:aJc(this,!0);VIc(this);break;default:rV(this.L)}};
function aJc(a,b){Q(a.Za("waffle-assistant-answercard-chart-container"),b);a.$a?Q(a.Za("waffle-assistant-answercard-pivot-content"),!b):(Q(a.Za("waffle-assistant-answercard-answer"),!b),Q(a.Za("waffle-assistant-answercard-formula-holder"),!b));UIc(a);!a.Sb&&b&&ZIc(a,a.D.getChartType())}function XIc(a){var b=a.Fb("waffle-assistant-answercard-formula-help");b&&Q(b,!a.zd())}function UIc(a){var b=(a.Od||2==rV(a.L))&&!a.zd();a.Db.setVisible(b)}
function VIc(a){var b=a.$a&&!a.zd()&&(!a.jb||1==rV(a.L));a.wb.setVisible(b)}function WIc(a,b){a.O.setVisible(!b);a.cb.setVisible(b);Q(a.Za("waffle-assistant-answercard-formula"),b);b?a.Za("waffle-assistant-answercard-formula-text").focus():(a.O.Na.focus(),a.O.Fp(!0))}p.G0b=function(){QIc(this.Qg,!0);this.dispatchEvent(new I("rc"))};p.eBb=function(){WIc(this,!0)};p.Dsb=function(){WIc(this,!1)};p.iNa=function(){YIc(this,!0)};p.JIb=function(){YIc(this,!1)};
function YIc(a,b){var c=new SX;D(c,9,b);b=new BU;bd(b,4,c);c=new Qq;bd(c,46,b);c=Cr(Br(new Ar,10),c).build();a.R.Wb(2849,c)}p.GIb=function(a){var b=this.D.R,c=new gFc;bd(c,1,b);switch(a){case 0:D(c,2,2);break;case 1:D(c,2,3);break;case 2:D(c,2,1);break;default:D(c,2,0)}a=new SX;bd(a,10,c);c=new BU;bd(c,4,a);a=new Qq;bd(a,46,c);c=Cr(Br(new Ar,10),a).build();this.R.Wb(2850,c)};p.IIb=function(){this.R.Wb(2709,this.gb)};
p.Jrb=function(){var a=this.Aa().Ob(),b=a.createElement("textarea");b.textContent=this.D.Rm;b.style.position="fixed";a.body.appendChild(b);b.select();var c=!1;try{c=a.execCommand("copy")}catch(d){}finally{a.body.removeChild(b)}c&&(bJc(this.ji,"Formula copied to clipboard",this.Aa()),this.R.C(35534,this.gb))};function cJc(a){return V('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+T(NIc({yL:a.LDa.yL}))+T(LIc({error:a.LDa.error,showHelp:a.showHelp}))+"</div></div>")}function dJc(){return V('<div class="waffle-assistant-answercard-feedback-container"><div class="waffle-assistant-answercard-feedback-link">Send feedback</div></div>')};function EY(a,b,c,d,e){lY.call(this,new nH,e);this.H=a;this.O=b;this.L=d;this.R=c;this.J=new Dv("",new fY,this.Aa());this.Qa(this.J);this.C=new Dv("",new tW,this.Aa());this.Qa(this.C);this.D=new Dv("",new tW,this.Aa());this.Qa(this.D)}y(EY,lY);p=EY.prototype;p.hA=function(){Rs(this.Na,"Error Card for question: "+this.H.D)};p.Xy=n("assistantAnswersFeedback");p.nA=vi;p.N7=ui;p.Ha=function(){EY.qa.Ha.call(this);AGc(this).appendChild(S(KIc))};
p.Ra=function(){EY.qa.Ra.call(this);var a=this.Za("waffle-assistant-answers-card-remove");this.J.kb(a);this.D.setVisible(this.L);hY(a,"Remove card",0);this.getHandler().Oc(this.J,"action",this.M0b).Oc(this.C,"action",this.qBb).V(this.D,"action",this.L0b)};
p.oA=function(a){mY(this).appendChild(S(cJc,{LDa:yIc(this.H),showHelp:this.L}));if(wp){var b=S(dJc);this.Aa().appendChild(this.Na,b);this.C.kb(this.Za("waffle-assistant-answercard-feedback-link"))}this.L&&this.D.kb(this.Za("waffle-assistant-answers-helpcenter-link"));a()};p.Rha=g("O");p.VM=g("H");p.qBb=function(){this.C.setVisible(!1);Q(this.Za("waffle-assistant-answercard-feedback-container"),!1);this.dispatchEvent(new I("trigger_feedback"))};p.M0b=function(){QIc(this.R,!1);this.dispatchEvent(new I("rc"))};
p.L0b=function(){P.Xn.mc()};function eJc(a){lY.call(this,new nH,a);this.C=this.Aa().createElement("div");cp(this.C,"Previous")}y(eJc,lY);p=eJc.prototype;p.hA=function(){Rs(this.Na,"Previous questions below")};p.Ha=function(){eJc.qa.Ha.call(this);Ws(this.Na,"waffle-assistant-card");Us(this.Na,"waffle-assistant-answers-previousheadercard")};p.oA=function(a){0<this.Aa().Ih(mY(this)).length||mY(this).appendChild(this.C);a()};p.N7=ui;p.Xy=n("assistantAnswersFeedback");function fJc(a){var b=""+(""+(a.O4?T(LIc({error:a.O4,showHelp:a.showHelp})):"")+(a.title?'<div class="waffle-assistant-suggestionscard-header">'+T(a.title)+"</div>":""));var c=Au("Suggested question");b+='<div class="waffle-assistant-suggested-questions">';a=a.$v;for(var d=a.length,e=0;e<d;e++){var f=a[e];b+='<div class="waffle-assistant-answercard-question-container" tabindex="0"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+W(c)+'">'+T(Zw({icon:"docs-icon-img docs-icon-help"}))+
'</div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">'+T(f)+"</div></div></div>"}return V(b+"</div>")};function FY(a,b,c,d,e,f){lY.call(this,a,f);this.C=e||null;this.O=b;this.D=d;this.R=c;this.L=this.C?5==this.C.error:!1;this.H=new Dv("",new tW,this.Aa());this.Qa(this.H);this.J=new Dv("",new fY,this.Aa());this.Qa(this.J)}y(FY,lY);p=FY.prototype;p.Ha=function(){FY.qa.Ha.call(this);this.nA()&&AGc(this).appendChild(S(KIc))};
p.Ra=function(){FY.qa.Ra.call(this);Us(this.Na,"waffle-assistant-answers-suggestioncard");this.H.setVisible(this.L);this.getHandler().V(this.H,"action",this.N0b);if(this.nA()){var a=this.Za("waffle-assistant-answers-card-remove");this.J.kb(a);hY(a,"Remove card",0);this.getHandler().Oc(this.J,"action",this.O0b)}};p.FB=function(){return zb([gJc,hJc],this.D)?2799:zb([iJc,jJc],this.D)?2801:null};p.EB=function(){return zb([gJc,hJc],this.D)?2798:zb([iJc,jJc],this.D)?2800:null};p.U5=n("Were these interesting?");
p.Jia=n("Interesting");p.Iia=n("Not interesting");p.Xy=n("assistantAnswersFeedback");p.nA=function(){return this.C?!tIc(this.C):!1};p.hA=function(){var a=this.D.title;a&&this.C?Rs(this.Na,a+(" for question : "+this.C.D)):Rs(this.Na,"Suggested questions")};
p.oA=function(a){var b=this;this.R.then(function(c){if(b.Xb()){if(0==c.length)Q(b.Na,!1);else{var d=b.Aa(),e=mY(b);if(0==d.Ih(e).length){var f=S(fJc,{title:b.D.title,$v:sb(c,function(a){return a.query}),O4:b.C?zIc(b.C):"",showHelp:b.L});e.appendChild(f);var h=sb(c,function(a){return a.type});e=b.Di("waffle-assistant-answercard-question-container");A(e,function(a,e){var f=new Dv("",new fY,d);b.Qa(f);f.kb(a);b.getHandler().V(f,"action",v(b.jDb,b,c[e],h,e))});b.L&&b.H.kb(b.Za("waffle-assistant-answers-helpcenter-link"))}}a()}})};
p.O0b=function(){QIc(this.O,!1);this.dispatchEvent(new I("rc"))};p.jDb=function(a,b,c){this.dispatchEvent(new $Fc(this.D.t0,a.Rm||null,b,c,this.D.xV,a.query))};p.N0b=function(){P.Xn.mc()};var kJc={title:"",xV:0,t0:null},gJc={title:"",xV:5,t0:1},hJc={title:"Suggested questions",xV:5,t0:1},jJc={title:"Did you mean?",xV:2,t0:4},iJc={title:"Related questions",xV:4,t0:4};function GY(a,b,c,d,e,f,h,k,l,m,q,t,w,x){nY.call(this,x);this.Be=c;this.Od=d;this.Ze=e;this.Gc=a;this.jb=new eIc(this.Od);this.gb=h;this.Ba=m;this.ef=q;this.He=t;this.J=this.O=this.R=this.Kb=this.D=null;this.Nb="";this.Pa=new bGc;this.L=f;this.Wa=this.Sb=this.cb=this.F=null;this.$a=k;this.Hd=!1;this.Db=Br(new Ar,10).build();this.Mc=new Tl;this.Ab=l;this.va={};this.xd=Zd();this.wb="";this.Ia=null;this.Cf=w}y(GY,nY);p=GY.prototype;p.Ra=function(){GY.qa.Ra.call(this);this.lH(!this.F)};
p.Koa=function(a,b){GY.qa.Koa.call(this,a,b);b=this.Aa();var c=this.$;this.R=new gY(b);c.Qa(this.R,!0);b.appendChild(a,this.R.Na);this.R.Ra();this.O=new jGc(this.R,this.L,this.Pa,10);c.Fa(this.O);c.getHandler().V(this.R,"answers-submit-query",v(this.I0b,this))};p.L3=function(){GY.qa.L3.call(this);this.O=this.R=null};
p.lH=function(a){var b=this;this.R&&this.R.setVisible(!a);a?(this.Ia&&this.Ia.dispose(),this.Ia=new no(function(){GY.qa.lH.call(b,a)},300,this),this.Fa(this.Ia),this.Ia.start()):(this.Ia&&this.Ia.stop(),GY.qa.lH.call(this,a))};p.Df=da("Kb");
function lJc(a,b,c,d,e,f,h){h=h?h:[];var k=k?k:[];a.jb.Ce(c,b,d,e,h,k);h=sb(Se(c,1),function(a){return a.getName()});var l=[],m=[];A(Se(c,2),function(a){l.push(a.getName());m=m.concat(Se(a,2))});cGc(a.Pa,h,l,m);a.Gc.o9().then(function(a){this.Pa.F=a;this.O&&(a=this.O,rp(a.O.Aa())==a.D&&a.jRa())},null,a);a.F=b;a.cb=d;a.Sb=e;a.Wa=c;a.Db=Cr(Br(new Ar,10),mJc(a)).build();if(f&&Gp)for(c=sb(a.C,function(a){if(a instanceof DY||a instanceof EY)return a.VM().D}),a.EV(),d=0;d<c.length;d++)if(e=c[d])f=new TX,
D(f,1,5),nJc(a,e,f);a.lH(!b)}p.reset=function(){QU(this.va);QU(this.Pa.D);var a=this.Pa;a.F=[];a.C.clear();this.J=null;this.cBa()};
function nJc(a,b,c,d,e){d=void 0===d?null:d;e=void 0===e?!1:e;var f=a.Ba.L.uv();D(c,13,f);f=new SX;bd(f,5,c);pGc(a.O);if(!a.Kb||a.Kb.getStatus().getState().wh())if(a.va[b])oJc(a,b,!1);else{d=new CY(b,null,null,null,2,a.Ba);pJc(a,d,!0,f);return}else{var h=a.va[b];h&&h instanceof EY&&2==h.VM().error&&delete a.va[b]}if(b&&a.F)if(a.va[b])a.L.Wb(2681,a.Db),oJc(a,b,!0);else{h=mJc(a);var k=$c($c(h,BU,46),SX,4);D(k,2,e);e=Cr(Br(new Ar,10),h).build();a.L.Wb(2635,e);e=wF(a.F.rect);b=co(hn(eo(kn(ln(a.Kb.ze("/answers/parse").uf("q",
b,"qt",B(c,1),"gid",a.F.fd,"range",e,"context",a.Nb),v(a.Bk,a,b,f)),v(a.H0b,a,b,f)),"POST"),2));Gp&&a.cb&&null!=a.Sb&&(c=0==a.cb.rect.width||0==a.cb.rect.height?"":wF(a.cb.rect),b.uf("headerRange",c,"tableRecordDimension",""+a.Sb));d&&b.uf("sgfml",d);b.$d();a.wb=$d(a.xd,Ym.Dsa);qJc(a,!0)}else nGc(a.O,"")}function oJc(a,b,c){var d=a.va[b];d!=nb(a.C)&&(1<a.C.length&&rJc(a),c&&sJc(a,d.VM()).then(function(a){tJc(this,d,a)},null,a),KGc(a,d))}
p.I0b=function(a){var b=a.C;var c=a.Pa;var d=a.J,e=a.Ia;c?c=nIc(b,d,e,c):(c=new TX,D(c,1,b));nJc(this,a.R,c,a.F,a.O)};p.H0b=function(a,b){if(this.F){var c=B($c(b,TX,5),1);c=1==c||4==c?rFc.txa:rFc.Vxa;var d=mJc(this),e=$c($c(d,BU,46),SX,4);D(e,1,c);D(b,1,c);c=Cr(Br(new Ar,10),d).build();this.L.Wb(2640,c);uJc(this,a,b)}};function uJc(a,b,c){qJc(a,!1);b=new CY(b,null,null,null,3,a.Ba);pJc(a,b,!1,c);vJc(a)}
p.Bk=function(a,b,c){this.F&&this.$a.C.D.C.then(function(){var d=null,e=null,f=!1,h=$c(b,TX,5),k=B(h,1),l=mJc(this);k=1==k||4==k?rFc.txa:rFc.Vxa;var m=$c($c(l,BU,46),SX,4);D(m,1,k);D(b,1,k);k=Cr(Br(new Ar,10),l).build();if(c.Ck()){e=this.Mc.kd(cY.Ka(),c.Qe());if(f=e.getStatus()){switch(f){case 1:var q=2639;break;case 2:q=2643;break;case 3:q=2644;break;case 4:q=2638;break;case 5:q=2707;break;case 6:q=2706}q&&this.L.Wb(q,k)}q=L(e,10);D(h,4,q);q=L(e,11);D(h,5,q);Ne(e,16)&&(q=L(e,16),D(h,16,q));if(1==
f){uJc(this,a,b);return}if(2==f){e=-1!=wJc(a);h=-1!=mIc(a);f=4;d=$c(b,TX,5);e?(f=5,D(d,8,2)):h&&(f=7,D(d,8,1));h=new CY(a,null,null,null,f,this.Ba);e?(e=new EY(h,!0,this.Ab,!0,this.Aa()),xJc(this,h,e,b)):pJc(this,h,!0,b);qJc(this,!1);vJc(this);return}l=Ne(e,2)?L(e,2):null;f=!0;if(l){q="";d=nFc(this.$a,l,this.F,!!this.Wa&&!!L(this.Wa,4));D(h,14,!!d);if(!d){if(m=l.match(/([A-Z]*)\(/)){var t=$c($c(mCa(k),BU,46),SX,4);D(t,7,m[1]);D(b,7,m[1])}this.L.Wb(2645,k)}d&&oFc(d)||(q=this.$a,t=this.F,k="="!=l[0]?
"="+l:l,m=lFc(q),t=mFc(m,t),q=qOb(q.C,k,m,t.row,t.nj));k=Ne(e,19)?nFc(this.$a,L(e,19)||"",this.F,!!this.Wa&&!!L(this.Wa,4)):d;d=new CY(a,d,"="!=l[0]?"="+l:l,e,null,this.Ba,k);if(Ne(e,23)&&d.Nj()){if(Ne(e,17)&&Ne(L(e,17),5)){k=L(L(e,17),5);l=d.va;if(Ne(k,5))switch(L(k,5).getPosition()){case 1:l.C="right";break;case 2:l.C="left";break;case 3:l.C="top";break;case 4:l.C="bottom"}Ne(k,1)&&Ne(L(k,1),1)&&Ne(L(L(k,1),1),1)&&1==L(L(L(k,1),1),1)&&(l.L=!0);Ne(k,2)&&Ne(L(k,2),1)&&Ne(L(L(k,2),1),1)&&1==L(L(L(k,
2),1),1)&&(l.O=!0);Ne(k,1)&&Ne(L(k,1),1)&&Ne(L(L(k,1),1),2)&&(m=L(L(L(k,1),1),2),l.F=m);Ne(k,2)&&Ne(L(k,2),1)&&Ne(L(L(k,2),1),2)&&(m=L(L(L(k,2),1),2),l.H=m);Ne(k,3)&&(m=k.getTitle().getTitle(),l.J=m);Ne(k,4)&&(k=L(k,4).getTitle(),l.D=k)}this.Nb=Te(e,23)}else this.Nb="";q&&d.L.push(q);d.Nj()&&bd(h,15,d.R)}else Ne(e,9)&&(q=e.getError(),d=new CY(a,null,null,e||null,6,this.Ba),l=L(q,2),D(h,6,l),Ne(q,3)&&(q=L(q,3),D(h,12,q)))}else this.L.Wb(2640,k);d||(d=new CY(a,null,null,e||null,4,this.Ba));qJc(this,
!1);tIc(d)?yJc(this,d,f,b):pJc(this,d,f,b);vJc(this)},function(){uJc(this,a,b)},this)};function vJc(a){""!=a.wb&&(ae(a.xd,a.wb),a.wb="")}function zJc(a){if(null!=a.Rm)return iJc;switch(a.error){case 4:case 6:return 0<a.O.length?jJc:hJc;case 5:return hJc}return kJc}function mJc(a){var b=new SX;D(b,8,zxa);var c=new BU;bd(c,4,b);a=VGc(a.F);bd(a,46,c);return a}function wJc(a){return yb(kIc,function(b){return Ma(a,b)})}
function AJc(a,b){var c=[];b=b.O;for(var d=0;d<b.length&&3>c.length;++d){var e=L(b[d],2),f=!!a.Wa&&!!L(a.Wa,4);e=nFc(a.$a,e,a.F,f);oFc(e)&&(e={query:L(b[d],1),Rm:L(b[d],2),type:b[d].getType()},Ne(b[d],5)&&(e.CEa=L(b[d],5)),c.push(e))}return Ei(c)}function yJc(a,b,c,d){c=new DY(b,a.Be,a.Od,a.Ze,a.L,a.Ab,a.gb,c,a.Ba,a.Hd,a.Cf,a.$a,a.Aa());xJc(a,b,c,d)}
function BJc(a,b,c){if(a.D&&a.D.isVisible())IN(a.D);else{var d=a.ef.D.C["ritz-ap"]||null;c.jM()&&(a.D=ayb(a.He,a.Aa(),d,void 0,"answersChartsPromo"),a.D&&(a.D.show(),a.Fa(a.D),a.getHandler().Oc(a,"Nd",a.cBa)));b.Nj()&&H9a(d,"answersChartsPromo")}}p.jba=function(){GY.qa.jba.call(this);this.D&&this.D.isVisible()&&this.D.C.ld()};p.cBa=function(){this.D&&this.D.isVisible()&&IN(this.D)};function pJc(a,b,c,d){c=new EY(b,c,a.Ab,!1,a.Aa());xJc(a,b,c,d)}
function xJc(a,b,c,d){rJc(a);var e=sJc(a,b,d);CJc(a,c);c instanceof DY&&BJc(a,b,c);DJc(a);tIc(b)&&dGc(a.Pa,b.D);e.then(function(a){if(d){var b=mJc(this),e=$c(b,BU,46);bd(e,4,d);b=Cr(Br(new Ar,10),b).build();this.L.Wb(2781,b)}tJc(this,c,a)},null,a);c.Rha()&&(a.va[b.D]=c);a.getHandler().V(c,"rc",a.mKa)}function tJc(a,b,c){b instanceof EY&&c&&qs(c.getElement())&&(b=b.getElement(),Q(b,!1),a.getHandler().V(c,"rc",a.mKa))}
function rJc(a){EJc(a);A(a.C,function(a){a instanceof EY&&(a=a.getElement(),Q(a,!0))});FJc(a)}function FJc(a){0!=a.C.length&&(a.J?KGc(a,a.J):(a.J=new eJc(a.Aa()),CJc(a,a.J)))}function EJc(a){A(a.C,function(b){b instanceof DY||b instanceof EY||b==a.J||a.XG(b)})}function GJc(a,b){var c=Ei([]);b=b.Ia;0<b.length&&(c=hIc(a.jb,b));return c=c.then(function(b){var c=3-b.length;return 0<c?THc(a.Gc,c).then(function(a){return Ib(b,a)}):Ei(b)})}
function sJc(a,b,c){var d=zJc(b),e=null;d==iJc||d==jJc?0<b.O.length&&(e=AJc(a,b)):d==hJc&&(e=GJc(a,b));var f=null;return e?(f=new FY(new nH,a.Ab,e,d,b,a.Aa()),CJc(a,f),a.L.Wb(2769,a.Db),a.getHandler().V(f,"sqc",v(a.iDb,a)),e.then(function(a){if(c){var b=$c(c,TX,5);zb([iJc,jJc],f.D)?(a=pIc(a),bd(b,7,a)):zb([gJc,hJc],f.D)&&(a=qIc(a),bd(b,9,a))}return f},null,a)):Ei(f)}p.iDb=function(a){nGc(this.O,a.F,!0);var b=a.R;b=1==b?nIc(b,a.C,a.J,3):oIc(b,a.C,a.J,a.Ia);nJc(this,a.F,b,a.O);this.L.Wb(2762,this.Db)};
function qJc(a,b){a=a.R;Q(a.H,b);Q(a.Aa().Za("waffle-assistant-answers-button-container",a.C),!b);vW(a.F,b)}function CJc(a,b){b.pA(a.zd());a.C.push(b);if(a.Zb){JGc(a,!1);var c=a.H.Wc();b.Ba=c;a.H.gh(b,0,!0);b.TI()}CGc(b,!0)}function DJc(a){for(var b=a.C;5<b.length;)a.XG(b[0])}p.EV=function(){GY.qa.EV.call(this);this.reset()};
p.mKa=function(a){var b=this,c=this.Aa();a=a.target;if(a instanceof DY)this.XG(a),bJc(this.gb,"Answer removed",c,v(this.$zb,this,a));else if(a instanceof EY)this.XG(a),bJc(this.gb,"Card removed",c);else if(a instanceof FY&&a.C&&!tIc(a.C)){var d=a.C.D;A(this.C,function(a){a instanceof EY&&a.VM().D==d&&(b.XG(a),bJc(b.gb,"Card removed",c))})}a=this.C;!this.J||a[0]!=this.J&&a[a.length-1]!=this.J||(this.XG(this.J),this.J=null)};
p.$zb=function(a){yJc(this,a.VM(),a.Rha());bJc(this.gb,"Remove answer undone",this.Aa())};p.XG=function(a){if(a.Xb()){if(a instanceof DY||a instanceof EY)delete this.va[a.VM().D],a==nb(this.C)&&EJc(this);GY.qa.XG.call(this,a)}H(a)};function HJc(){var a=""+(""+V('<div class="waffle-assistant-answers-logging-message-container"><div class="waffle-assistant-answers-logging-message"><span class="waffle-assistant-answers-logging-text">We\'re logging your queries and data to improve the feature.</span><div class="waffle-assistant-answers-learn-more">Learn More</div><div class="waffle-assistant-answers-logging-opt-out">Opt-out for this file</div></div></div>')+'<div class="waffle-assistant-answers-input waffle-assistant-answers-input-with-icon"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container"><div class="waffle-assistant-answers-search-icon">'+
T(Zw({icon:"docs-icon-img docs-icon-search-this-document"}))+'</div><input class="waffle-assistant-answers-input-box" placeholder="'+Eu("Ask a question about your data")+'"/></div></form></div>');return V(a)};function HY(a,b,c,d,e,f,h,k,l,m,q){oY.call(this,1,f,e,q);this.Ab=c;this.Pa=null;this.Ba=new Dv("",new tW,this.Aa());this.Qa(this.Ba);this.Wa=new Dv("",new tW,this.Aa());this.Qa(this.Wa);a=new oOb(a,!0,!0);a=new mBc(a,c);this.jb=new PIc(e);this.O=new ZHc(this.Ab,a,e);this.L=new GY(this.O,0,b,c,d,e,this.ib,a,this.jb,h,k,l,m,q);c=IJc;this.D=new AW(b,c.cca,c.dca);this.Fa(this.D);this.F=this.H=null;this.wb=Br(new Ar,10).build();this.Ia=!1}y(HY,oY);
var IJc={cca:"waffle-assistant-answers-styled-border",dca:"waffle-assistant-answers-styled-rect",yZa:"waffle-assistant-answers-input-box",n0a:"waffle-assistant-answers-query-box",cvc:"waffle-assistant-answers-query-box-focused",OZa:"waffle-assistant-answers-learn-more",upc:"waffle-assistant-answers-logging-message-container",J_a:"waffle-assistant-answers-logging-opt-out"};p=HY.prototype;p.Ha=function(){HY.qa.Ha.call(this);var a=S(HJc);this.Aa().appendChild(MGc(this),a)};
p.Ra=function(){HY.qa.Ra.call(this);var a=IJc,b=this.Za(a.n0a),c=this.Za(a.yZa);this.Wa.kb(this.Za(a.J_a));this.Ba.kb(this.Za(a.OZa));this.getHandler().V(b,"focus",this.pzb,!0).V(b,"blur",this.nzb,!0).V(b,"mouseover",this.rzb).V(b,"mouseout",this.qzb).V(b,"click",this.ozb).V(c,"input",this.J0b).V(this.Wa,"action",this.Axb).V(this.Ba,"action",this.gub).V(TD(this.Ab),"Ca",ksc(this.K0b,25,this));this.setVisible(!!this.H);JJc(this,hxa&&kxa&&Hp("showAnswersLoggingOptOut"))};p.Qpa=ui;p.dLa=vi;p.Mpa=ui;
p.getTitle=n("Answers");p.a1=n(1);p.sV=function(a){return 3==a||0==a||1==a};p.WM=function(a,b){Pb(a,function(a,b){return L(b,2)-L(a,2)});for(var c=[],d=[],e=null,f=0;f<a.length;f++){var h=Te(a[f],1);3==h?e=a[f]:0==h?c.push(L(a[f],8)):1==h&&d.push(a[f])}if(e&&L(e,2)){f=b||null;h=Ne(e,11)?L(e,11):null;var k=null==h?null:zU(L(e,10));0<Oe(e,4)?KJc(this,zU(EU(e)),L(e,9),k,h,c,d):KJc(this,f,L(e,9),k,h,c,d);this.F||(HY.qa.WM.call(this,a,b),this.getHandler().V(this.F,"sqc",this.gDb))}else this.xT(!0)};
p.tO=function(a){if(!this.F){var b=THc(this.O,3);this.F=new FY(a,this.jb,b,gJc,void 0,this.Aa())}return this.F};p.AAa=g("L");p.cla=function(){return this.isVisible()};
p.xT=function(a,b,c){this.O.reset();(a||b)&&this.F&&(HY.qa.xT.call(this,a,b,c),this.F.dispose(),this.F=null);if(a||u(b)&&!b)this.F&&(HY.qa.xT.call(this,a,b,c),this.F.dispose(),this.F=null),this.Xb()&&(this.O.reset(),this.H=null,a=this.L,a.Xb()&&(b=a.Pa,b.F=[],b.C.clear(),a.O&&(b=a.O,b.O.Xb()&&(ZFc(b.D),b.F.isDisposed()||b.F.setVisible(!1),b.J=!1)),a.EV(),a.jb.reset(),a.F=null,a.lH(!0)),this.setVisible(!1),this.Vb()&&CW(this.D));c&&this.L.reset()};p.Df=function(a){this.Pa=a;this.L.Df(a);this.O.Df(a)};
p.b1=function(a){HY.qa.b1.call(this,a);a?BW(this.D,this.H):CW(this.D)};function LJc(a,b){a.Vb()&&(b?CW(a.D):BW(a.D,a.H))}function JJc(a,b){Q(a.Za("waffle-assistant-answers-logging-message-container"),b)}function MJc(a,b){a=a.Za("waffle-assistant-answers-query-box");Ys(a,"waffle-assistant-answers-query-box-focused",b)}p.K0b=function(){this.Vb()&&BW(this.D,this.H)};p.pzb=function(){MJc(this,!0);BW(this.D,this.H)};p.nzb=function(){MJc(this,!1);this.Vb()||CW(this.D)};p.rzb=function(){BW(this.D,this.H)};
p.qzb=function(){this.Vb()||CW(this.D)};p.ozb=function(){NJc(this,"")};p.J0b=function(){var a=this.Za("waffle-assistant-answers-input-box");NJc(this,a.value);a.value=""};p.gDb=function(a){var b=this,c=a.F;NJc(this,c);var d=nIc(1,a.C,a.J,1),e=new no(function(){nJc(b.L,c,d,a.O)},300);this.Fa(e);e.start();this.R.Wb(2652,this.wb)};function NJc(a,b,c){a.b1(!0);a.dispatchEvent("Sd");OJc(a,b,c)}
function OJc(a,b,c){c=void 0===c?!1:c;var d=new no(function(){nGc(a.L.O,b,!0);var d=a.L,f=c||!1;d.Hd=f;d.Gc.$=f;d.jb.$=f},300);a.Fa(d);d.start()}function KJc(a,b,c,d,e,f,h){c=c||new hH;a.H=b;a.O.Ce(c,b,d,e,f,h);a.O.n9();a.setVisible(!!b);lJc(a.L,b,c,d,e,a.Ia,f);a.Ia=!1;a.Vb()&&BW(a.D,a.H)}p.Axb=function(a){a.stopPropagation();a.preventDefault();this.Pa&&(eo(kn(ln(this.Pa.ze("/answers/logoptout"),v(this.Qub,this)),v(this.Pub,this)),"POST").$d(),this.R.Wb(2663,this.wb))};
p.gub=function(a){a.stopPropagation();a.preventDefault();Ds("https://docs.google.com/document/d/1VxpmAx5RTnwmeXyj3IuPPYIXg9DYzTS8nz8pi1E_ZJk/preview",{target:"_blank"})};p.Qub=function(a){a.Ck()&&JJc(this,!1)};p.Pub=ba();function IY(a,b,c,d){dx.call(this,a,b,c,d,void 0,void 0,!0)}y(IY,dx);IY.prototype.Ha=function(){IY.qa.Ha.call(this);Us(this.Na,"waffle-assistant-toast");Us(this.Za("docs-ui-toast-content"),"waffle-assistant-toast-content")};IY.prototype.KA=function(a,b,c){c=c?c:"waffle-assistant-toast-action";b=zs(this,b);IY.qa.KA.call(this,a,b,c)};IY.prototype.Rg=function(a,b,c,d){this.KA(a,b,d);a=Bs(this,b);this.getHandler().Ng(a,Ie,v(function(){this.setVisible(!1);c()},this))};function PJc(){this.C=null}y(PJc,G);PJc.prototype.clear=function(){this.C&&(this.C.setVisible(!1),this.C.dispose(),this.C=null)};function bJc(a,b,c,d){a.clear();a.C=new IY(b,c,!1,5E3);a.C.render();d&&a.C.Rg("Undo","w-a-u-tm-u",d,void 0);a.C.setVisible(!0);a.C.getElement().focus()}PJc.prototype.Oa=function(){PJc.qa.Oa.call(this);this.clear()};function QJc(){var a=V;var b=""+T(Kv({vd:"waffle-assistant-datavalidation-apply-button",content:Au("Apply"),style:4}));b=V(b);return a('<div class="waffle-assistant-datavalidation-rule-group"><div class="waffle-assistant-datavalidation-details"></div><div class="waffle-assistant-datavalidation-description"></div>'+b+"</div>")}function RJc(a){return V('<div class="waffle-assistant-datavalidation-detail-chip">'+T(a.z6a)+"</div>")};function SJc(a,b,c,d){lY.call(this,a,d);this.D=new AW(b,"waffle-assistant-highlight-styled-border","waffle-assistant-highlight-styled-rect");this.Fa(this.D);this.C=new Lv("",this.Aa());this.Qa(this.C);this.H=EU(a);this.J=c}r(SJc,lY);p=SJc.prototype;p.Ha=function(){lY.prototype.Ha.call(this);mY(this).appendChild(S(QJc))};
p.Ra=function(){lY.prototype.Ra.call(this);var a=this.Za("waffle-assistant-datavalidation-apply-button");this.C.kb(a);hY(a,"Apply data validation");this.getHandler().V(this.C,"action",this.Fkb).V(this.Na,"mouseenter",this.EJb).V(this.Na,"mouseleave",this.FJb);a=new Sq;urc(a,Wxc(mg(L(L(this.F,13),3))));var b=new Qq;bd(b,58,a);a=Cr(Br(new Ar,10),b).build();this.J.C(35577,a)};
p.oA=function(a){var b=wF($l(this.H)),c=L(L(this.F,13),3);switch(mg(c)){case 14:var d="Email validation";c=["Is valid email"];break;case 15:d="URL validation";c=["Is valid URL"];break;case 30:d="Date validation";c=["Is valid date"];break;case 24:d="List of items";c=Se(c,2).map(function(a){return L(L(a,5).bb(),2)});break;case 1:d="Numeric validation";c=["Greater than "+L(L(Se(c,2)[0],5).bb(),3)];break;case 7:d="Numeric validation";c=Se(c,2);c=["Between "+(L(L(c[0],5).bb(),3)+(" and "+L(L(c[1],5).bb(),
3)))];break;default:d="unrecognized",c=[]}var e=new cy,f=e.text(d)+(" for "+(e.Zd("SPAN".toString(),{lE:"waffle-assistant-datavalidation-range"})+e.text(b)+e.ge("SPAN".toString())));sj(this.Za("waffle-assistant-datavalidation-description"),e.format(f));var h=this.Za("waffle-assistant-datavalidation-details");A(c,function(a){a=S(RJc,{z6a:a});h.appendChild(a)});b="Suggested data validation: "+(d+(" "+(c.join()+(" for "+b))));Rs(this.Na,b);a()};p.hA=ba();p.Xy=n("assistantDataValidationFeedback");
p.FB=n(35551);p.EB=n(35550);p.Fkb=function(){this.dispatchEvent(new jY("Md",this,35549))};p.EJb=function(){BW(this.D,zU(this.H))};p.FJb=function(){CW(this.D)};function TJc(a,b,c,d){oY.call(this,3,b,a,d);this.D=c}r(TJc,oY);p=TJc.prototype;p.getTitle=n("Data Validation");p.sV=function(a){return 6==a};p.tO=function(a){var b=L(a,1);switch(b){case 6:return new SJc(a,this.D,this.R,this.Aa());default:throw Error("Unsupported recommendation type: "+b);}};p.XM=function(a){oY.prototype.XM.call(this,a);this.setVisible(!a)};p.YM=function(a){return this.zd()?(this.setVisible(!1),a):oY.prototype.YM.call(this,a)};p.a1=n(4);p.Qpa=n(!1);function UJc(){var a=""+('<div class="waffle-assistant-banding-recommendation"><div class="waffle-assistant-banding-color-picker-container"></div><div class="waffle-assistant-banding-range-wrapper">Alternating colors for <span class="waffle-assistant-banding-range"></span></div>'+VJc()+"</div>");return V(a)}
function WJc(){return V('<div class="waffle-assistant-conditionalformat-rule-group"><div class="waffle-assistant-conditionalformat-rule-holder" tabindex="0"></div><div class="waffle-assistant-conditionalformat-description"></div>'+VJc()+"</div>")}function VJc(){var a=""+T(Kv({vd:"waffle-assistant-formatting-edit-button",content:Au("Edit"),style:4}));return V(a)};function XJc(a,b,c){lY.call(this,a,c);a=sb(Se(this.F,7),Rtc);this.C=new Wtc(!1,a,7);this.Qa(this.C);this.J=new Lv("",this.Aa());this.Qa(this.J);this.L=b;this.H=!1;this.D=-1}y(XJc,lY);var YJc={aXa:"waffle-assistant-banding-color-picker-container",Uba:"waffle-assistant-formatting-edit-button",cI:"waffle-assistant-banding-range"};p=XJc.prototype;p.Ha=function(){XJc.qa.Ha.call(this);mY(this).appendChild(S(UJc))};
p.Ra=function(){XJc.qa.Ra.call(this);this.getHandler().V(this.J,"action",this.cqb).V(this.C,"kd",this.klb);this.L.C(2768)};p.oA=function(a){var b=this.Za(YJc.aXa);this.C.render(b);Xtc(this.C);b=this.Za(YJc.cI);var c=EU(this.F),d=$l(c);cp(b,wF(d));ZJc(this,c);b=this.Za(YJc.Uba);this.J.kb(b);a()};p.hA=function(){Rs(this.Na,"Suggested alternating background colors");Rt(this.C,"Choose a color scheme")};p.Xy=n("assistantBandingFeedback");p.FB=n(2672);p.EB=n(2671);
p.cqb=function(a){BB.dispatchEvent({type:"show-banding-pane-recommendation",PQa:this.F,f6a:Ztc(this.C)});a.stopPropagation()};p.klb=function(a){if(!this.H&&Ytc(this.C)){var b=this.D;this.D=this.C.Vg();this.D==b?this.dispatchEvent(new jY("Rd",this,2797)):this.dispatchEvent(new jY("Kd",this,2673));a.stopPropagation()}};
function ZJc(a,b){a.H=!0;var c=b.Jb();b=$l(b);c=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(c,b.kc(),b.gc(),b.Nc(),b.Pc(),7,!1);c.length?(c=ritz_api.RitzModelApi.getBandedRangeByWorkbookRangeId(c[0]),c=(new Tl).kd(Nf.Ka(),c),c=Rtc(c)):c=null;c?(c=$tc(a.C,c),UN(a.C,c?c.getElement():null)):UN(a.C,null);a.D=a.C.Vg();a.H=!1};function $Jc(a,b){lY.call(this,a,b);this.C=new Lv("",this.Aa());this.Qa(this.C);this.wc=Se(a,6)}y($Jc,lY);var JY={Uba:"waffle-assistant-formatting-edit-button",WYa:"waffle-assistant-conditionalformat-format-preview",L0a:"waffle-assistant-conditionalformat-rule-holder",jN:"waffle-assistant-conditionalformat-description",G_a:"one-rule",f2a:"two-rules",T1a:"three-rules",j0a:"waffle-assistant-conditionalformat-format-preview-label"};p=$Jc.prototype;p.Ha=function(){$Jc.qa.Ha.call(this);mY(this).appendChild(S(WJc))};
p.Ra=function(){$Jc.qa.Ra.call(this);var a=this.Za(JY.Uba);this.C.kb(a);hY(a,"Apply and edit conditional format rules");this.getHandler().V(this.C,"action",this.Dkb)};p.oA=function(a){cp(this.Za(JY.jN),Te(this.F,3));var b=this.Za(JY.L0a),c=new aKc(this,this.Aa());this.Qa(c);c.kb(b);hY(b,"Apply conditional format rules");a()};p.hA=ta;p.Xy=n("assistantConditionalFormatFeedback");p.FB=n(2630);p.EB=n(2629);
p.Dkb=function(){this.dispatchEvent(new jY("Ld",this,2563));this.dispatchEvent(new jY("Od",this,2670,void 0,void 0,$l(L(this.wc[0],1,0))));LRa()};function aKc(a,b){Pt.call(this,void 0,void 0,b);this.C=a}y(aKc,Pt);
aKc.prototype.hd=function(a){aKc.qa.hd.call(this,a);var b=this.C.wc;switch(b.length){case 0:break;case 1:var c=JY.G_a;break;case 2:case 4:c=JY.f2a;break;default:c=JY.T1a}for(var d=0;d<b.length;d++){var e=b[d],f=Ko("DIV");Vs(f,[JY.WYa,c]);var h=Ko("DIV");Us(h,JY.j0a);f.appendChild(h);cp(h,"123");if(Ne(e,2)){var k=L(L(e,2),1);switch(mg(L(k,1))){case 9:case 13:k=Se(L(k,1),2)[0];var l=Se(e,1)[0];cp(h,YE(k,Te(l,1),Te(l,2),Te(l,4)))}}gtc(e,f);a.appendChild(f)}};
aKc.prototype.yh=function(){var a=this.C;a.dispatchEvent(new jY("Ld",a,2563));return!0};function bKc(a,b,c){oY.call(this,2,b,a,c)}y(bKc,oY);p=bKc.prototype;p.getTitle=n("Formatting");p.sV=function(a){return 2==a||4==a};p.tO=function(a){var b=L(a,1);switch(b){case 2:return new $Jc(a,this.Aa());case 4:return a=new XJc(a,this.R,this.Aa()),this.getHandler().V(a,"Kd",this.MTb).V(a,"Rd",this.cGb),a;default:throw Error("Unsupported recommendation type: "+b);}};p.MTb=function(a){bJc(this.ib,"Alternating colors applied",this.Aa(),v(this.llb,this,a.C))};p.cGb=function(){this.ib.clear()};
p.llb=function(a){this.dispatchEvent(new jY("Wd",a,2796))};p.XM=function(a){bKc.qa.XM.call(this,a);this.setVisible(!a)};p.YM=function(a){return this.zd()?(this.setVisible(!1),a):bKc.qa.YM.call(this,a)};p.a1=n(3);function cKc(a,b,c,d,e,f,h,k,l,m){lY.call(this,k,m);this.$a=b;this.cb=c;this.va=d;this.gb=l;this.R=e;this.$=f;this.H=new Dv("",new fY,this.Aa());this.Qa(this.H);this.L=new Dv("",new fY,this.Aa());this.Qa(this.L);this.J=this.D=null;this.C=Ko("CANVAS","waffle-pivottable-pivot-canvas-border");this.Wa=this.cb.L.C;this.O=Br(new Ar,10).build()}r(cKc,lY);p=cKc.prototype;p.nA=n(!0);p.Ha=function(){lY.prototype.Ha.call(this);mY(this).appendChild(S(uFc));AGc(this).appendChild(S(vFc))};
p.Ra=function(){lY.prototype.Ra.call(this);var a=L(this.F,5),b=nBc(this.$,a),c=yJ(this.$a).$b();this.J=new oBc(b,a,this.Wa,this.gb,c,this.va);a=this.Za("waffle-assistant-insert-pivottable-button");this.H.kb(a);hY(a,"Insert Pivot Table");a=this.Za("waffle-assistant-zoom-button");this.L.kb(a);hY(a,"Preview Pivot Table");this.getHandler().V(this.H,"action",this.GJb).V(this.L,"action",this.HJb)};
p.oA=function(a){cp(this.Za("waffle-assistant-answercard-interpret"),Te(this.F,3));this.C=Ko("CANVAS","waffle-pivottable-pivot-canvas-border");this.Za("waffle-assistant-answercard-pivot-content").appendChild(this.C);qBc(this.J,this.C);a()};p.pA=function(a){lY.prototype.pA.call(this,a);this.H&&this.H.setVisible(!a);this.D&&pFc(this.D,this.zd())};p.hA=function(){Rs(this.Na,"Suggested Pivot Table")};p.Xy=n("assistantPivotTableFeedback");p.FB=n(2632);p.EB=n(2631);
p.GJb=function(){pBc(this.J);this.dispatchEvent("close-sidebar");this.R.C(35589,this.O)};p.HJb=function(){this.R.C(35590,this.O);H(this.D);this.D=new sBc(this.J,this.L,Te(this.F,3),this.R,this.O,35591,this.Aa());this.D.render();this.Fa(this.D);pFc(this.D,this.zd())};function dKc(a,b,c,d,e,f,h,k){oY.call(this,1,f,e,k);this.H=d;this.D=b;this.L=c;this.O=h;Br(new Ar,10).build();a=new oOb(a,!0,!0);this.F=new mBc(a,this.D)}r(dKc,oY);p=dKc.prototype;p.getTitle=n("Pivot Table");p.sV=function(a){return 1==a};p.tO=function(a){var b=L(a,1);switch(b){case 1:return new cKc(0,this.D,this.L,this.H,this.R,this.F,0,a,this.O,this.Aa());default:throw Error("Unsupported recommendation type: "+b);}};p.WM=function(a,b){L(a[0],5)&&oY.prototype.WM.call(this,a,b)};
p.YM=function(a){return this.zd()?(this.setVisible(!1),a):oY.prototype.YM.call(this,a)};p.a1=n(5);function KY(a,b,c,d,e){R.call(this);this.O=a;this.cb=b;this.va=c;this.H=d;this.D=e}r(KY,R);KY.prototype.getTableRange=g("va");KY.prototype.p9=function(a,b,c){this.va=a;this.H=b;this.D=c};KY.prototype.Ra=function(){R.prototype.Ra.call(this);this.getHandler().V(this.O.C,"K",this.gb)};KY.prototype.gb=function(){this.cb.mc()};function eKc(a,b){G.call(this);this.F=a;this.H=b;this.C=new AW(a,"waffle-assistant-table-range-border","waffle-assistant-table-range-rect");this.Fa(this.C);this.D=new AW(a,"waffle-assistant-header-range-border","waffle-assistant-header-range-rect");this.Fa(this.D)}r(eKc,G);eKc.prototype.Oa=function(){CW(this.C);CW(this.D);G.prototype.Oa.call(this)};
function fKc(a,b,c,d,e,f){Ceb(b);var h=$l(d);h=new xl(h.kc(),h.gc(),Math.min(h.Nc(),h.kc()+6),Math.min(h.Pc(),h.gc()+6));var k=oK(b),l=RG(a.F).C,m=l.$f(new de(h.kc(),h.Nc()),"r",!0,!1,!0,!0)-1,q=l.$f(new de(h.gc(),h.Pc()),"c",!0,!1,!0,!0)-1;l.Yb()&&--q;m=Math.min(200,m);q=Math.min(c.offsetWidth-2,q);pK(b,k,q,m);c=TGc(d,e,f);a.H.render(b,h,c);b=a.C;h=d.kc();k=d.gc();switch(e){case 0:h=Math.min(d.Nc(),d.kc()+f);break;case 1:k=Math.min(d.Pc(),d.gc()+f)}d=Vl(d.Jb(),h,k,d.Nc(),d.Pc());BW(b,zU(d));BW(a.D,
zU(c))};function gKc(a){var b=a.eQa,c=a.dQa,d=a.DOa;a=a.sza;return V('<div class="waffle-sidebar-overlay"><div class="waffle-tables-popup" aria-label="'+W(b)+'"><div class="waffle-tables-popup-header"><div class="waffle-tables-popup-title">'+T(b)+'</div></div><div class="waffle-tables-popup-content">'+T(c)+'<div class="waffle-assistant-canvas-container"><canvas class="waffle-assistant-table-canvas"></canvas></div></div><div class="waffle-tables-popup-buttons"><div class="waffle-tables-popup-button waffle-tables-popup-done">'+
T(d)+'</div><div class="waffle-tables-popup-button waffle-tables-popup-cancel">'+T(a)+"</div></div></div></div>")}
function hKc(){var a=""+(""+gKc({eQa:Au("Edit data range"),dQa:Bu(""+V('<div class="waffle-assistant-tables-recommendation"><div class="waffle-assistant-table-range-container"><div class="waffle-assistant-tables-range-wrapper waffle-assistant-tables-data-range-wrapper"><label id="waffle-assistant-tables-data-range-label">Data Range</label></div><div class="waffle-assistant-tables-range-error" style="display:none">Invalid range</div></div><div class="waffle-assistant-header-range-container"><div class="waffle-assistant-tables-range-wrapper">Headers<div class="waffle-assistant-tables-edit-headers-button"></div></div></div></div>')),DOa:Au("Update"),
sza:Au("Cancel")})+"");return V(a)}function iKc(){var a=""+(""+gKc({eQa:Au("Improve suggestions"),dQa:Bu('<div class="waffle-tables-popup-header-message"></div>'),DOa:Au("No"),sza:Au("Yes")})+"");return V(a)}function jKc(a){a='For <span class="waffle-assistant-table-bar-range">'+(T(a.pH)+"</span>");return V(""+(""+a+""))}
function kKc(a){a='Is <span class="waffle-assistant-table-first-header">'+(T(a.IK)+"</span> a header row, containing titles that describe the columns below?");return V(""+(""+a+""))};function lKc(a,b,c,d,e,f,h){KY.call(this,a,gRa,d,e,f);this.C=(new GQ).build();this.Fa(this.C);this.J=new Dv("",new fY,this.Aa());this.Qa(this.J);lx(this.C,this.J,hRa);this.F=new Dv("",new fY,this.Aa());this.Qa(this.F);lx(this.C,this.F,gRa);this.R=new eKc(b,c);this.Fa(this.R);this.L=new Tq(this);this.Fa(this.L);this.Ba=h}r(lKc,KY);lKc.prototype.Ha=function(){this.Na=S(iKc)};
lKc.prototype.Ra=function(){KY.prototype.Ra.call(this);this.J.kb(this.Za("waffle-tables-popup-done"));this.F.kb(this.Za("waffle-tables-popup-cancel"));var a=TGc(this.getTableRange(),this.D,1);a=wF($l(a));a=S(kKc,{IK:a});this.Za("waffle-tables-popup-header-message").appendChild(a);this.L.subscribe(hRa,"action",this.Ia).subscribe(gRa,"action",this.$);a=this.Za("waffle-assistant-table-canvas");var b=this.Za("waffle-assistant-canvas-container");fKc(this.R,a,b,this.getTableRange(),this.D,this.H);a=this.Za("waffle-tables-popup");
Ys(a,"waffle-tables-popup-answers-enabled",this.Ba);b=new bM(a,this.Aa());this.Fa(b);cM(b);a.focus()};lKc.prototype.$=function(){this.dispatchEvent("Ud")};lKc.prototype.Ia=function(){var a=$l(this.getTableRange());switch(this.D){case 0:a=Kpa(a.top+1,a.left,a.top+a.height,a.left+a.width);break;case 1:a=Kpa(a.top,a.left+1,a.top+a.height,a.left+a.width)}a=wF(a);this.dispatchEvent(new sGc(a,this.H-1,this.D));this.dispatchEvent("Ud")};function mKc(a,b,c,d,e,f,h,k,l){KY.call(this,a,jB,d,e,f);var m=this;this.ib=b;this.$a=d;this.Ab=e;this.Db=f;a=$l(d);this.F=wF(a);this.Wa=new eKc(b,c);this.Fa(this.Wa);this.C=null;this.Ba=h;this.J=(new GQ).build();this.Fa(this.J);this.$=new Dv("",new fY,this.Aa());this.Qa(this.$);lx(this.J,this.$,eRa);this.R=new Dv("",new fY,this.Aa());this.Qa(this.R);lx(this.J,this.R,jB);b=this.O.C.C.Xd();this.L=new sV(this.ib,function(a,b,c){nKc(m,a,b,c)},!1,"e.g., A2:D5",!0,b,this.Aa());this.Qa(this.L);this.Ia=
null;this.Pa=new Tq(this);this.Fa(this.Pa);this.jb=k;this.wb=l}r(mKc,KY);p=mKc.prototype;p.Ha=function(){this.Na=S(hKc)};
p.Ra=function(){KY.prototype.Ra.call(this);this.$.kb(this.Za("waffle-tables-popup-done"));this.R.kb(this.Za("waffle-tables-popup-cancel"));this.L.render(this.Za("waffle-assistant-tables-data-range-wrapper"));var a=this.Za("waffle-range-selection-input");Ns(a,"labelledby","waffle-assistant-tables-data-range-label");this.getHandler().V(a,"keydown",this.MJb).V(a,"keyup",this.NJb).V(a,uga,this.GDb).V(this.L,"change",this.OJb);this.Pa.subscribe(eRa,"action",this.PJb).subscribe(jB,"action",this.Hlb);oKc(this);
a=this.Za("waffle-tables-popup");Ys(a,"waffle-tables-popup-answers-enabled",this.wb);var b=new bM(a,this.Aa());this.Fa(b);cM(b);a.focus()};p.Oa=function(){H(this.Ia);KY.prototype.Oa.call(this)};function nKc(a,b,c,d){FU(a.jb,null,b,c,d,!1,void 0,function(b){a.Ia=b})}function pKc(a){var b=a.Za("waffle-assistant-table-canvas"),c=a.Za("waffle-assistant-canvas-container");fKc(a.Wa,b,c,a.getTableRange(),a.D,a.H)}p.Hlb=function(){this.dispatchEvent("Ud")};
p.PJb=function(){var a=!FZa.test(this.F);Q(this.Fb("waffle-assistant-tables-range-error"),a);Ys(this.Za("waffle-assistant-tables-data-range-wrapper"),"waffle-assistant-tables-range-error-input",a);if(!a){a=this.Ab!=this.H||this.Db!=this.D;var b=!qsc(this.$a,this.getTableRange());if(a||b)a&&this.Ba.Wb(35506),b&&this.Ba.Wb(35507),this.dispatchEvent(new sGc(this.F,this.H,this.D));this.dispatchEvent("Ud")}};
function oKc(a){var b=a.Za("waffle-range-selection-input"),c=$l(a.$a);a.F=wF(c);b.value=a.F;qKc(a);pKc(a)}p.p9=function(a,b,c){KY.prototype.p9.call(this,a,b,c);pKc(this)};function rKc(a){var b=yJ(a.O.C),c=b.$b();if(b=JZa(a.F,b))c=Yl(b,c),a.p9(c,sKc(a,c),a.D),qKc(a)}function sKc(a,b){b=tKc(b,a.D);return a.H>b?b:a.H}function tKc(a,b){a=0==b?a.Nc()-Te(a,2):a.Pc()-Te(a,4);return Math.min(a-1,3)}
function qKc(a){H(a.C);a.C=new vM;a.Qa(a.C);lx(a.J,a.C,dRa);CU(a.C,YW.getInstance());a.C.render(a.Za("waffle-assistant-tables-edit-headers-button"));a.getHandler().V(a.C,"action",a.wsb);for(var b=tKc(a.getTableRange(),0),c=0;c<=b;c++){var d=(new iq("{NUM_HEADER_RECORDS, plural,=0 {No rows}=1 {1 row}other {# rows}}")).format({NUM_HEADER_RECORDS:c});a.C.Fd(new au(d))}c=tKc(a.getTableRange(),1);for(d=0;d<=c;d++){var e=(new iq("{NUM_HEADER_RECORDS, plural,=0 {No columns}=1 {1 column}other {# columns}}")).format({NUM_HEADER_RECORDS:d});
a.C.Fd(new au(e))}c=a.H;a.C.qf(0==a.D?c:c+b+1);Ns(a.C.Na,"label","Headers")}p.GDb=function(){var a=this.Za("waffle-range-selection-input");this.F!=a.value&&(this.F=a.value,rKc(this))};p.OJb=function(){var a=this.L.bb();this.F=a;var b=this.Za("waffle-range-selection-input");b.value=a;b.select();rKc(this)};
p.MJb=function(a){var b=this.Za("waffle-range-selection-input");switch(a.keyCode){case 13:a.stopPropagation();a.preventDefault();this.F=b.value;rKc(this);eRa.mc();break;case 27:a.stopPropagation(),a.preventDefault(),oKc(this),jB.mc()}};p.NJb=function(){this.F=this.Za("waffle-range-selection-input").value;rKc(this)};p.wsb=function(){var a=this.C.Vg(),b=tKc(this.getTableRange(),0);this.p9(this.getTableRange(),a-(0==(a>b?1:0)?0:b+1),a>b?1:0)};function uKc(a){a=""+('<div class="waffle-assistant-quicksum-entry" tabindex="0"><span class="waffle-assistant-quicksum-entry-name" title="'+W(a.title)+'">'+T(a.name)+'</span><span class="waffle-assistant-quicksum-entry-value"></span><span aria-label="'+Eu("Press enter to insert formula")+'"></span></div>');return V(a)};function LY(a,b){R.call(this);this.C=a;this.D=b}y(LY,R);p=LY.prototype;p.Ha=function(){this.Na=S(uKc,{name:this.C,title:this.D})};p.Ra=function(){LY.qa.Ra.call(this);var a=this.Za("waffle-assistant-quicksum-entry-name");hY(a);this.getHandler().V(this.Na,"keypress",this.n0b);Q(this.Na,!1)};p.getFunctionName=g("C");p.fb=function(a){cp(this.Za("waffle-assistant-quicksum-entry-value"),a||"");Q(this.Na,!!a)};p.isVisible=function(){return qs(this.Na)};
p.n0b=function(a){13==a.keyCode&&(a.stopPropagation(),a.preventDefault(),this.dispatchEvent(new I("insert",this)))};function vKc(a,b,c,d,e){R.call(this,e);this.Wa=a;this.Ia=b;this.O=c;this.J=d;this.D=a.C;this.Pa=new Tl;this.$=Br(new Ar,17).build();this.R=Br(new Ar,2).build();this.L=!1;this.F=[];this.C=null;this.H=[]}y(vKc,R);
vKc.prototype.Ra=function(){vKc.qa.Ra.call(this);this.gh(new LY(ritz_api.RitzModelApi.getLocalizedFunctionName("SUM"),"Sum"),0,!0);this.gh(new LY(ritz_api.RitzModelApi.getLocalizedFunctionName("AVERAGE"),"Average"),1,!0);this.gh(new LY(ritz_api.RitzModelApi.getLocalizedFunctionName("MIN"),"Minimum"),2,!0);this.gh(new LY(ritz_api.RitzModelApi.getLocalizedFunctionName("MAX"),"Maximum"),3,!0);this.gh(new LY(ritz_api.RitzModelApi.getLocalizedFunctionName("COUNTA"),"Count all"),4,!0);this.C=new IIc(this.Na,
this.Ia,this.D,this.O);this.C.H=this.L;this.Fa(this.C);this.getHandler().V(this,"insert",this.va).V(this.C,"formula_inserted",this.Ba)};
function wKc(a){function b(a){return l?ritz_api.RitzModelApi.renderNumberAsFormattedString(a,m):null}if(SG(a.D)){var c=yJ(a.D),d=c.wj(),e=xJ(a.D);if(vb(d,c.Xs,c)){c=[];a.F=[];for(var f=0;f<d.length;f++){var h=d[f],k=Vl(e+"",h.kc(),h.gc(),h.Nc(),h.Pc());c.push(a.Pa.serialize(k));a.F.push(h)}if(d=ritz_api.RitzModelApi.quickSum(c)){Q(a.Na,!0);e=d.count;c=d.countNumberFormat;var l=1<d.numericCount,m=l?d.valueNumberFormat:null;a.ad(0).fb(b(d.sum));a.ad(1).fb(b(d.average));a.ad(2).fb(b(d.min));a.ad(3).fb(b(d.max));
1<e?a.ad(4).fb(ritz_api.RitzModelApi.renderNumberAsFormattedString(e,c)):Q(a.Na,!1);if(a.C){a.C.L=[];a.H=[];for(d=0;d<a.Wc();++d)e=a.ad(d),a.H.push(xKc(a,e.getFunctionName()));a.C.L=a.H}}else Q(a.Na,!1)}else Q(a.Na,!1)}else Q(a.Na,!1)}vKc.prototype.va=function(a){var b=a.target;a=this.F[0];a=new il(a.left,a.Nc());b=b.getFunctionName();b=xKc(this,b);a=new dL(yJ(this.D),a,b);this.O.C(a);this.J.Wb(2624,this.R)};vKc.prototype.Ba=function(){this.J.Wb(2624,this.$)};
function xKc(a,b){var c=a.Wa.L.D;a=sb(a.F,function(a){return wF(a)});return"="+b+"("+a.join(c)+")"};function yKc(a){a=""+('<div class="waffle-autovis-lightbox"><div class="waffle-autovis-lightbox-header"><div class="waffle-autovis-lightbox-buttons-wrapper">'+T(Kv({content:Au("INSERT CHART"),style:4,vd:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-insert waffle-autovis-lightbox-readonly-hidden"}))+T(Kv({vd:"waffle-autovis-lightbox-close",content:Bu(""+T(Zw({icon:"docs-icon-img docs-icon-close-white"}))),style:4,title:Au("Close")}))+'</div></div><div class="waffle-autovis-lightbox-content"><div class="waffle-autovis-lightbox-content-inner">'+
T(Kv({content:Bu("&#10094;"),style:4,vd:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-previous",attributes:Cu('aria-label="'+Eu("Previous chart")+'"')}))+'<div class="goog-inline-block waffle-autovis-lightbox-container"></div>'+T(Kv({content:Bu("&#10095;"),style:4,vd:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-next",attributes:Cu('aria-label="'+Eu("Next chart")+'"')}))+'</div><div class="waffle-autovis-lightbox-page-count"><span class="waffle-autovis-lightbox-page-number"></span>/'+
T(a.mLb)+"</div></div></div>");return V(a)}function zKc(){return V('<div class="waffle-autovis-lightbox-chart"></div>')};function AKc(a,b,c,d,e){R.call(this,e);this.F=a;this.D=b;this.$=c;this.R=d;this.H=[];this.C=new Lv("",this.Aa());this.Qa(this.C);this.O=new Lv("",this.Aa());this.Qa(this.O);this.L=new Lv("",this.Aa());this.Qa(this.L);this.J=new Lv("",this.Aa());this.Qa(this.J)}y(AKc,R);p=AKc.prototype;p.Ha=function(){AKc.qa.Ha.call(this);this.Na=S(yKc,{mLb:this.F.length})};
p.Ra=function(){AKc.qa.Ra.call(this);var a=yy.isEnabled();BKc(this,!a);a=this.Za("waffle-autovis-lightbox-close");this.C.kb(a);a=this.Za("waffle-autovis-lightbox-insert");this.O.kb(a);var b=this.Za("waffle-autovis-lightbox-previous");this.L.kb(b);b=this.Za("waffle-autovis-lightbox-next");this.J.kb(b);CKc(this);DKc(this,this.D,!1);this.getHandler().V(document.body,ze,this.YWb).V(this.Na,"keydown",this.$Wb).V(Jo(),"resize",this.cXb).V(this.C,"action",this.close).V(this.O,"action",this.ZWb).V(this.L,
"action",this.bXb).V(this.J,"action",this.aXb);b=new bM(this.Na,this.Aa());cM(b);this.Fa(b);a.focus()};function CKc(a){var b=a.Za("waffle-autovis-lightbox-content"),c=a.Za("waffle-autovis-lightbox-content-inner");a=a.Za("waffle-autovis-lightbox-page-count");var d=Ho();a=ms(a);var e=d.height-a.height-195,f=d.width-200;.75<e/f?(d=f,e=.75*f):d=e/.75;gs(c,d,e);gs(b,d,e+a.height+35)}function BKc(a,b){Ys(a.Na,"waffle-autovis-lightbox-readonly",b)}
function DKc(a,b,c){c&&DB("Page "+(b+1+(" of "+(a.F.length+"."))));a.H[b]?EKc(a,b):a.F[b]&&hHc(a.F[b],v(a.zmb,a,b),!0)}p.zmb=function(a,b){if(!this.isDisposed()&&b){var c=this.Za("waffle-autovis-lightbox-container"),d=S(zKc);c.appendChild(d);this.H[a]=d;LW(b,d,this.$,this.R,Bp);EKc(this,a)}};function EKc(a,b){Q(a.H[a.D],!1);Q(a.H[b],!0);a.L.eb(0!=b);a.J.eb(b!=a.F.length-1);var c=a.Za("waffle-autovis-lightbox-page-number");cp(c,b+1);a.D=b}p.YWb=function(a){!ap(this.Na,a.target)&&a.relatedTarget&&a.relatedTarget.focus()};
p.$Wb=function(a){27==a.keyCode?this.close():37==a.keyCode||38==a.keyCode?0!=this.D&&DKc(this,this.D-1,!0):39!=a.keyCode&&40!=a.keyCode||FKc(this);a.stopPropagation()};p.cXb=function(){var a=this.Za("waffle-autovis-lightbox-container");Ro(a);this.H=[];CKc(this);DKc(this,this.D,!0)};p.ZWb=function(){this.close();kHc(this.F[this.D],2256)};p.bXb=function(){0!=this.D&&DKc(this,this.D-1,!0);0==this.D&&this.J.Na.focus()};p.aXb=function(){FKc(this);this.D==this.F.length-1&&this.L.Na.focus()};
function FKc(a){a.D!=a.F.length-1&&DKc(a,a.D+1,!0)}p.close=function(){this.dispose()};p.bd=function(){AKc.qa.bd.call(this);var a=this.F[this.D];a&&a.Na&&a.Na.focus()};function GKc(a,b,c){J.call(this);this.C=L2a(sH.getInstance(),a,b,c);this.D=Ln()}y(GKc,J);GKc.prototype.update=function(a,b,c){var d=this,e=this.C.C;c&&e&&!xb(c,function(a){return Xpa(a,e.rect)},this)||!a&&e&&c&&1==c.length&&1==c[0].hh()&&e.rect.contains(c[0])||(this.D.cancel(!0),a&&Crc(this.C),this.D=HKc(),this.D.addCallback(function(){return Mrc(d.C,b,!0)}))};GKc.prototype.Df=function(a){this.C.Df(a)};
function HKc(){var a=null,b=new En(function(){null===a||Qi(a)});a=Pi(function(){b.Ub()});return b};function MY(a,b,c,d,e,f,h){uV.call(this,h);this.He=a;this.jd=b.C;this.$a=c;this.Ze=d;this.H=f;this.ef=e;this.jb=new vKc(b,c,d,f,this.Aa());this.Qa(this.jb);this.R=new uW(!1,"#4285f4");this.Qa(this.R);this.O=null;this.Vc=this.Gc=!1;this.Nb=!0;this.Lb=Zd();this.Db=this.Ab="";this.Zb=null;this.cb=Br(new Ar,10).build()}y(MY,uV);p=MY.prototype;p.Ha=function(){MY.qa.Ha.call(this);this.Na=S(IKc,{kM:xp})};
p.Ra=function(){MY.qa.Ra.call(this);var a=this.Za("waffle-assistant-quicksum-panel");this.jb.kb(a);a=this.Za("waffle-assistant-spinner-container");this.R.render(a);a=this.He.C;this.getHandler().V(this,"close-sidebar",this.Qka).V(a,"recommender-load-started",this.Fka).V(a,"recommender-load-ended",this.Eka).V(a,"recommender-calc-started",this.fka).V(a,"recommender-calc-ended",this.dka).V(this.Za("waffle-assistant-scroll-pane"),"scroll",ksc(this.lba,10,this));a=yy.isEnabled();this.kba(!a)};
p.resize=function(){var a=this.Za("waffle-assistant-sidepane-content");a=ms(a).height;var b=this.Za("waffle-assistant-spinner-container");Sr(b,"margin-top",a/2-16+"px");this.lba()};p.Df=ta;function JKc(a,b){var c=KKc(a);0!=c.length&&(H(a.O),c=c.filter(function(a){return a instanceof pY}),b=c.indexOf(b),0<c.length&&-1!=b&&(a.O=new AKc(c,b,a.ef,a.H,a.Aa()),a.O.render(),a.Fa(a.O),BKc(a.O,a.Vc)))}
p.kba=function(a){this.Vc=a;Ys(this.Na,"waffle-assistant-readonly",a);var b=this.jb;b.L=a;b.C&&(b.C.H=a);Ys(b.Na,"waffle-assistant-quicksum-panel-readonly",a);this.O&&!this.O.isDisposed()&&BKc(this.O,a)};
p.setVisible=function(a){var b=this.isVisible();MY.qa.setVisible.call(this,a);if(a&&!b){var c=Hrc(this.He.C,a);c?(b=new iFc,D(b,1,Ll(c,"r")),D(b,2,Ll(c,"c")),D(b,3,c.hh()),c=new yr,bd(c,4,b),b=Er(Fr(this.cb),c).build()):b=this.cb;this.Db=$d(this.Lb,Ym.Zta,!1,b);vW(this.R,!0);LKc(this)}a||MKc(this,!0)};p.Fka=function(){this.isVisible()&&(MKc(this,!0),vW(this.R,!0),LKc(this))};p.Eka=function(){this.isVisible()&&(vW(this.R,!1),LKc(this))};
p.fka=function(a){this.isVisible()&&(this.H.C(2775,this.cb),MKc(this,void 0,a.C,a.F),NKc(this)||vW(this.R,!0),LKc(this),this.Nb=!1)};
p.dka=function(a){if(this.isVisible()){this.H.C(2776,this.cb);var b=a.C;0<b.length&&(this.Ab=$d(this.Lb,Ym.Xta));MKc(this,!1);vW(this.R,!1);a=a.F;for(var c=ja(this.D),d=c.next();!d.done;d=c.next()){d=d.value;for(var e=[],f=ja(b),h=f.next();!h.done;h=f.next()){h=h.value;var k=Te(h,1);d.sV(k)&&e.push(h)}0<e.length?d.WM(e,a):d.xT(!0)}if(Gp)for(b=ja(b),a=b.next();!a.done;a=b.next())if(a=a.value,5==Te(a,1)){this.d3();this.Ia=L(a,12);this.va=EU(a);this.Pa=L(a,11);OKc(this);a=this.va;c=!1;for(d=this.gb.length-
1;0<=d;d--)e=this.gb[d],f=a,e.xg()&&e.Jb()==f.Jb()&&qFc(Wl(e),Wl(f))&&qFc(Xl(e),Xl(f))&&(c=!0,this.gb.splice(d,1));this.gb.push(a);a=c;2!=this.Ia||a||PKc(this,!0)}b=KKc(this);0<b.length&&this.Gc&&(b[b.length-1].Gc=!0);this.Gc=!1;LKc(this);QKc(this);this.lba()}};function LKc(a){var b=NKc(a),c=qs(a.Za("waffle-assistant-quicksum-panel")),d=a.R.Vb();b=b||c||d;a=a.Za("waffle-assistant-empty-list");Q(a,!b)}p.Dc=ta;p.Qoa=ta;p.zd=g("Vc");p.Qka=ta;
p.cJb=function(){""!=this.Ab&&(ae(this.Lb,this.Ab),this.Ab="");""!=this.Db&&(ae(this.Lb,this.Db),this.Db="");this.Zb=Ha();this.Nb||(this.H.Wb(2777,this.cb),this.Nb=!0)};function IKc(a){a=a||{};var b=V,c=Bu('<div class="waffle-assistant-replaceable-title">'+RKc()+"</div>");var d=d=a||{};var e=""+('<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content" aria-live="polite">'+T(FGc({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div class="waffle-assistant-empty-list-title">Get insights instantly</div><div class="waffle-assistant-empty-list-body">');e=d.kM?e+"To see answers, formatting, and charts in a single click, try adding more data or selecting different cells in your spreadsheet.":
e+"To see formatting and charts in a single click, try adding more data or selecting different cells in your spreadsheet.";d=V(e+'</div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try it out</a></div></div></div>');d=V(""+('<div class="waffle-sidebar-tables-bar" style="display: none"><div class="waffle-assistant-sidepane-tables-range"></div><div class="waffle-assistant-tables-edit-range-button">Edit</div></div><div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content"><div class="waffle-assistant-scroll-pane-feature-content">'+
d+'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="display: none"></div><div class="waffle-assistant-features"></div></div><div class="waffle-assistant-expanded-panel" style="display: none"></div></div></div>'));return b(""+T(wV(yu({title:c,Rk:Bu(""+d),id:Au("autovis"),mH:Au("waffle-assistant-sidepanel"),zaa:Au("waffle-assistant-title"),OV:Au("waffle-assistant-sidepane-content")},a)))+"")}
function RKc(){return V('<div class="waffle-assistant-title-bar"><div class="waffle-assistant-title-icon">'+T(FGc({color:"#ffffff",iconSize:"21"}))+'</div><div class="waffle-assistant-title-text">'+T("Explore")+"</div></div>")};function NY(a,b,c,d,e,f,h,k,l,m,q,t){MY.call(this,a,b,c,e,d,f,t);this.Be=q;this.Od=h;this.Wa=b;this.ib=new R(this.Aa());this.Qa(this.ib);this.Ba=new PJc;this.Fa(this.Ba);this.D=[];this.F=null;this.Kb=new Lv("",t,4);Xt(this.Kb,2,!1);this.Qa(this.Kb);this.ke=k;this.vg=l;this.Hd=m;this.va=null;this.Ia=0;this.Pa=null;this.Sb=new Dv("",new fY,this.Aa());this.Qa(this.Sb);this.wc=new R(this.Aa());this.Qa(this.wc);this.xd=(new GQ).build();this.Fa(this.xd);lx(this.xd,this.Sb,fRa);this.$=this.J=null;this.gb=
[]}y(NY,MY);var OY={LD:"waffle-assistant-scroll-pane-feature-content",lbc:"waffle-assistant-empty-list",KYa:"waffle-assistant-features",NZa:"waffle-assistant-empty-list-learn-more",Fca:"waffle-assistant-expanded-panel",dwa:"waffle-assistant-replaceable-title",Q0a:"waffle-assistant-scroll-pane",M1a:"waffle-assistant-sidepane-tables-range",N1a:"waffle-sidebar-tables-bar",yxa:"waffle-assistant-tables-scroll-pane",O1a:"waffle-assistant-tables-edit-range-button",hw:"waffle-assistant-title"},SKc={defaultHelpArticleId:"6280499"};
p=NY.prototype;
p.Ra=function(){var a=this;NY.qa.Ra.call(this);this.ib.kb(this.Za(OY.Fca));hY(this.C.Na,"Close");Gp&&(this.wc.kb(this.Za(OY.M1a)),OKc(this),this.Sb.kb(this.Za(OY.O1a)));var b=this.Wa.L.uv();xp&&(Axa||"en"==rH(b))&&(b=new HY(this.Od,this.$a,this.jd,this.Ze,this.H,this.Ba,this.Wa,this.vg,this.Hd,this.Be,this.Aa()),this.Qa(b),this.D.push(b));b=new bKc(this.H,this.Ba,this.Aa());this.Qa(b);this.D.push(b);F(E(),"fedvs")&&(b=new TJc(this.H,this.Ba,this.$a,this.Aa()),this.Qa(b),this.D.push(b));Gxa&&(b=new dKc(this.Od,
this.jd,this.Wa,this.Ze,this.H,this.Ba,this.Be,this.Aa()),this.Qa(b),this.D.push(b));b=new rY(this.jd,this.$a,this.ef,this.H,this.Ba,this.Aa());this.Qa(b);this.D.push(b);var c=this.Za(OY.KYa);A(this.D,function(b){b.render(c);a.ib.Qa(b.C,!0)});this.Kb.kb(this.Za(OY.NZa));this.getHandler().V(this.Kb,"action",this.V0b).V(this,"Ud",this.d3).V(this,"Td",this.W0b);TKc(this)};p.W0b=function(){var a=UKc(this);a&&(a.Ia=!0)};p.V0b=function(){P.Xn.mc(SKc)};function QKc(a){A(a.D,function(a){OGc(a)})}
function MKc(a,b,c,d){A(a.D,function(a){a.xT(b,c,d)})}function NKc(a){return!!xb(a.D,function(a){return a.cla()})}p.lba=function(){var a=this,b=this.Za("waffle-assistant-scroll-pane").scrollTop+ms(this.Za("waffle-assistant-sidepane-content")).height;A(this.D,function(c){a.F&&a.F!=c||(c instanceof rY&&a.getHandler().Oc(c,"Pd",a.cJb),b=c.YM(b))})};function KKc(a){if(a.F)return a.F.C.C;var b=[];A(a.D,function(a){Kb(b,NGc(a))});return b}p.kba=function(a){NY.qa.kba.call(this,a);TKc(this)};
p.Df=function(a){A(this.D,function(b){b.Df(a)})};p.Qoa=function(){var a=this.Za(OY.dwa),b=this.Za(OY.hw);ls(b,ms(a).height)};
p.Dc=function(){var a=this,b=this.Za(OY.LD),c=this.Za(OY.dwa),d=this.ib.Na;if(this.F)this.F.C.setVisible(!1),this.F.b1(!1),this.F=null,Q(b,!0),Q(d,!1),pu(c,RKc),Os(c,"label"),this.resize();else if(this.F=xb(this.D,function(a){return a.Vb()}))Q(b,!1),Q(d,!0),this.F.C.setVisible(!0),PGc(this.F,c),Rs(c,this.F.getTitle());this.Qoa();b=new no(function(){var b=by;b&&b.dispatchEvent("resize");a.lba()},300);this.Fa(b);b.start()};
p.setVisible=function(a){var b=this.isVisible();NY.qa.setVisible.call(this,a);a&&!b&&VKc(this,!0);a||this.Ba.clear()};p.Qka=function(){NY.qa.Qka.call(this);this.F&&this.Dc();this.d3()};p.Fka=function(){NY.qa.Fka.call(this);VKc(this,!0)};p.Eka=function(){NY.qa.Eka.call(this);VKc(this,!1)};p.fka=function(a){NY.qa.fka.call(this,a);VKc(this,!0,a.C)};p.dka=function(a){NY.qa.dka.call(this,a);VKc(this,!1)};
function WKc(a,b){if(Gp){var c=UKc(a);b?(xcc(a.J),a.J=new mKc(a.Wa,a.$a,a.ke,a.va,a.Ia,a.Pa,a.H,a.Hd,!!c&&c.Vb()),a.Qa(a.J),a.J.render(a.getElement())):a.J&&(a.removeChild(a.J,!0),H(a.J),a.J=null);c&&LJc(c,b)}}function PKc(a,b){if(Gp&&1!=a.Pa){var c=UKc(a);b?(a.$=new lKc(a.Wa,a.$a,a.ke,a.va,a.Ia,a.Pa,!!c&&c.Vb()),a.Qa(a.$),a.$.render(a.getElement())):a.$&&(a.removeChild(a.$,!0),H(a.$),a.$=null);c&&LJc(c,b)}}function TKc(a){A(a.D,function(b){b.XM(a.zd())})}
function UKc(a){return(a=xb(a.D,function(a){return a instanceof HY}))?a:null}function VKc(a,b,c){A(a.D,function(a){c||JGc(a.C,b)});Gp&&b&&(a.va=null,a.Ia=0,a.Pa=null,a.d3(),OKc(a))}function OKc(a){var b=a.Za(OY.N1a),c=a.Za(OY.Q0a);if(a.va){var d=$l(a.va);d=wF(d);d=S(jKc,{pH:d});a=a.wc.Pb();Ro(a);a.appendChild(d);Q(b,!0);Us(c,OY.yxa)}else Q(b,!1),Ws(c,OY.yxa)}p.d3=function(){WKc(this,!1);PKc(this,!1)};function XKc(a,b,c,d,e,f,h,k,l,m,q,t){var w=this;zV.call(this,b,h);this.va=a;this.C=b;this.$=c;this.$a=d;this.ib=e;this.L=f;this.H=c.C;this.cb=this.Wa=!1;this.F=null;this.O=l;this.gb=t;this.Mc=new Tl;this.J=null;YKc(this);vNa.eb(!0);a=new Sq;D(a,6,ZKc());b=new Qq;bd(b,58,a);this.Ia=Br(Cr(new Ar,b),10).build();Zd();this.Pa=-1;a=new no(function(){return $Kc(w,!1)},100);this.Fa(a);a.start()}y(XKc,zV);
function YKc(a){var b=TD(a.ib);a.Va.V(a.$a,"selectionChange",a.Z0b).V(a.H,"K",a.X0b).V(b,"ea",a.Dvb).V(a.C,"Md",a.Hkb).V(a.C,"Ld",a.Gkb).V(a.C,"Kd",a.Ekb).V(a.C,"Rd",a.Zzb).V(a.C,"Od",a.Zlb).V(a.C,"Qd",a.Y0b).V(a.C,"Vd",a.SCb).V(a.C,"Sd",a.vBb).V(a.C,"Nd",a.glb).V(a.C,"Wd",a.a1b).V(a.va.C,"recommender-confidence-update",a.xnb).V(a.C,"Td",a.$0b);a.R.Qb(yy,Lq,a.Gtb).subscribe(zy,"action",a.dlb).subscribe(wNa,"action",a.zCb).subscribe(tNa,"action",a.wPa).subscribe(lz,"action",a.nxb).subscribe(fRa,"action",
a.NCb)}p=XKc.prototype;p.ih=function(){return xNa};p.Xr=function(){return yNa};p.yq=function(a){XKc.qa.yq.call(this,a);wNa.eb(a);$Kc(this,!1);!this.Wa&&a&&(this.Wa=!0);lq(this.gb,{Rb:a});a||this.C.Dc()};p.zY=function(a){var b=this;this.C.Qoa();var c=new no(function(){XKc.qa.zY.call(b,a)},300);this.Fa(c);c.start()};p.jka=function(){XKc.qa.jka.call(this);aLc(this,!1)};p.Df=function(a){this.C.Df(a);this.va.Df(a)};
p.Hkb=function(a){var b=a.C.F,c=L(L(b,13),3);b=EU(b);var d=new og;N(d,1,c);var e=new pg;N(e,1,d);N(e,3,!0);hrc(e,!0);this.L.C(new xT(e,b));PY(this,a.$i(),!1,Wxc(mg(c)))};p.dlb=function(){var a=this.C.isVisible();this.ih().setVisible(!a);a||this.C.focus();aLc(this,!a)};function aLc(a,b){b?(PY(a,2253),a.Pa=Ha()):PY(a,2226,!0)}p.wPa=function(){this.C.isVisible()||this.yq(!0)};p.nxb=function(){var a=UKc(this.C);a&&(a.Vb()?OJc(a,"",!0):(this.wPa(),NJc(a,"",!0)))};p.zCb=function(a){JKc(this.C,a)};
p.NCb=function(){WKc(this.C,!0)};p.Z0b=function(){ZH(this.$)&&!this.C.J&&$Kc(this,!0)};function $Kc(a,b,c){if(c){if(!c.length)return;if(1==c.length&&a.J&&c[0].equals(a.J)){a.J=null;return}}var d=a.C;d.isVisible()&&(wKc(d.jb),LKc(d));a.va.update(!b,a.C.isVisible(),c)}
p.xnb=function(a){var b=a.C||0;a=a.F;var c=!!a&&a.rect,d=(c=!!c&&c.hh()>=uxa&&Ll(c,"r")>=wxa&&Ll(c,"c")>=xxa&&c.hh()<=vxa)&&.6<=b;if(d!==this.cb||a&&!a.equals(this.F))this.cb=d,this.F=a,this.Pa=Ha(),vNa.mc({l8:d,pH:a});c&&a&&a.rect&&(c=.9<=b,d=1E3>=a.rect.hh(),a=ritz_api.RitzModelApi.isFormsRegion(""+a.fd,a.rect.top,a.rect.left,a.rect.height+a.rect.top,a.rect.width+a.rect.left),c=!this.C.isVisible()&&!this.Wa&&c&&d&&!this.$.wh(),a=mxa&&a,d=nxa&&this.$.zd(),c&&(a||d)&&(c=new Sq,D(c,1,b),D(c,2,a),D(c,
3,d),D(c,5,Fp),D(c,6,ZKc()),b=new Qq,bd(b,58,c),b=Cr(Br(new Ar,10),b).build(),this.Sya(b)))};p.Sya=function(a){var b=this;this.C.Gc=!0;var c=QG(yJ(this.H));if(!aac.C&&!c){var d=a||this.Ia;this.ih().setVisible(!0);this.O.Wb(2225,d);PY(this,2253);a=new no(function(){b.C.isVisible()||b.O.Wb(2752,d)},5E3);this.Fa(a);a.start()}};function ZKc(){switch(yxa){case "NO_DELAY":return 1;case "DELAY_500MS":return 2;case "DELAY_1S":return 3;case "DELAY_2S":return 4;default:return 0}}p.glb=function(){this.C.Dc()};
p.a1b=function(a){var b=a.C,c=EU(b.F),d=parseInt(c.Jb(),10);this.J=$l(c);this.L.C(new sac(d));ZJc(b,c);PY(this,a.$i())};p.X0b=function(){SG(this.H)?(this.C.eb(!0),$Kc(this,!1)):(this.ih().setVisible(!1),this.C.eb(!1))};p.Gtb=function(){this.C.kba(!yy.isEnabled())};p.Dvb=function(a){$Kc(this,!1,zUa(a))};
p.Gkb=function(a){var b=yJ(this.H),c=""+b.$b(),d=[],e=ftc(b);if(e){b=new vh;var f=Te(e,2);N(b,3,f);f=Te(e,2);N(b,2,f);e=Te(e,1);N(b,1,e);d.push(b)}b=a.C.wc;for(e=0;e<b.length;e++)f=new vh,N(f,2,b[e]),d.push(f);this.L.C(new qW(d,c));PY(this,a.$i())};
p.Ekb=function(a){var b=a.C,c=Ztc(b.C),d=EU(b.F),e=c.Bu?c.kx:null,f=c.C?c.Kw:null,h=parseInt(d.Jb(),10),k=bLc(d);this.J=$l(d);k?this.L.C(new yV(k,h,this.J,e,c.Pr,c.Os,f)):this.L.C(new xV(h,this.J,e,c.Pr,c.Os,f));d=new trc;D(d,1,1);c=new BU;b=L(b.F,2);D(c,2,b);bd(c,5,d);b=VGc(this.F);bd(b,46,c);b=Cr(Br(new Ar,10),b).build();this.O.C(a.$i(),b)};p.Zzb=function(a){a=a.C;var b=EU(a.F),c=parseInt(b.Jb(),10),d=bLc(b);this.J=$l(b);this.L.C(new buc(d,c));ZJc(a,b)};
p.$0b=function(a){var b=yJ(this.$.C),c=b.$b();b=Yl(JZa(a.O,b),c);c=TGc(b,a.F,a.R);var d=this.va,e=a.F;Crc(d.C);d.C.cb=b;d.C.Pa=c;d.C.Wa=e;Lrc(d.C,!0,!0,!1);PY(this,a.$i())};function bLc(a){var b=a.Jb();a=$l(a);b=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(b,a.kc(),a.gc(),a.Nc(),a.Pc(),7,!1);return 0<b.length?b[0]:null}p.Zlb=function(a){EG(yJ(this.H),a.J);PY(this,a.$i())};
p.SCb=function(a){var b=a.C;a=a.$i();if(b instanceof DY||b instanceof FY||b instanceof cKc)PY(this,a);else{var c=KKc(this.C),d=new BU,e=L(b.F,2);c=c.indexOf(b);D(d,1,c);D(d,2,e);e=new Qq;bd(e,46,d);if(b instanceof pY){(d=b.H)?(b=cLc(this,b,d),b=pxc(b,d,d.Vf())):b=null;if(!b)return;bd(e,39,b)}else if(b instanceof sHc){var f=b.F;c=new WEc;if(b instanceof sHc)b=1;else throw Error("Unknown text analysis card type.");f=Se(L(f,8),20).slice(0,10);D(c,2,f||[]);D(c,1,b);bd(d,3,c)}e=Cr(Br(new Ar,10),e).build();
this.O.C(a,e)}};p.vBb=function(){this.C.Dc()};
p.Y0b=function(a){var b=a.O;if(b){var c=yJ(this.H),d=a.Ge();d||(d=RG(this.$a).D.C.Ge());var e=16,f=16,h=a.Wa;h&&(e=h.x,f=h.y);h=Qrc(this.$.J);d={oid:null,ar:LG(c,d.y),ac:MG(c,d.x),x:e,y:f,h:tH.height,w:tH.width,p:{context:Tsc(h)}};(c=b.Vf())?(e=new Ck(c),d=new dJ(WG(this.H)||0,d,!1,!1),f=Kk(e,"headers"),f=null!=f&&na(f)&&Sa(f)?parseInt(f,10):-1,d.Wa=f,d.O=0,f="1"==Kk(e,"transpose"),d.Ia=f,d.J=f?"ROWS":"COLS",f=Kk(e,"range"),f=Jsc(Ksc(f,","),this.H),d.eH(f),(e=Kk(e,"dt"))&&N8a(d,this.Mc.kd(Ih.Ka(),
JSON.parse(decodeURIComponent(e))))):(e=new Ph,N(e,2,"0.6"),f=a.Gd().toJSON(),N(e,1,f),d=new dJ(WG(this.H)||0,d,!1,!1,e));eJ(d);Orc(d,b);this.$a.dispatchEvent(new hK("objectRequest"));this.L.C(new aL(this.$,d));e=dLc(this,b,a.R,a.Gd());d=d.getId()||0;e.H=d;pW(this.O,a.$i(),e,10,b,c,void 0,a.F)}};function cLc(a,b,c){var d=KKc(a.C).filter(function(a){return a instanceof pY});return dLc(a,c,d.indexOf(b),b.H&&b.H.Gd())}
function dLc(a,b,c,d){var e=new oW;a=KKc(a.C).filter(function(a){return a instanceof pY}).map(function(a){return a.getChartType()});e.R=a;e.J=c;oxc(e,b.getChartType());e.F=d?d.clone():null;return e}
function PY(a,b,c,d){if(a.F){var e=$c(mCa(a.Ia),Sq,58).getTableRange();if(c||!e||e.Jb()!=a.F.fd||e.gc()!=a.F.rect.gc()||e.kc()!=a.F.rect.kc()||e.Pc()!=a.F.rect.Pc()||e.Nc()!=a.F.rect.Nc()){e=new Sq;D(e,6,ZKc());var f=UGc(a.F);bd(e,7,f);c&&(c=Ha()-a.Pa,D(e,8,1E3*c),null!=a.C.Zb&&(c=Ha()-a.C.Zb,D(e,10,1E3*c)));d&&urc(e,d);d=F(E(),"feacos");D(e,9,d);d=new Qq;bd(d,58,e);a.Ia=Br(Cr(new Ar,d),10).build()}}a.O.Wb(b,a.Ia)};function eLc(){G.call(this)}y(eLc,Rp);eLc.prototype.D=function(){return GKc};eLc.prototype.H=function(){return NY};eLc.prototype.F=function(){return XKc};eLc.prototype.C=function(){return qGc};aq("assistant",eLc);
